(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    121333,       3219]
NotebookOptionsPosition[    117323,       3167]
NotebookOutlinePosition[    117685,       3183]
CellTagsIndexPosition[    117642,       3180]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["squeezed_cavity_analytics.nb\n",
  FontVariations->{"Underline"->True}],
 "James Gardner 2020",
 StyleBox["\n",
  FontVariations->{"Underline"->True}],
 "Analytics for the non-linear element in an over-coupled, linear, \
Fabry-Perot cavity.\nGenerates the figures used and values quoted in the \
report.\nThis satisfies Aim 1 - (ii) of the ASC goals."
}], "Text",
 CellChangeTimes->{{3.812654702168459*^9, 3.812654777864696*^9}, 
   3.812655321369796*^9, {3.812656746017045*^9, 
   3.812656746584639*^9}},ExpressionUUID->"39c62208-fd8d-4f47-b3ae-\
f8e054b8e8fb"],

Cell["\<\
See Appendix A of the report for a more readable walkthrough of this \
derivation.
We start by borrowing the solution for the fields for an empty cavity. \
Working in the sideband picture.\
\>", "Text",
 CellChangeTimes->{{3.812654799838687*^9, 3.812654839005529*^9}, {
  3.812654872561474*^9, 
  3.8126548781169777`*^9}},ExpressionUUID->"a7a48fbc-bd42-463c-98e0-\
5837de31a7ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Id", " ", "=", " ", 
    RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "using", " ", "the", " ", "mirror", " ", "convention", " ", "that", " ", 
     "no", " ", "change", " ", "occurs", " ", "on", " ", "transmission", " ", 
     "and", " ", "a", " ", "sign", " ", "change", " ", "on", " ", "one", " ", 
     "face", " ", "of", " ", "a", " ", "mirror", " ", "and", " ", "nothing", 
     " ", "on", " ", "the", " ", "other"}], ",", " ", 
    RowBox[{
     RowBox[{
     "let", " ", "the", " ", "reflection", " ", "matrix", " ", "off", " ", 
      "the", " ", "side", " ", "which", " ", "recieves", " ", "a"}], " ", "-", 
     RowBox[{
     "1", " ", "sign", " ", "change", " ", "be", " ", "called", " ", "aR", 
      " ", "for", " ", "anti"}], "-", "reflection"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "R1", ",", " ", "aR1", ",", " ", "T1", ",", " ", "R2", ",", "aR2", ",", 
      "T2", ",", " ", "RBS", ",", " ", "aRBS", ",", " ", "TBS"}], "}"}], " ", 
    "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r1", " ", "Id"}], ",", " ", 
      RowBox[{
       RowBox[{"-", "r1"}], " ", "Id"}], ",", " ", 
      RowBox[{"t1", " ", "Id"}], ",", " ", "Id", ",", 
      RowBox[{"-", "Id"}], ",", 
      RowBox[{"0", " ", "Id"}], ",", " ", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "2"}]]], "Id"}], ",", " ", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", 
         SuperscriptBox["2", 
          RowBox[{"1", "/", "2"}]]]}], "Id"}], ",", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "2"}]]], "Id"}]}], " ", "}"}]}], ";"}], "\n", 
  RowBox[{"(*", "rotation", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", "\[Phi]_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", "\[Phi]", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]},
      {
       RowBox[{"Sin", "[", "\[Phi]", "]"}], 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}
     }], ")"}]}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "propagation", " ", "across", " ", "a", " ", "space", " ", "of", " ", 
     "length", " ", "D"}], " ", "=", " ", 
    RowBox[{"L", " ", "+", " ", "\[Delta]l"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SpacePropa", "[", 
    RowBox[{"L_", ",", "\[Delta]l_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"\[ImaginaryI]", " ", 
      FractionBox["\[CapitalOmega]", "c"], 
      RowBox[{"(", 
       RowBox[{"L", "+", "\[Delta]l"}], ")"}]}], "]"}], 
    RowBox[{"P", "[", 
     FractionBox[
      RowBox[{
       SubscriptBox["\[Omega]", "0"], " ", "\[Delta]l"}], "c"], "]"}]}]}], 
  "\n", 
  RowBox[{"(*", "squeezer", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSqz", "[", 
    RowBox[{"r_", ",", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Phi]"}], "]"}], 
         RowBox[{"Sinh", "[", "r", "]"}]}], "+", 
        RowBox[{"Cosh", "[", "r", "]"}]}], 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}], 
        RowBox[{"Sinh", "[", "r", "]"}]}]},
      {
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}], 
        RowBox[{"Sinh", "[", "r", "]"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Phi]"}], "]"}]}], 
         RowBox[{"Sinh", "[", "r", "]"}]}], "+", 
        RowBox[{"Cosh", "[", "r", "]"}]}]}
     }], ")"}]}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "input", " ", "field", " ", "quadratures", " ", "in", " ", "frequency", 
     " ", "domain"}], ",", " ", 
    RowBox[{
     RowBox[{"caret", "/", "hat"}], " ", 
     RowBox[{"(", "^", ")"}], " ", "means", " ", "frequency", " ", 
     "dependant"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nvec", ",", " ", "avec", ",", " ", "Avec"}], "}"}], " ", "=", 
   " ", 
   RowBox[{"{", 
    RowBox[{GridBox[{
       {
        SubscriptBox[
         OverscriptBox["n", "^"], "1"]},
       {
        SubscriptBox[
         OverscriptBox["n", "^"], "2"]}
      }], ",", GridBox[{
       {
        SubscriptBox[
         OverscriptBox["a", "^"], "1"]},
       {
        SubscriptBox[
         OverscriptBox["a", "^"], "2"]}
      }], ",", GridBox[{
       {
        RowBox[{"A", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "0"], "]"}]}]},
       {
        RowBox[{"A", " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "0"], "]"}]}]}
      }]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.805518009488543*^9, 3.805518036923307*^9}, {
  3.812654849156475*^9, 3.8126548684678164`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"60b81c7e-a887-44a9-b376-43b41f52008d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "squeezing", " ", "midway", " ", "through", " ", "the", " ", "cavity"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cavP", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"SpacePropa", "[", 
        RowBox[{
         FractionBox["L", "2"], ",", 
         FractionBox["\[Delta]l", "2"]}], "]"}], ".", 
       RowBox[{"SSqz", "[", 
        RowBox[{"r", ",", "\[Phi]"}], "]"}], ".", 
       RowBox[{"SpacePropa", "[", 
        RowBox[{
         FractionBox["L", "2"], ",", 
         FractionBox["\[Delta]l", "2"]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"todo", " ", 
      RowBox[{"NB", ":", " ", 
       RowBox[{
        RowBox[{"should", " ", "alter", " ", "the", " ", "set"}], "-", 
        RowBox[{"up", " ", 
         RowBox[{"s", ".", "t", ".", " ", "the"}], " ", "beam", " ", "is", 
         " ", "only", " ", "squeezed", " ", "from", " ", "one", " ", 
         "direction"}]}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "from"}], " ", "M1", " ", "to", " ", 
      "M2", " ", "but", " ", "not", " ", "back", " ", "from", " ", "M2", " ", 
      "to", " ", 
      RowBox[{"M1", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "calculating", " ", "the", " ", "cavity", " ", "reflection", " ", 
      "matrix", " ", "by", " ", "borrowing", " ", "the", " ", "empty", " ", 
      "cavity", " ", "solution", " ", "and", " ", "substituting", " ", "in", 
      " ", "the", " ", "above", " ", "propagation", " ", "matrix", 
      "\[IndentingNewLine]", 
      SubscriptBox["a", "5"]}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["R", "1"], "+", 
        RowBox[{
         SubscriptBox["T", "1"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Id", "-", 
            RowBox[{"P", " ", 
             SubscriptBox["R", "2"], " ", "P", " ", 
             SubscriptBox["R", "1"]}]}], ")"}], 
          RowBox[{"-", "1"}]], "P", " ", 
         SubscriptBox["R", "2"], " ", "P", " ", 
         SubscriptBox["T", "1"]}]}], ")"}], 
      SubscriptBox["a", "0"], "\[IndentingNewLine]", "simplifying", " ", 
      "result", " ", "using", " ", "that", " ", 
      FractionBox[
       RowBox[{"\[Delta]l", " ", "\[CapitalOmega]"}], "c"], " ", 
      RowBox[{"<<", " ", "1"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cavMatrix", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"aR1", "+", 
         RowBox[{"T1", ".", 
          RowBox[{"Inverse", "[", 
           RowBox[{"Id", " ", "-", " ", 
            RowBox[{"cavP", ".", "R2", ".", "cavP", ".", "R1"}]}], "]"}], ".",
           "cavP", ".", "R2", ".", "cavP", ".", "T1"}]}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"\[Delta]l", " ", 
            SubscriptBox["\[Omega]", "0"]}], "c"], "\[Rule]", " ", "\[Psi]"}],
          ",", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"L", "+", "\[Delta]l"}], ")"}], " ", "\[CapitalOmega]"}],
            "c"], "->", 
          FractionBox[
           RowBox[{" ", 
            RowBox[{"L", " ", "\[CapitalOmega]"}]}], "c"]}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "field", " ", "reflected", " ", "off", " ", "the", " ", 
     "cavity"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"areflvec", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"cavMatrix", ".", "nvec"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.805060349494413*^9, 3.8050604603106318`*^9}, {
   3.80506057597893*^9, 3.805060626419115*^9}, 3.8050608741998*^9, {
   3.8050609680671453`*^9, 3.805060968605934*^9}, 3.8054227568794937`*^9, {
   3.8054228642531557`*^9, 3.805422873497765*^9}, {3.805422941389436*^9, 
   3.8054229428453293`*^9}, {3.8054229997411547`*^9, 3.805423014434753*^9}, {
   3.805513382945775*^9, 3.805513431950033*^9}, {3.805516314433888*^9, 
   3.805516345236754*^9}, {3.8055180513308067`*^9, 3.805518058377935*^9}, 
   3.8055180908796587`*^9, 3.805518153350175*^9, {3.807578922991132*^9, 
   3.807578923383491*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"119ecdc3-6fa1-4c2a-afc0-afebfd72aaf8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "frequency", " ", "domain", " ", "quadratures", " ", "at", " ", "the", " ",
     "photodiodes"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"aPD1vec", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"TBS", ".", 
        RowBox[{"(", 
         RowBox[{"Avec", "+", "avec"}], ")"}]}], "+", 
       RowBox[{"RBS", ".", "areflvec"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"aPD2vec", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"aRBS", ".", 
        RowBox[{"(", 
         RowBox[{"Avec", "+", "avec"}], ")"}]}], "+", 
       RowBox[{"TBS", ".", "areflvec"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.805059943525661*^9, 3.805060036266486*^9}, {
  3.80506008958035*^9, 3.805060106855197*^9}, {3.805060673065486*^9, 
  3.8050606846041193`*^9}, {3.8050608553255873`*^9, 3.8050608564043827`*^9}, {
  3.805422772773703*^9, 3.8054227731621943`*^9}, {3.805513316960659*^9, 
  3.805513319004156*^9}, {3.8055158957113657`*^9, 3.80551592020496*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"2c2c02e4-da7e-4d1a-afcc-29cc0ae90914"],

Cell["\<\
Having found the fields at the photodiodes, we now compute the homodyne \
intensity.\
\>", "Text",
 CellChangeTimes->{{3.812654899980891*^9, 
  3.8126549213227367`*^9}},ExpressionUUID->"8fd3e874-42df-42c3-83af-\
95f9bd8625f6"],

Cell[TextData[Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "homodyne", " ", "readout", " ", "takes", " ", "the", " ", "difference", 
      " ", "between", " ", "the", " ", "two", " ", "photo"}], "-", 
     "currents"}], ",", 
    RowBox[{
    "each", " ", "of", " ", "which", " ", "is", " ", "proportional", " ", 
     "to", " ", "the", " ", "time", " ", "average", " ", "of", " ", "the", 
     " ", "intensity", " ", "of", " ", "the", " ", "field"}], ",", 
    RowBox[{
    "due", " ", "to", " ", "the", " ", "slow", " ", "response", " ", "of", 
     " ", "the", " ", 
     RowBox[{"PD", "'"}], "s"}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    SubscriptBox["i", "hom"], "=", 
    RowBox[{
     SubscriptBox["i", "1"], "-", 
     SubscriptBox["i", "2"]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"let", " ", 
      RowBox[{"tilde", "/", "squiggle"}], " ", 
      RowBox[{"(", "~", ")"}], " ", "mean", " ", "time"}], "-", "domain"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["i", "1"], "\[Proportional]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       OverscriptBox["I", "~"], "[", "t", "]"}], "\[RightAngleBracket]"}]}], 
    "=", 
    RowBox[{"\[LeftAngleBracket]", 
     SuperscriptBox[
      RowBox[{"\[LeftBracketingBar]", 
       RowBox[{
        SubscriptBox[
         OverscriptBox[
          OverscriptBox["E", "~"], "^"], "PD1"], "[", "t", "]"}], 
       "\[RightBracketingBar]"}], "2"], "\[RightAngleBracket]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox[
       OverscriptBox["E", "~"], "^"], "PD1"], "[", "t", "]"}], " ", "=", 
    RowBox[{
     SubscriptBox["C", "0"], 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           StyleBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "~"],
            FontVariations->{"Underline"->False}], "^"], 
          StyleBox[
           RowBox[{"PD1", ",", "c"}],
           FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           StyleBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "~"],
            FontVariations->{"Underline"->False}], "^"], 
          StyleBox[
           RowBox[{"PD1", ",", "s"}],
           FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox[
       StyleBox[
        OverscriptBox[
         StyleBox["a",
          FontVariations->{"Underline"->False}], "~"],
        FontVariations->{"Underline"->False}], "^"], 
      StyleBox[
       RowBox[{"PD1", ",", "c"}],
       FontVariations->{"Underline"->False}]], "[", "t", "]"}], " ", "=", " ", 
    RowBox[{"InverseFourierTransform", "[", 
     RowBox[{
      RowBox[{
       StyleBox[
        SubscriptBox[
         OverscriptBox[
          StyleBox["a",
           FontVariations->{"Underline"->False}], "^"], 
         StyleBox[
          RowBox[{"PD1", ",", "c"}],
          FontVariations->{"Underline"->False}]],
        FontVariations->{"Underline"->True}], 
       StyleBox["[",
        FontVariations->{"Underline"->True}], 
       StyleBox["\[CapitalOmega]",
        FontVariations->{"Underline"->False}], 
       StyleBox["]",
        FontVariations->{"Underline"->True}]}], ",", "\[CapitalOmega]", ",", 
      "t"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"time", "-", 
     RowBox[{
     "domain", " ", "intensity", " ", "of", " ", "the", " ", "light", " ", 
      "at", " ", "photo"}], "-", 
     RowBox[{"diode", " ", "1"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["C", "0"], "2"], 
     RowBox[{"\[LeftAngleBracket]", 
      SuperscriptBox[
       RowBox[{"\[LeftBracketingBar]", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             StyleBox[
              OverscriptBox[
               StyleBox["a",
                FontVariations->{"Underline"->False}], "~"],
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD1", ",", "c"}],
             FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             StyleBox[
              OverscriptBox[
               StyleBox["a",
                FontVariations->{"Underline"->False}], "~"],
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD1", ",", "s"}],
             FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], 
        "\[RightBracketingBar]"}], "2"], "\[RightAngleBracket]"}]}]}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "assume", " ", "time", " ", "domain", " ", "quadratures", " ", "are", " ",
      "Hermitian"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["C", "0"], "2"], 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{
          SubscriptBox[
           OverscriptBox[
            StyleBox[
             OverscriptBox[
              StyleBox["a",
               FontVariations->{"Underline"->False}], "~"],
             FontVariations->{"Underline"->False}], "^"], 
           StyleBox[
            RowBox[{"PD1", ",", "c"}],
            FontVariations->{"Underline"->False}]], "[", "t", "]"}], "2"], 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Omega]", "0"], "t"}], "]"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{
          SubscriptBox[
           OverscriptBox[
            StyleBox[
             OverscriptBox[
              StyleBox["a",
               FontVariations->{"Underline"->False}], "~"],
             FontVariations->{"Underline"->False}], "^"], 
           StyleBox[
            RowBox[{"PD1", ",", "s"}],
            FontVariations->{"Underline"->False}]], "[", "t", "]"}], "2"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Omega]", "0"], "t"}], "]"}], 
         RowBox[{"2", " "}]]}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              StyleBox[
               OverscriptBox[
                StyleBox["a",
                 FontVariations->{"Underline"->False}], "~"],
               FontVariations->{"Underline"->False}], "^"], 
             StyleBox[
              RowBox[{"PD1", ",", "c"}],
              FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              StyleBox[
               OverscriptBox[
                StyleBox["a",
                 FontVariations->{"Underline"->False}], "~"],
               FontVariations->{"Underline"->False}], "^"], 
             StyleBox[
              RowBox[{"PD1", ",", "s"}],
              FontVariations->{"Underline"->False}]], "[", "t", "]"}]}], "+", 
          
          RowBox[{
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              StyleBox[
               OverscriptBox[
                StyleBox["a",
                 FontVariations->{"Underline"->False}], "~"],
               FontVariations->{"Underline"->False}], "^"], 
             StyleBox[
              RowBox[{"PD1", ",", "s"}],
              FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              StyleBox[
               OverscriptBox[
                StyleBox["a",
                 FontVariations->{"Underline"->False}], "~"],
               FontVariations->{"Underline"->False}], "^"], 
             StyleBox[
              RowBox[{"PD1", ",", "c"}],
              FontVariations->{"Underline"->False}]], "[", "t", "]"}]}]}], 
         ")"}], 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], 
      "\[RightAngleBracket]"}]}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"time", " ", "average", " ", "of", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Omega]", "0"], "t"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Omega]", "0"], "t"}], "]"}], " ", "is", " ", "zero"}],
      ",", " ", 
     RowBox[{"time", " ", "average", " ", "of", " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Omega]", "0"], "t"}], "]"}], "2"], " ", "or", " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["\[Omega]", "0"], "t"}], "]"}], "2"], " ", "is", " ", 
      RowBox[{
       FractionBox["1", "2"], ".", "\[IndentingNewLine]", "then"}], " ", 
      "assume", " ", "quadratures", " ", "change", " ", "slowly", " ", "wrt", 
      " ", 
      SubscriptBox["\[Omega]", "0"]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       SubscriptBox["C", "0"], "2"], "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           StyleBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "~"],
            FontVariations->{"Underline"->False}], "^"], 
          StyleBox[
           RowBox[{"PD1", ",", "c"}],
           FontVariations->{"Underline"->False}]], "[", "t", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           StyleBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "~"],
            FontVariations->{"Underline"->False}], "^"], 
          StyleBox[
           RowBox[{"PD1", ",", "s"}],
           FontVariations->{"Underline"->False}]], "[", "t", "]"}], "2"]}], 
      ")"}]}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "spliting", " ", "time", " ", "signals", " ", "into", " ", "average", " ",
      "and", " ", "time", " ", "varying", " ", "parts"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox[
       StyleBox[
        OverscriptBox[
         StyleBox["a",
          FontVariations->{"Underline"->False}], "~"],
        FontVariations->{"Underline"->False}], "^"], 
      StyleBox[
       RowBox[{"PD1", ",", "c"}],
       FontVariations->{"Underline"->False}]], "[", "t", "]"}], " ", "=", " ", 
    RowBox[{
     SubscriptBox["B", 
      RowBox[{"1", ",", "c"}]], "+", 
     RowBox[{
      SubscriptBox[
       OverscriptBox[
        OverscriptBox["b", "~"], "^"], 
       RowBox[{"1", ",", "c"}]], "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox[
       StyleBox[
        OverscriptBox[
         StyleBox["a",
          FontVariations->{"Underline"->False}], "~"],
        FontVariations->{"Underline"->False}], "^"], 
      StyleBox[
       RowBox[{"PD1", ",", "s"}],
       FontVariations->{"Underline"->False}]], "[", "t", "]"}], " ", "=", " ", 
    RowBox[{
     SubscriptBox["B", 
      RowBox[{"1", ",", "s"}]], "+", 
     RowBox[{
      SubscriptBox[
       OverscriptBox[
        OverscriptBox["b", "~"], "^"], 
       RowBox[{"1", ",", "s"}]], "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       SubscriptBox["C", "0"], "2"], "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["B", 
           RowBox[{"1", ",", "c"}]], "+", 
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             OverscriptBox["b", "~"], "^"], 
            RowBox[{"1", ",", "c"}]], "[", "t", "]"}]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["B", 
           RowBox[{"1", ",", "s"}]], "+", 
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             OverscriptBox["b", "~"], "^"], 
            RowBox[{"1", ",", "s"}]], "[", "t", "]"}]}], ")"}], "2"]}], 
      ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       SubscriptBox["C", "0"], "2"], "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["B", 
         RowBox[{"1", ",", "c"}]], "2"], "+", 
       SuperscriptBox[
        SubscriptBox["B", 
         RowBox[{"1", ",", "s"}]], "2"], "+", 
       SuperscriptBox[
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           OverscriptBox["b", "~"], "^"], 
          RowBox[{"1", ",", "s"}]], "[", "t", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           OverscriptBox["b", "~"], "^"], 
          RowBox[{"1", ",", "c"}]], "[", "t", "]"}], "2"], "+", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "c"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              OverscriptBox["b", "~"], "^"], 
             RowBox[{"1", ",", "c"}]], "[", "t", "]"}]}], "+", 
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "s"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              OverscriptBox["b", "~"], "^"], 
             RowBox[{"1", ",", "s"}]], "[", "t", "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "assume", " ", "time", " ", "varying", " ", "part", " ", "is", " ", 
     "small", " ", "wrt", " ", "average", " ", 
     RowBox[{"s", ".", "t", ".", " ", "time"}], " ", "varying", " ", "part", 
     " ", "squared", " ", "is", " ", "vanishingly", " ", "small", 
     "\[IndentingNewLine]", "this", " ", "is", " ", "true", " ", "for", " ", 
     "comparing", " ", "quantum", " ", "noise", " ", "to", " ", "the", " ", 
     "local", " ", "oscillator"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       SubscriptBox["C", "0"], "2"], "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["B", 
         RowBox[{"1", ",", "c"}]], "2"], "+", 
       SuperscriptBox[
        SubscriptBox["B", 
         RowBox[{"1", ",", "s"}]], "2"], "+", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "c"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              OverscriptBox["b", "~"], "^"], 
             RowBox[{"1", ",", "c"}]], "[", "t", "]"}]}], "+", 
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "s"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              OverscriptBox["b", "~"], "^"], 
             RowBox[{"1", ",", "s"}]], "[", "t", "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"apply", " ", "Fourier", " ", "transform"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["I", "PD1"], "[", "\[CapitalOmega]", "]"}], " ", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       SubscriptBox["C", "0"], "2"], "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["B", 
            RowBox[{"1", ",", "c"}]], "2"], "+", 
          SuperscriptBox[
           SubscriptBox["B", 
            RowBox[{"1", ",", "s"}]], "2"]}], ")"}], 
        RowBox[{"\[Delta]", "[", 
         RowBox[{"\[CapitalOmega]", "-", "0"}], "]"}]}], "+", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "c"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox["b", "^"], 
             RowBox[{"1", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]}], "+", 
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "s"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox["b", "^"], 
             RowBox[{"1", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}]}], 
         ")"}]}]}], ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "but", " ", "we", " ", "are", " ", "only", " ", "interested", " ", "in", 
      " ", "the", " ", "quantum", " ", "noise"}], ",", " ", 
     RowBox[{"not", " ", "the", " ", "DC", " ", "part"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["I", "PD1"], "[", "\[CapitalOmega]", "]"}], " ", "=", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["C", "0"], "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"1", ",", "c"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"1", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]}], "+", 
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"1", ",", "s"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"1", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}]}], 
      ")"}]}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "homodyne", " ", "readout", " ", "is", " ", "proportional", " ", "to", 
      " ", "the", " ", "difference", " ", "in", " ", "intensities"}], ",", 
     " ", 
     RowBox[{
     "since", " ", "the", " ", "Fourier", " ", "transform", " ", "is", " ", 
      "linear", " ", "we", " ", "can", " ", "look", " ", "at", " ", "the", 
      " ", "difference", " ", "in", " ", "the", " ", "spectra"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["I", "hom"], "[", "\[CapitalOmega]", "]"}], "=", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{
       SubscriptBox["I", "PD1"], "[", "\[CapitalOmega]", "]"}], "-", 
      RowBox[{
       SubscriptBox["I", "PD2"], "[", "\[CapitalOmega]", "]"}]}], 
     "\[RightAngleBracket]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["I", "hom"], "[", "\[CapitalOmega]", "]"}], "=", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["C", "0"], "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"1", ",", "c"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"1", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]}], "+", 
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"1", ",", "s"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"1", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}], "-", 
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"2", ",", "c"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"2", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]}], "-", 
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"2", ",", "s"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"2", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}]}], 
      ")"}]}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "identify", " ", "these", " ", "components", " ", "as", " ", "the", " ", 
     "constant", " ", "and", " ", "frequency", " ", "dependant", " ", "parts",
      " ", "of", " ", "the", " ", "original", " ", "quadratures"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"aPD1vec", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          StyleBox[
           SubscriptBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD1", ",", "c"}],
             FontVariations->{"Underline"->False}]],
           FontVariations->{"Underline"->True}], 
          StyleBox["[",
           FontVariations->{"Underline"->True}], 
          StyleBox["\[CapitalOmega]",
           FontVariations->{"Underline"->False}], 
          StyleBox["]",
           FontVariations->{"Underline"->True}]}]},
        {
         RowBox[{
          StyleBox[
           SubscriptBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD1", ",", "s"}],
             FontVariations->{"Underline"->False}]],
           FontVariations->{"Underline"->True}], 
          StyleBox["[",
           FontVariations->{"Underline"->True}], 
          StyleBox["\[CapitalOmega]",
           FontVariations->{"Underline"->False}], 
          StyleBox["]",
           FontVariations->{"Underline"->True}]}]}
       }], ")"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubscriptBox["B", 
           RowBox[{"1", ",", "c"}]]},
         {
          SubscriptBox["B", 
           RowBox[{"1", ",", "s"}]]}
        }], ")"}], " ", "+", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           SubscriptBox[
            OverscriptBox["b", "^"], 
            RowBox[{"1", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]},
         {
          RowBox[{
           SubscriptBox[
            OverscriptBox["b", "^"], 
            RowBox[{"1", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}
        }], ")"}]}]}]}], " ", "\[IndentingNewLine]", 
   RowBox[{"aPD2vec", "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          StyleBox[
           SubscriptBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD2", ",", "c"}],
             FontVariations->{"Underline"->False}]],
           FontVariations->{"Underline"->True}], 
          StyleBox["[",
           FontVariations->{"Underline"->True}], 
          StyleBox["\[CapitalOmega]",
           FontVariations->{"Underline"->False}], 
          StyleBox["]",
           FontVariations->{"Underline"->True}]}]},
        {
         RowBox[{
          StyleBox[
           SubscriptBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD2", ",", "s"}],
             FontVariations->{"Underline"->False}]],
           FontVariations->{"Underline"->True}], 
          StyleBox["[",
           FontVariations->{"Underline"->True}], 
          StyleBox["\[CapitalOmega]",
           FontVariations->{"Underline"->False}], 
          StyleBox["]",
           FontVariations->{"Underline"->True}]}]}
       }], ")"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubscriptBox["B", 
           RowBox[{"2", ",", "c"}]]},
         {
          SubscriptBox["B", 
           RowBox[{"2", ",", "s"}]]}
        }], ")"}], " ", "+", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           SubscriptBox[
            OverscriptBox["b", "^"], 
            RowBox[{"2", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]},
         {
          RowBox[{
           SubscriptBox[
            OverscriptBox["b", "^"], 
            RowBox[{"2", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}
        }], ")"}]}]}]}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"NB", ":", " ", 
      RowBox[{"this", " ", 
       RowBox[{"doesn", "'"}], "t", " ", "sound", " ", "true"}]}], ",", " ", 
     RowBox[{
     "the", " ", "added", " ", "constant", " ", "picks", " ", "up", " ", "a", 
      " ", "delta", " ", "function", " ", "when", " ", "transformed", " ", 
      "forwards", " ", "or", " ", 
      RowBox[{"backwards", "?"}]}]}], "*)"}]}]}]], "Input",
 CellFrame->{{0, 0}, {0, 2}},
 CellChangeTimes->{{3.805513868266603*^9, 3.8055139485825787`*^9}, {
  3.805515530528767*^9, 3.805515537024125*^9}, {3.805515575338846*^9, 
  3.8055155966522913`*^9}, {3.805518215856917*^9, 
  3.805518216504794*^9}},ExpressionUUID->"1c716c22-cd95-4036-8a5e-\
e3aaac0084b8"]], "Text",
 CellChangeTimes->{
  3.805518316350728*^9, {3.8055183491365547`*^9, 3.805518371854121*^9}, 
   3.805523936428537*^9},ExpressionUUID->"400161cc-835d-4015-8163-\
4d30c1a0797b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "spotting", " ", "the", " ", "frequency", " ", "dependent", " ", 
    "sections", " ", "by", " ", "eye"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Column", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"aPD1vec", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"aPD1vec", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"aPD2vec", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"aPD2vec", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.805515634410458*^9, 3.805515635276225*^9}, {
   3.805516533463911*^9, 3.8055165374180737`*^9}, {3.8055178499362497`*^9, 
   3.805517869116086*^9}, 3.8055182729122458`*^9, {3.805518392623622*^9, 
   3.8055184755812273`*^9}, {3.805518538320611*^9, 3.805518545513605*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"538a57be-ccd9-4342-af09-0d8258f20fce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     SuperscriptBox["2", 
      RowBox[{"1", "/", "2"}]], " ", "expression", " ", "for", " ", "freq"}], 
    "-", 
    RowBox[{"dependent", " ", "avoids", " ", "using", " ", "Simplify"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["B", 
         RowBox[{"1", ",", "c"}]], 
        SubscriptBox[
         OverscriptBox["b", "^"], 
         RowBox[{"1", ",", "c"}]]},
       {
        SubscriptBox["B", 
         RowBox[{"1", ",", "s"}]], 
        SubscriptBox[
         OverscriptBox["b", "^"], 
         RowBox[{"1", ",", "s"}]]},
       {
        SubscriptBox["B", 
         RowBox[{"2", ",", "c"}]], 
        SubscriptBox[
         OverscriptBox["b", "^"], 
         RowBox[{"2", ",", "c"}]]},
       {
        SubscriptBox["B", 
         RowBox[{"2", ",", "s"}]], 
        SubscriptBox[
         OverscriptBox["b", "^"], 
         RowBox[{"2", ",", "s"}]]}
      }], ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"1", "/", "2"}]]], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"A", " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"aPD1vec", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], 
           SubscriptBox["B", 
            RowBox[{"1", ",", "c"}]]}]}]},
        {
         RowBox[{"A", " ", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"aPD1vec", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], 
           SubscriptBox["B", 
            RowBox[{"1", ",", "s"}]]}]}]},
        {
         RowBox[{
          RowBox[{"-", "A"}], " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"aPD2vec", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], 
           SubscriptBox["B", 
            RowBox[{"2", ",", "c"}]]}]}]},
        {
         RowBox[{
          RowBox[{"-", "A"}], " ", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"aPD2vec", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], 
           SubscriptBox["B", 
            RowBox[{"2", ",", "s"}]]}]}]}
       }], ")"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.805517201742526*^9, 3.805517260542101*^9}, {
  3.805517361025305*^9, 3.805517383796362*^9}, {3.805517790800758*^9, 
  3.805517830472193*^9}, {3.8055185899405947`*^9, 3.805518735049914*^9}, {
  3.805518771742667*^9, 3.805518772282138*^9}, {3.805518859751245*^9, 
  3.8055189051710653`*^9}, {3.805519017426511*^9, 3.8055190419226713`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"a577ebcd-04f6-49b8-b579-2c11c0442b23"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"computing", " ", "the", " ", "homodyne", " ", "intensity", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], "=", " ", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["I", "hom"], "^"], "[", "\[CapitalOmega]", "]"}]}], 
      ")"}], " ", "in", " ", "frequency", " ", "domain", 
     "\[IndentingNewLine]", 
     RowBox[{"NB", ":", " ", 
      RowBox[{
       RowBox[{"I", "'"}], "ve", " ", "dropped", " ", 
       SubscriptBox["C", "0"], " ", "here"}]}]}], ",", " ", 
    RowBox[{"should", " ", "it", " ", "have", " ", "stayed", " ", 
     RowBox[{"it", "?", " ", "and"}], " ", "if", " ", "so"}], ",", " ", 
    RowBox[{"what", " ", "is", " ", 
     RowBox[{"it", "?"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    OverscriptBox["HomI", "^"], "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", 
        RowBox[{"1", ",", "c"}]], 
       SubscriptBox[
        OverscriptBox["b", "^"], 
        RowBox[{"1", ",", "c"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", 
        RowBox[{"1", ",", "s"}]], 
       SubscriptBox[
        OverscriptBox["b", "^"], 
        RowBox[{"1", ",", "s"}]]}], "-", 
      RowBox[{
       SubscriptBox["B", 
        RowBox[{"2", ",", "c"}]], 
       SubscriptBox[
        OverscriptBox["b", "^"], 
        RowBox[{"2", ",", "c"}]]}], "-", 
      RowBox[{
       SubscriptBox["B", 
        RowBox[{"2", ",", "s"}]], 
       SubscriptBox[
        OverscriptBox["b", "^"], 
        RowBox[{"2", ",", "s"}]]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "notice", " ", "that", " ", "the", " ", "laser", " ", "noise", " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["a", "^"], "1"], ",", 
        SubscriptBox[
         OverscriptBox["a", "^"], "2"]}], ")"}], " ", "has", " ", "cancelled",
       " ", "out"}], ",", " ", 
     RowBox[{
     "just", " ", "as", " ", "expected", " ", "for", " ", "homodyne", " ", 
      "readout"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{
  3.8055178848866787`*^9, {3.8055191075457478`*^9, 3.805519315161327*^9}, {
   3.805519721598878*^9, 3.805519721849345*^9}, {3.805520260364334*^9, 
   3.8055204104913273`*^9}, {3.805520544463285*^9, 3.8055206447047167`*^9}, {
   3.80552071073689*^9, 3.805520752429997*^9}, {3.8055217772502613`*^9, 
   3.805521782349103*^9}, {3.805521933576976*^9, 3.805521935399577*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"c6ef84fd-f5e0-4a24-aceb-de1d43bea371"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"extracting", " ", "the", " ", "co"}], "-", 
     RowBox[{"efficients", " ", "of", " ", 
      SubscriptBox[
       OverscriptBox["n", "^"], "1"]}]}], ",", " ", 
    SubscriptBox[
     OverscriptBox["n", "^"], "2"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"g1", "[", 
     RowBox[{
     "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "L_", ",", "\[Psi]_", 
      ",", "r_", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       SuperscriptBox["r1", "3"], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", "r1", " ", 
       SuperscriptBox["t1", "2"], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       SuperscriptBox[
        RowBox[{"Cosh", "[", "r", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["r1", "2"]}], "+", 
            SuperscriptBox["t1", "2"]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["t1", "2"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["r1", "2"]}], "+", 
         SuperscriptBox["t1", "2"]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       SuperscriptBox["t1", "2"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sinh", "[", 
        RowBox[{"2", " ", "r"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       SuperscriptBox["t1", "2"], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sinh", "[", 
        RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g2", "[", 
     RowBox[{
     "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "L_", ",", "\[Psi]_", 
      ",", "r_", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       SuperscriptBox[
        RowBox[{"Cosh", "[", "r", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["t1", "2"], " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["r1", "2"]}], "+", 
            SuperscriptBox["t1", "2"]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       SuperscriptBox["t1", "2"], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cosh", "[", "r", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sinh", "[", "r", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"r1", "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]], " ", 
          SuperscriptBox["r1", "3"]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]], " ", "r1", " ", 
          SuperscriptBox["t1", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["r1", "2"]}], "+", 
            SuperscriptBox["t1", "2"]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]], " ", 
          SuperscriptBox["t1", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g3", "[", 
     RowBox[{
     "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "L_", ",", "\[Psi]_", 
      ",", "r_", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       SuperscriptBox["r1", "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", "r1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", "r1", " ", 
       SuperscriptBox[
        RowBox[{"Sinh", "[", "r", "]"}], "2"]}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8055232308581657`*^9, 3.805523272017584*^9}, {
  3.805523304608532*^9, 3.805523517265197*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"eb69f030-4f96-4769-94b8-3d3310292795"],

Cell[TextData[Cell[BoxData[{
 RowBox[{
  RowBox[{
   OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], "=", " ", 
  RowBox[{
   FractionBox["A", 
    RowBox[{"g3", "[", 
     RowBox[{
      RowBox[{"\[CapitalOmega]", ";", "r1"}], ",", "t1", ",", "L", ",", 
      "\[Psi]", ",", "r", ",", "\[Phi]", ",", 
      SubscriptBox["\[Theta]", "0"]}], "]"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"g1", "[", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", ";", "r1"}], ",", "t1", ",", "L", ",", 
        "\[Psi]", ",", "r", ",", "\[Phi]", ",", 
        SubscriptBox["\[Theta]", "0"]}], "]"}], 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}]}], " ", 
     "\[IndentingNewLine]", "+", " ", 
     RowBox[{
      RowBox[{"g2", "[", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", ";", "r1"}], ",", "t1", ",", "L", ",", 
        "\[Psi]", ",", "r", ",", "\[Phi]", ",", 
        SubscriptBox["\[Theta]", "0"]}], "]"}], 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], "=", " ", 
  RowBox[{
   FractionBox["A", 
    RowBox[{"g3", "[", "\[CapitalOmega]", "]"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}]}], " ", 
     "+", " ", 
     RowBox[{
      RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}]}]}], 
    ")"}]}]}]}], \
"Input",ExpressionUUID->"6831ee72-943f-4115-bb31-35f3e1be3e20"]], "Text",
 CellChangeTimes->{
  3.812654942877351*^9},ExpressionUUID->"05608f11-2300-4b1d-af40-\
e150792d2ac5"],

Cell["Having found the homodyne intensity, we now compute its PSD.", "Text",
 CellChangeTimes->{{3.8126549510109787`*^9, 
  3.812654961930221*^9}},ExpressionUUID->"12931b0c-38cc-4731-8972-\
b4b85a689d53"],

Cell[TextData[Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "computing", " ", "the", " ", "power", " ", "spectral", " ", "density",
         " ", 
        RowBox[{"(", "PSD", ")"}], " ", "of", " ", "the", " ", "homodyne", 
        " ", "intensity"}], ",", " ", 
       RowBox[{
        RowBox[{"this", " ", "quantifies", " ", "the", " ", "quantum", " ", 
         RowBox[{"noise", ".", "\[IndentingNewLine]", "Let"}]}], " ", "|", 
        "0"}]}], "\[RightAngleBracket]"}], " ", "represent", " ", "the", " ", 
     "vacuum", " ", 
     RowBox[{"(", "ground", ")"}], " ", "state"}], ",", " ", 
    RowBox[{"for", " ", "reasons", " ", "I", " ", 
     RowBox[{"don", "'"}], "t", " ", "understand"}], ",", " ", 
    RowBox[{
    "we", " ", "take", " ", "expectation", " ", "against", " ", "this", " ", 
     "instead", " ", "of", " ", "the", " ", "actual", " ", 
     RowBox[{"state", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      OverscriptBox[
       SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", 
     "2", "\[Pi]", " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[CapitalOmega]", "-", 
       RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], " ", "=", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"0", "|", 
      RowBox[{
       RowBox[{
        OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], 
       "\[EmptyCircle]", 
       RowBox[{
        RowBox[{
         OverscriptBox["HomI", "^"], "\[ConjugateTranspose]"}], "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "|", "0"}], 
     "\[RightAngleBracket]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"[", "D", "]"}], "pg", ".35"}], ",", " ", 
     RowBox[{
     "from", " ", "assuming", " ", "the", " ", "time", " ", "domain", " ", 
      "is", " ", "Hermitian"}], ",", " ", 
     RowBox[{
      RowBox[{"frequency", " ", "domain", " ", "obeys", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["a", 
          RowBox[{"c", ",", "s"}]], "\[Dagger]"], "[", "\[CapitalOmega]", 
        "]"}]}], " ", "=", " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"c", ",", "s"}]], "[", 
       RowBox[{"-", "\[CapitalOmega]"}], "]"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"NB", ":", " ", 
      RowBox[{"for", " ", "now"}]}], ",", " ", 
     RowBox[{
      RowBox[{"I", "'"}], "ll", " ", "assume", " ", 
      RowBox[{
       OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], " ", "is", 
      " ", "Hermitian"}], ",", " ", 
     RowBox[{
     "although", " ", "I", " ", "think", " ", "that", " ", "this", " ", "is", 
      " ", "wrong"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      OverscriptBox[
       SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", 
     "2", "\[Pi]", " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[CapitalOmega]", "-", 
       RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], " ", "=", " ", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"0", "|", 
       RowBox[{
        RowBox[{
         RowBox[{
          OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], 
         RowBox[{
          RowBox[{
           OverscriptBox["HomI", "^"], "\[ConjugateTranspose]"}], "[", 
          RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{
           OverscriptBox["HomI", "^"], "\[ConjugateTranspose]"}], "[", 
          RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
         RowBox[{
          OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}]}]}], "|", 
       "0"}], "\[RightAngleBracket]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      OverscriptBox[
       SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", 
     "2", "\[Pi]", " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[CapitalOmega]", "-", 
       RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], " ", "=", " ", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"0", "|", 
       RowBox[{
        RowBox[{
         FractionBox["A", 
          RowBox[{"g3", "[", "\[CapitalOmega]", "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
            RowBox[{
             SubscriptBox[
              OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}]}], 
           " ", "+", " ", 
           RowBox[{
            RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
            RowBox[{
             SubscriptBox[
              OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", 
             "]"}]}]}], ")"}], 
         FractionBox["A", 
          RowBox[{"g3", "[", 
           RowBox[{"\[CapitalOmega]", "'"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"g1", "[", 
             RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
            RowBox[{
             SubscriptBox[
              OverscriptBox["n", "^"], "1"], "[", 
             RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"g2", "[", 
             RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
            RowBox[{
             SubscriptBox[
              OverscriptBox["n", "^"], "2"], "[", 
             RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["A", 
          RowBox[{"g3", "[", 
           RowBox[{"\[CapitalOmega]", "'"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"g1", "[", 
             RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
            RowBox[{
             SubscriptBox[
              OverscriptBox["n", "^"], "1"], "[", 
             RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"g2", "[", 
             RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
            RowBox[{
             SubscriptBox[
              OverscriptBox["n", "^"], "2"], "[", 
             RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]}], ")"}], 
         FractionBox["A", 
          RowBox[{"g3", "[", "\[CapitalOmega]", "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
            RowBox[{
             SubscriptBox[
              OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}]}], 
           " ", "+", " ", 
           RowBox[{
            RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
            RowBox[{
             SubscriptBox[
              OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", 
             "]"}]}]}], ")"}]}]}], "|", "0"}], "\[RightAngleBracket]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "expanding", " ", "out", " ", "terms", " ", "and", " ", "spotting", " ", 
     "symmetric", " ", "products"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      OverscriptBox[
       SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", 
     "2", "\[Pi]", " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[CapitalOmega]", "-", 
       RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], " ", "=", " ", 
    RowBox[{
     FractionBox[
      SuperscriptBox["A", "2"], 
      RowBox[{
       RowBox[{"g3", "[", "\[CapitalOmega]", "]"}], 
       RowBox[{"g3", "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]], 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"0", "|", 
       RowBox[{
        RowBox[{
         RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
         RowBox[{"g1", "[", 
          RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
           "\[EmptyCircle]", 
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "1"], "[", 
            RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
         RowBox[{"g2", "[", 
          RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
           "\[EmptyCircle]", 
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "2"], "[", 
            RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], ")"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
         RowBox[{"g2", "[", 
          RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
           "\[EmptyCircle]", 
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "2"], "[", 
            RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
         RowBox[{"g1", "[", 
          RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
           "\[EmptyCircle]", 
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "1"], "[", 
            RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], ")"}]}]}], "|", "0"}], 
      "\[RightAngleBracket]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"results", " ", "from", " ", "the", " ", "top", " ", 
     RowBox[{"of", " ", "[", "D", "]"}], "pg", ".38"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"the", " ", "factor", " ", "of", " ", 
      FractionBox["1", "2"], " ", "is", " ", "what", " ", "determines", " ", 
      "the", " ", "large", " ", "r", " ", "limit", " ", "of", " ", "PSD", " ", 
      RowBox[{"(", 
       RowBox[{
       "but", " ", "our", " ", "model", " ", "is", " ", "invalid", " ", "in", 
        " ", "this", " ", "limit", " ", "so", " ", 
        RowBox[{"don", "'"}], "t", " ", "worry", " ", "about", " ", "it"}], 
       ")"}], "\[IndentingNewLine]", "it", " ", "comes", " ", "from", " ", 
      "using", " ", "two"}], "-", " ", 
     RowBox[{"or", " ", "one"}], "-", 
     RowBox[{"sided", " ", "PSD"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"0", "|", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
       "\[EmptyCircle]", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "1"], "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "|", "0"}], 
     "\[RightAngleBracket]"}], " ", "=", " ", 
    RowBox[{
     FractionBox["1", "2"], "2", "\[Pi]", " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[CapitalOmega]", "-", 
       RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"0", "|", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
       "\[EmptyCircle]", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "2"], "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "|", "0"}], 
     "\[RightAngleBracket]"}], " ", "=", " ", 
    RowBox[{
     FractionBox["1", "2"], "2", "\[Pi]", " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[CapitalOmega]", "-", 
       RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"0", "|", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
       "\[EmptyCircle]", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "2"], "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], " ", "|", "0"}], 
     "\[RightAngleBracket]"}], "=", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"0", "|", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
        "\[EmptyCircle]", 
        RowBox[{
         SubscriptBox[
          OverscriptBox["n", "^"], "1"], "[", 
         RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], " ", "|", "0"}], 
      "\[RightAngleBracket]"}], "=", " ", "0"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "as", " ", "so", " ", "we", " ", "have", " ", "the", " ", "PSD", " ", 
      "of", " ", "the", " ", "homodyne", " ", "intensity"}], ",", " ", 
     RowBox[{
     "to", " ", "quantify", " ", "the", " ", "quantum", " ", "noise"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      OverscriptBox[
       SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[CapitalOmega]", "-", 
       RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], " ", "=", " ", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["A", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
          RowBox[{"g1", "[", 
           RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
          RowBox[{"g2", "[", 
           RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]}], ")"}]}], 
      RowBox[{"2", 
       RowBox[{"g3", "[", "\[CapitalOmega]", "]"}], 
       RowBox[{"g3", "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]], 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[CapitalOmega]", "-", 
       RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     OverscriptBox[
      SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", 
    "=", " ", 
    FractionBox[
     RowBox[{
      SuperscriptBox["A", "2"], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], "2"]}], ")"}]}], 
     RowBox[{"2", 
      SuperscriptBox[
       RowBox[{"g3", "[", "\[CapitalOmega]", "]"}], "2"]}]]}]}]}]], "Input",
 CellChangeTimes->{{3.805425327335909*^9, 3.805425353277169*^9}, {
   3.80542606670446*^9, 3.805426077824092*^9}, 3.805513119714265*^9, {
   3.8055132659587927`*^9, 3.8055132888678923`*^9}, 3.805515125648028*^9, {
   3.805515239246922*^9, 3.805515239366498*^9}, {3.8055158336980133`*^9, 
   3.8055158456038637`*^9}, {3.805520003392823*^9, 3.805520057417431*^9}, 
   3.805520827035976*^9, {3.805520919592492*^9, 
   3.805521002318198*^9}},ExpressionUUID->"9dd7e2a2-4d60-461f-862a-\
c8b37fd06d19"]], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQbZexe11J1BtHAd+MTSB6Sc7bnSB63Q37XSBax9Xz
CIgOStkJpifF55wC0YcSIPTxXd23QXRXxan3ILpg66cvIDpE3PE32ByuP0yl
QHryw/28INrt1jcJEC12Yb0OiE68ZGgPovXOGIHpRYb33UD0uYSGEBD9o+Bm
BIhe9p4tGUT/eZaYDqLrHu3JBtH3nl4sANG7H/0uBtEMCt3NIDqiRr4VRJe5
cveA6Kx1N2eA9U3gWwCiFdptwXTd8437QPSCdxB6homuTnb0G0eDOQv0QfTz
bjVzED25rhtMn5nOKDol5o3jZcNDciD6jt6B1/wZbxydYvXegGgAf8KsPw==

  "],ExpressionUUID->"8d1e2bf2-1502-48c5-bdca-c43e07e3d292"],

Cell[BoxData[
 RowBox[{"setupSHomI", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["A", "2"], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"g1", "[", 
          RowBox[{
          "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "L", ",", "\[Psi]", 
           ",", "r", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"g2", "[", 
          RowBox[{
          "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "L", ",", "\[Psi]", 
           ",", "r", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "2"]}], ")"}]}],
      ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", 
      SuperscriptBox[
       RowBox[{"g3", "[", 
        RowBox[{
        "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "L", ",", "\[Psi]", ",",
          "r", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "2"]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.806375763414126*^9, 3.806375779374195*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"1edb6a28-5f6c-4bfd-9e3f-76799b750267"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"c", " ", "=", " ", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"10", " "}], "8"]}]}], " ", 
    RowBox[{"(*", 
     RowBox[{"m", " ", 
      SuperscriptBox["s", 
       RowBox[{"-", "1"}]]}], "*)"}], ",", " ", 
    RowBox[{"L", " ", "in", " ", "m"}], ",", " ", 
    RowBox[{"\[CapitalOmega]", " ", "in", " ", "Hz"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SHomI", "[", 
    RowBox[{
    "inA_", ",", "in\[CapitalOmega]_", ",", "inr1_", ",", "int1_", ",", 
     "inL_", ",", "in\[Psi]_", ",", "inr_", ",", "in\[Phi]_", ",", 
     "in\[Theta]_"}], "]"}], " ", ":=", " ", 
   RowBox[{"setupSHomI", " ", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "\[Rule]", "inA"}], ",", 
      RowBox[{"\[CapitalOmega]", "\[Rule]", "in\[CapitalOmega]"}], ",", 
      RowBox[{"r1", "\[Rule]", "inr1"}], ",", 
      RowBox[{"t1", "\[Rule]", "int1"}], ",", 
      RowBox[{"L", "\[Rule]", "inL"}], ",", 
      RowBox[{"\[Psi]", "\[Rule]", "in\[Psi]"}], ",", 
      RowBox[{"r", "\[Rule]", "inr"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "in\[Phi]"}], ",", 
      RowBox[{"\[Theta]", "\[Rule]", "in\[Theta]"}], ",", 
      RowBox[{"c", "->", " ", 
       RowBox[{"3", " ", 
        SuperscriptBox["10", "8"]}]}]}], "}"}]}]}]}]], "Input",
 CellFrame->{{0, 0}, {2, 0}},
 CellChangeTimes->{{3.8055228257890463`*^9, 3.80552282640447*^9}, 
   3.8055232113105183`*^9, {3.805523541153281*^9, 3.805523673760887*^9}, {
   3.805523748198502*^9, 3.805523818140089*^9}, 3.805523868009508*^9, {
   3.806026120981614*^9, 3.80602613447482*^9}, {3.806026196188568*^9, 
   3.8060262123649054`*^9}, {3.8063756098793592`*^9, 3.806375696100008*^9}, {
   3.8063758001253977`*^9, 3.806375815809841*^9}, {3.806375866725065*^9, 
   3.80637594465375*^9}, {3.806378637074855*^9, 3.806378657364313*^9}, {
   3.806378797441449*^9, 3.806378807502866*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"3214cef3-b260-49f1-8a81-1f09bf82b900"],

Cell["\<\
Now we have the formula, we make some plots to compare the Finesse model to.\
\>", "Text",
 CellChangeTimes->{{3.812654970050468*^9, 
  3.812654989841116*^9}},ExpressionUUID->"e31d93cb-0d55-40e6-ace0-\
da1274d8f67a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.806375255357369*^9, {3.806376026563768*^9, 3.8063760848111467`*^9}, {
   3.8063763623354692`*^9, 3.8063763626935587`*^9}, {3.806376871192869*^9, 
   3.806376938723217*^9}, {3.806377471341908*^9, 3.806377471685624*^9}, {
   3.812654981868496*^9, 3.812654982249424*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"ae39354c-bd1f-4add-bb22-1cac54566556"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "threshold", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"rThresh", " ", "=", " ", 
    RowBox[{"ArgMax", "[", 
     RowBox[{
      RowBox[{"SHomI", "[", 
       RowBox[{"1", ",", "0", ",", 
        SuperscriptBox["0.9", 
         RowBox[{"1", "/", "2"}]], ",", 
        SuperscriptBox["0.1", 
         RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", "r", ",", "0", 
        ",", "0"}], "]"}], ",", "r"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"ArgMin", "[", 
    RowBox[{
     RowBox[{"SHomI", "[", 
      RowBox[{"1", ",", "0", ",", 
       SuperscriptBox["0.9", 
        RowBox[{"1", "/", "2"}]], ",", 
       SuperscriptBox["0.1", 
        RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", "r", ",", "0", ",",
        "0"}], "]"}], ",", "r"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8118118061397543`*^9, 3.811811813598988*^9}, {
  3.8118118591760406`*^9, 3.811811887622908*^9}, {3.811811997451922*^9, 
  3.811812000506147*^9}, {3.811812188692753*^9, 3.811812206195826*^9}, {
  3.811816312413888*^9, 3.811816315701519*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"33bca83c-f7af-4665-b875-5dde70dbe811"],

Cell[BoxData[
 RowBox[{"zeroReference", " ", "=", " ", 
  RowBox[{"SHomI", "[", 
   RowBox[{"1", ",", "0", ",", 
    SuperscriptBox["0.9", 
     RowBox[{"1", "/", "2"}]], ",", 
    SuperscriptBox["0.1", 
     RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", "0", ",", 
    "0", ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.812237688451689*^9, 3.812237693833028*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"ab79bd3e-b9f5-4e12-aac2-64b2944632a1"],

Cell[BoxData[
 RowBox[{"unityRange", " ", "=", " ", 
  RowBox[{"N", "[", 
   RowBox[{"Log", "[", 
    SuperscriptBox["10", 
     FractionBox["1", "10"]], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.812237816894322*^9, 3.812237845352437*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"eae8476d-62aa-4b67-b90a-73e6b1a92cd0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"LabelStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", "Red", ",", 
      RowBox[{"FontSize", "\[Rule]", "20"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"Plot", ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"FontSize", "\[Rule]", "16"}]}]}], "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8120503341905203`*^9, 3.8120503605581007`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"24285e97-6cf3-48d2-97e8-db58344385a0"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"PSD", " ", "vs", " ", "squeezer", " ", "parameter", " ", "r"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "L", " ", "value", " ", "not", " ", "important", " ", "given", " ", 
      "\[CapitalOmega]"}], " ", "=", " ", "0"}], "\[IndentingNewLine]", ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"StringForm", "[", 
      RowBox[{"\"\<threshold at r = ``\>\"", ",", 
       RowBox[{"NumberForm", "[", 
        RowBox[{"rThresh", ",", "3"}], "]"}]}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plot", " ", "=", " ", 
    RowBox[{"Labeled", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"SHomI", "[", 
           RowBox[{"1", ",", "0", ",", 
            SuperscriptBox["0.9", 
             RowBox[{"1", "/", "2"}]], ",", 
            SuperscriptBox["0.1", 
             RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
            "r", ",", "0", ",", "0"}], "]"}], "/", "zeroReference"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", 
          RowBox[{"-", "unityRange"}], ",", "unityRange"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "None", ",", "\"\<relative abs(PSD of homodyne intensity)\>\""}], 
          "}"}]}], ",", 
        RowBox[{"GridLines", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "rThresh", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "400"}], ",", " ", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"All", ",", "5"}], "}"}]}]}], "]"}], ",", 
      "\"\<squeezer parameter, r\>\""}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<not_main_PSD_vs_r.pdf\>\"", ",", "plot"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"https", ":"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{"gist", ".", "github", ".", "com"}], "/", "padde"}], "/", 
      "2953741"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sqzCavityData", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"plot", ",", 
         RowBox[{
          RowBox[{"Line", "[", "x__", "]"}], "\[Rule]", "x"}], ",", " ", 
         "Infinity"}], "]"}], ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<squeezed_cavity_analytics_homodyne_intensity_vs_sqz_param.csv\>\"", 
      ",", "sqzCavityData"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.8063752577291803`*^9, {3.8063769446460247`*^9, 3.806377201181114*^9}, {
   3.8063772727205544`*^9, 3.806377317398085*^9}, {3.806377474848839*^9, 
   3.806377542079898*^9}, {3.8063775978164387`*^9, 3.806377603553165*^9}, {
   3.8063776339697533`*^9, 3.806377634483274*^9}, {3.8063782457761583`*^9, 
   3.8063782580116997`*^9}, {3.806379761482675*^9, 3.806379765813789*^9}, {
   3.806380325416225*^9, 3.806380407017331*^9}, {3.8063804993468323`*^9, 
   3.806380710838578*^9}, {3.806380829189618*^9, 3.80638084823018*^9}, {
   3.8063811830892153`*^9, 3.8063811832292852`*^9}, 3.8063818423048697`*^9, {
   3.806383341507389*^9, 3.806383364620449*^9}, {3.811812221253193*^9, 
   3.811812221655208*^9}, {3.81181240950137*^9, 3.8118124127188168`*^9}, {
   3.812050316138547*^9, 3.8120503304304657`*^9}, {3.812050375063161*^9, 
   3.812050386255156*^9}, {3.812050834453583*^9, 3.8120508456129713`*^9}, {
   3.812237387822418*^9, 3.812237440901626*^9}, {3.812237518250348*^9, 
   3.8122375583682632`*^9}, {3.812237600065217*^9, 3.8122377091956472`*^9}, {
   3.812237849717722*^9, 3.8122378794005404`*^9}, {3.816309208668706*^9, 
   3.816309210567977*^9}, {3.8163093506907578`*^9, 3.816309365255445*^9}, {
   3.816309441080982*^9, 3.816309441432458*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"de8753ae-2adb-4c03-8ba6-a95d2ec0166b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"observe", " ", "if", " ", "limits", " ", "equal"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"SHomI", "[", 
     RowBox[{"1", ",", "0", ",", 
      SuperscriptBox["0.9", 
       RowBox[{"1", "/", "2"}]], ",", 
      SuperscriptBox["0.1", 
       RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", 
      RowBox[{"-", "1"}], ",", "0", ",", "0"}], "]"}], ",", 
    RowBox[{"SHomI", "[", 
     RowBox[{"1", ",", "0", ",", 
      SuperscriptBox["0.9", 
       RowBox[{"1", "/", "2"}]], ",", 
      SuperscriptBox["0.1", 
       RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", "1", ",", "0", ",", 
      "0"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8068822193986683`*^9, 3.80688224783069*^9}, {
  3.8068823543670053`*^9, 3.806882362149839*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"1f39fe68-cf08-466b-9d32-55c239f50d2d"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"PSD", " ", "vs", " ", "squeezer", " ", "parameter", " ", "r"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
    "zoomed", " ", "to", " ", "show", " ", "threshold", " ", "spike"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plot", " ", "=", " ", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"SHomI", "[", 
       RowBox[{"1", ",", "0", ",", 
        SuperscriptBox["0.9", 
         RowBox[{"1", "/", "2"}]], ",", 
        SuperscriptBox["0.1", 
         RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", "r", ",", "0", 
        ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "0", ",", "0.1"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<squeezer parameter, r\>\"", ",", 
         "\"\<PSD of homodyne intensity\>\""}], "}"}]}], ",", 
      RowBox[{"GridLines", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "rThresh", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "500"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"2", " ", 
          SuperscriptBox["10", "6"]}]}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<threshold (spike in PSD) at (approximately) r = ``\>\"", ",", 
         "rThresh"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{"\"\<not_main_PSD_vs_r_spike.pdf\>\"", ",", "plot"}], "]"}], 
     ";"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.806377329627956*^9, 3.8063773934858713`*^9}, {
  3.8063806965534678`*^9, 3.8063808148679943`*^9}, {3.8063811772475557`*^9, 
  3.806381179542403*^9}, {3.8063813014536467`*^9, 3.806381304568919*^9}, {
  3.811811629763093*^9, 3.811811637425508*^9}, {3.812682893553172*^9, 
  3.812682896133071*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"166c5ca7-33e2-4c50-ad19-4bf3b5289b63"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "PSD", " ", "vs", " ", "frequency", " ", "offset", " ", 
     "\[CapitalOmega]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "exponents", " ", "are", " ", "of", " ", "the", " ", "form", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"\[ImaginaryI]", " ", 
       FractionBox[
        RowBox[{"L", " ", "\[CapitalOmega]"}], "c"]}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NB", ":", " ", 
    RowBox[{
     RowBox[{"1", "/", "20"}], " ", "remains", " ", "the", " ", "factor", " ",
      "even", " ", "after", " ", "conversion", " ", "to", " ", "or", " ", 
     "from", " ", "dB", " ", "by", " ", "properties", " ", "of", " ", 
     "logarithms"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rplt1", ",", "rplt2", ",", "rplt3", ",", "rplt4"}], "}"}], " ",
      "=", " ", 
     RowBox[{"{", 
      RowBox[{"rThresh", ",", 
       RowBox[{"rThresh", "/", "20"}], ",", 
       RowBox[{
        RowBox[{"-", "rThresh"}], "/", "20"}], ",", 
       RowBox[{"-", "rThresh"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cavityLength", " ", "=", " ", "1"}], 
    RowBox[{"(*", "m", "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"plot", " ", "=", " ", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"SHomI", "[", 
             RowBox[{"1", ",", "\[CapitalOmega]", ",", 
              SuperscriptBox["0.9", 
               RowBox[{"1", "/", "2"}]], ",", 
              SuperscriptBox["0.1", 
               RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
              "rplt1", ",", "0", ",", "0"}], "]"}], "/", 
            RowBox[{"SHomI", "[", 
             RowBox[{"1", ",", "\[CapitalOmega]", ",", 
              SuperscriptBox["0.9", 
               RowBox[{"1", "/", "2"}]], ",", 
              SuperscriptBox["0.1", 
               RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
              "0", ",", "0", ",", "0"}], "]"}]}], "]"}], ",", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"SHomI", "[", 
             RowBox[{"1", ",", "\[CapitalOmega]", ",", 
              SuperscriptBox["0.9", 
               RowBox[{"1", "/", "2"}]], ",", 
              SuperscriptBox["0.1", 
               RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
              "rplt2", ",", "0", ",", "0"}], "]"}], "/", 
            RowBox[{"SHomI", "[", 
             RowBox[{"1", ",", "\[CapitalOmega]", ",", 
              SuperscriptBox["0.9", 
               RowBox[{"1", "/", "2"}]], ",", 
              SuperscriptBox["0.1", 
               RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
              "0", ",", "0", ",", "0"}], "]"}]}], "]"}], ",", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"SHomI", "[", 
             RowBox[{"1", ",", "\[CapitalOmega]", ",", 
              SuperscriptBox["0.9", 
               RowBox[{"1", "/", "2"}]], ",", 
              SuperscriptBox["0.1", 
               RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
              "0", ",", "0", ",", "0"}], "]"}], "/", 
            RowBox[{"SHomI", "[", 
             RowBox[{"1", ",", "\[CapitalOmega]", ",", 
              SuperscriptBox["0.9", 
               RowBox[{"1", "/", "2"}]], ",", 
              SuperscriptBox["0.1", 
               RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
              "0", ",", "0", ",", "0"}], "]"}]}], "]"}], ",", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"SHomI", "[", 
             RowBox[{"1", ",", "\[CapitalOmega]", ",", 
              SuperscriptBox["0.9", 
               RowBox[{"1", "/", "2"}]], ",", 
              SuperscriptBox["0.1", 
               RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
              "rplt3", ",", "0", ",", "0"}], "]"}], "/", 
            RowBox[{"SHomI", "[", 
             RowBox[{"1", ",", "\[CapitalOmega]", ",", 
              SuperscriptBox["0.9", 
               RowBox[{"1", "/", "2"}]], ",", 
              SuperscriptBox["0.1", 
               RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
              "0", ",", "0", ",", "0"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"SHomI", "[", 
             RowBox[{"1", ",", "\[CapitalOmega]", ",", 
              SuperscriptBox["0.9", 
               RowBox[{"1", "/", "2"}]], ",", 
              SuperscriptBox["0.1", 
               RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
              "rplt4", ",", "0", ",", "0"}], "]"}], "/", 
            RowBox[{"SHomI", "[", 
             RowBox[{"1", ",", "\[CapitalOmega]", ",", 
              SuperscriptBox["0.9", 
               RowBox[{"1", "/", "2"}]], ",", 
              SuperscriptBox["0.1", 
               RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
              "0", ",", "0", ",", "0"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]", ",", "0", ",", 
          RowBox[{"5", " ", 
           SuperscriptBox["10", "9"]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<r=``\>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"rplt1", ",", "3"}], "]"}]}], "]"}], ",", 
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<r=``\>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"rplt2", ",", "3"}], "]"}]}], "]"}], ",", "\"\<r=0\>\"",
            ",", 
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<r=``\>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"rplt3", ",", "3"}], "]"}]}], "]"}], ",", 
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<r=``\>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"rplt4", ",", "3"}], "]"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<angular frequency, \[CapitalOmega] / Hz\>\"", ",", 
        "\"\<Abs of relative PSD of\\nhomodyne intensity\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", " ", "Left"}], "}"}], ",", 
      RowBox[{"RotateLabel", "\[Rule]", "True"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"StringForm", "[", 
      RowBox[{"\"\<threshold at r = ``, cavity length L = `` m\>\"", ",", 
       RowBox[{"NumberForm", "[", 
        RowBox[{"rThresh", ",", "3"}], "]"}], ",", "cavityLength"}], "]"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<not_main_PSD_vs_freq.pdf\>\"", ",", "plot"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzV9I03EABPA1JAol11y6hYWWo5yJQdGSkJgsixo1t9qDaY2VuTCwbG0r
tVYRajMSRmxuWdHoj6SkLa25obbZcOmilBSXbjJRxDZGsiaVUL/7Phyfhzu4
TEWVpJxOo9HyqMDEF/bJ1NKwIEG7yQ8ZsrQAbI7/i8BHeZE4ZPa/p6dRTpWs
TYQdqzlJUGg8yIDXxMEU2JcxuAUWmH1c2DYwtwuG5m17oVk8ux8eOsU5Agsr
lMdgQLRHDJ9paCegvubASfLzZr0Cjkd/n4WmYnolbP86XQutmtd3oPLDQyu0
N6W3Q/H9xg54vMjbBXXGkW7Is+/rhf4SsxMW/Rhyk50ndQwmjLZmsCkdnpyt
cEi9fB4qbVI17BSl3IJeh6gBVlwS3oMsQx9xs4/3ALriLcTqlcoWyCyot5Ce
r5iAUzotUb7smoHiVXPE6rHktxzK2NOyfpjjU7hh0826j1DXs+iFjp++Yei8
YFw0UAb1r8Jw6bRtCY5ujxPzLbnOdWVhQVb4IlHyTt95+Rz1z2+1wcD3TJWK
cuWzm8iqcWmhyfj8Khye7K2DGwW/iLvH2yywdtsgkdnllVyh9LCTpERb/Q0Y
TTbchtqQXKqmfGL9IoMvY4WfFihVA3If/COUfYOsv64JuKZ8OgjZO4/OwIZm
7jzk0XsWIP86IwJLRzZEYaOJHt1RFRYc7n5MLPZrmLmUodkz6dCefZcLs2L5
2fA/UOp0bQ==
  "],
 CellLabel->"In[32]:=",ExpressionUUID->"ed2f248c-3756-498a-a711-24626c76117f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sqzCavityFreqData", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalOmega]", ",", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"SHomI", "[", 
          RowBox[{"1", ",", "\[CapitalOmega]", ",", 
           SuperscriptBox["0.9", 
            RowBox[{"1", "/", "2"}]], ",", 
           SuperscriptBox["0.1", 
            RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
           "rplt1", ",", "0", ",", "0"}], "]"}], "/", 
         RowBox[{"SHomI", "[", 
          RowBox[{"1", ",", "\[CapitalOmega]", ",", 
           SuperscriptBox["0.9", 
            RowBox[{"1", "/", "2"}]], ",", 
           SuperscriptBox["0.1", 
            RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", "0",
            ",", "0", ",", "0"}], "]"}]}], "]"}], ",", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"SHomI", "[", 
          RowBox[{"1", ",", "\[CapitalOmega]", ",", 
           SuperscriptBox["0.9", 
            RowBox[{"1", "/", "2"}]], ",", 
           SuperscriptBox["0.1", 
            RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
           "rplt2", ",", "0", ",", "0"}], "]"}], "/", 
         RowBox[{"SHomI", "[", 
          RowBox[{"1", ",", "\[CapitalOmega]", ",", 
           SuperscriptBox["0.9", 
            RowBox[{"1", "/", "2"}]], ",", 
           SuperscriptBox["0.1", 
            RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", "0",
            ",", "0", ",", "0"}], "]"}]}], "]"}], ",", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"SHomI", "[", 
          RowBox[{"1", ",", "\[CapitalOmega]", ",", 
           SuperscriptBox["0.9", 
            RowBox[{"1", "/", "2"}]], ",", 
           SuperscriptBox["0.1", 
            RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", "0",
            ",", "0", ",", "0"}], "]"}], "/", 
         RowBox[{"SHomI", "[", 
          RowBox[{"1", ",", "\[CapitalOmega]", ",", 
           SuperscriptBox["0.9", 
            RowBox[{"1", "/", "2"}]], ",", 
           SuperscriptBox["0.1", 
            RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", "0",
            ",", "0", ",", "0"}], "]"}]}], "]"}], ",", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"SHomI", "[", 
          RowBox[{"1", ",", "\[CapitalOmega]", ",", 
           SuperscriptBox["0.9", 
            RowBox[{"1", "/", "2"}]], ",", 
           SuperscriptBox["0.1", 
            RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
           "rplt3", ",", "0", ",", "0"}], "]"}], "/", 
         RowBox[{"SHomI", "[", 
          RowBox[{"1", ",", "\[CapitalOmega]", ",", 
           SuperscriptBox["0.9", 
            RowBox[{"1", "/", "2"}]], ",", 
           SuperscriptBox["0.1", 
            RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", "0",
            ",", "0", ",", "0"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"SHomI", "[", 
          RowBox[{"1", ",", "\[CapitalOmega]", ",", 
           SuperscriptBox["0.9", 
            RowBox[{"1", "/", "2"}]], ",", 
           SuperscriptBox["0.1", 
            RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
           "rplt4", ",", "0", ",", "0"}], "]"}], "/", 
         RowBox[{"SHomI", "[", 
          RowBox[{"1", ",", "\[CapitalOmega]", ",", 
           SuperscriptBox["0.9", 
            RowBox[{"1", "/", "2"}]], ",", 
           SuperscriptBox["0.1", 
            RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", "0",
            ",", "0", ",", "0"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[CapitalOmega]", ",", 
       SuperscriptBox["10", "7"], ",", 
       RowBox[{"5", " ", 
        SuperscriptBox["10", "9"]}], ",", 
       SuperscriptBox["10", "7"]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<squeezed_cavity_analytics_homodyne_intensity_vs_freq.csv\>\"", ",", 
    "sqzCavityFreqData"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.816384358214197*^9, 3.816384452143763*^9}, 
   3.816384522021028*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"82d7234b-914e-4365-b123-5f64181a4e0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "investigating", " ", "the", " ", "analytics", " ", "with", " ", 
    "squeezing", " ", "turned", " ", "off"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"SHomI", "[", 
      RowBox[{"1", ",", "\[CapitalOmega]", ",", 
       SuperscriptBox["0.9", 
        RowBox[{"1", "/", "2"}]], ",", 
       SuperscriptBox["0.1", 
        RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", "0", 
       ",", "0", ",", "0"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[CapitalOmega]", ",", 
      SuperscriptBox["10", "7"], ",", 
      RowBox[{"5", " ", 
       SuperscriptBox["10", "9"]}]}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.5", "-", 
        SuperscriptBox["10", 
         RowBox[{"-", "13"}]]}], ",", 
       RowBox[{"0.5", "+", 
        SuperscriptBox["10", 
         RowBox[{"-", "13"}]]}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.816388139958441*^9, 3.816388149371015*^9}, {
  3.816388372189062*^9, 3.816388400908605*^9}, {3.816388510145032*^9, 
  3.816388519877063*^9}, {3.816390770163966*^9, 3.816390794107956*^9}, {
  3.816390855919786*^9, 3.816390867901886*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"7e156740-9178-432c-be9e-546b2f0ce584"],

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{"SHomI", "[", 
   RowBox[{"1", ",", "\[CapitalOmega]", ",", 
    SuperscriptBox["0.9", 
     RowBox[{"1", "/", "2"}]], ",", 
    SuperscriptBox["0.1", 
     RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", "0", ",", 
    "0", ",", "0"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8163884690645323`*^9, 3.816388492916876*^9}, 
   3.816388534431218*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"e896be03-7a35-48dd-befe-77ac387bcbf5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"noSqzCavityFreqData", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalOmega]", ",", 
       RowBox[{"Abs", "[", 
        RowBox[{"SHomI", "[", 
         RowBox[{"1", ",", "\[CapitalOmega]", ",", 
          SuperscriptBox["0.9", 
           RowBox[{"1", "/", "2"}]], ",", 
          SuperscriptBox["0.1", 
           RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", "0", 
          ",", "0", ",", "0"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[CapitalOmega]", ",", 
       SuperscriptBox["10", "7"], ",", 
       RowBox[{"5", " ", 
        SuperscriptBox["10", "9"]}], ",", 
       SuperscriptBox["10", "7"]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<empty_cavity_analytics_homodyne_intensity_vs_freq.csv\>\"", ",", 
    "noSqzCavityFreqData"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.816388089222328*^9, 3.816388128844454*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"22d83244-2ff3-4a99-bf67-3d8e77f9e007"],

Cell[BoxData[
 RowBox[{"ArgMax", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"SHomI", "[", 
       RowBox[{"1", ",", "\[CapitalOmega]", ",", 
        SuperscriptBox["0.9", 
         RowBox[{"1", "/", "2"}]], ",", 
        SuperscriptBox["0.1", 
         RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
        "rplt1", ",", "0", ",", "0"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"0.5", " ", 
       SuperscriptBox["10", "9"]}], "<", "\[CapitalOmega]", "<", 
      RowBox[{"1.5", " ", 
       SuperscriptBox["10", "9"]}]}]}], "}"}], ",", "\[CapitalOmega]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.811820004447857*^9, 3.811820041051374*^9}, {
  3.811820082180189*^9, 3.811820083817409*^9}, {3.811820147950119*^9, 
  3.811820241054851*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"dff21c90-5ecd-40da-82a4-2ba589148ed4"],

Cell[BoxData[
 RowBox[{"ArgMin", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"SHomI", "[", 
       RowBox[{"1", ",", "\[CapitalOmega]", ",", 
        SuperscriptBox["0.9", 
         RowBox[{"1", "/", "2"}]], ",", 
        SuperscriptBox["0.1", 
         RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
        "rplt4", ",", "0", ",", "0"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"0.5", " ", 
       SuperscriptBox["10", "9"]}], "<", "\[CapitalOmega]", "<", 
      RowBox[{"1.5", " ", 
       SuperscriptBox["10", "9"]}]}]}], "}"}], ",", "\[CapitalOmega]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.812506581409718*^9, 3.8125065949962883`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"2303c239-ddb2-4e0a-8f33-c8cf1586c141"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"todo", " ", 
   RowBox[{"NB", ":", " ", 
    RowBox[{
     RowBox[{"figure", " ", "out", " ", "why", " ", "at", " ", "anti"}], "-", 
     
     RowBox[{
     "resonance", " ", "the", " ", "values", " ", "do", " ", "not", " ", 
      "attain", " ", "0.5", "\[IndentingNewLine]", 
      RowBox[{"hasn", "'"}], "t", " ", "this", " ", "been", " ", "fixed", " ",
       "by", " ", "the", " ", 
      RowBox[{"above", "?"}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.806633727547895*^9, 3.806633753745229*^9}, {
  3.807578142432323*^9, 3.807578150204835*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"ced4c42b-09cb-4e6d-86b7-21fb079e422c"],

Cell[BoxData[
 RowBox[{"  ", 
  RowBox[{"(*", 
   RowBox[{"relative", " ", "noise", " ", 
    FractionBox[
     RowBox[{"S", "[", 
      RowBox[{"r", "=", "rThresh"}], "]"}], 
     RowBox[{"S", "[", 
      RowBox[{"r", "=", "0"}], "]"}]], " ", "vs", " ", "frequency", " ", 
    "\[CapitalOmega]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plot", " ", "=", " ", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"SHomI", "[", 
           RowBox[{"1", ",", "\[CapitalOmega]", ",", 
            SuperscriptBox["0.9", 
             RowBox[{"1", "/", "2"}]], ",", 
            SuperscriptBox["0.1", 
             RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
            "rThresh", ",", 
            FractionBox["\[Pi]", "2"], ",", "0"}], "]"}], "/", 
          RowBox[{"SHomI", "[", 
           RowBox[{"1", ",", "\[CapitalOmega]", ",", 
            SuperscriptBox["0.9", 
             RowBox[{"1", "/", "2"}]], ",", 
            SuperscriptBox["0.1", 
             RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
            "0", ",", "0", ",", "0"}], "]"}]}], "]"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"SHomI", "[", 
           RowBox[{"1", ",", "\[CapitalOmega]", ",", 
            SuperscriptBox["0.9", 
             RowBox[{"1", "/", "2"}]], ",", 
            SuperscriptBox["0.1", 
             RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
            "rThresh", ",", "0", ",", "0"}], "]"}], "/", 
          RowBox[{"SHomI", "[", 
           RowBox[{"1", ",", "\[CapitalOmega]", ",", 
            SuperscriptBox["0.9", 
             RowBox[{"1", "/", "2"}]], ",", 
            SuperscriptBox["0.1", 
             RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
            "0", ",", "0", ",", "0"}], "]"}]}], "]"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"SHomI", "[", 
           RowBox[{"1", ",", "\[CapitalOmega]", ",", 
            SuperscriptBox["0.9", 
             RowBox[{"1", "/", "2"}]], ",", 
            SuperscriptBox["0.1", 
             RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
            RowBox[{"-", "rThresh"}], ",", "0", ",", "0"}], "]"}], "/", 
          RowBox[{"SHomI", "[", 
           RowBox[{"1", ",", "\[CapitalOmega]", ",", 
            SuperscriptBox["0.9", 
             RowBox[{"1", "/", "2"}]], ",", 
            SuperscriptBox["0.1", 
             RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", 
            "0", ",", "0", ",", "0"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[CapitalOmega]", ",", "0", ",", 
        RowBox[{"5", " ", 
         SuperscriptBox["10", "9"]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<angular frequency, \[CapitalOmega] / Hz\>\"", ",", 
         "\"\<Abs of relative noise in homodyne intensity\>\""}], "}"}]}], 
      ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<threshold at r = ``, cavity length L = `` m\>\"", ",", "rThresh",
          ",", "cavityLength"}], "]"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "2"}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<+\!\(\*SubscriptBox[\(r\), \(Thresh\)]\), \[Phi] = \
\!\(\*FractionBox[\(\[Pi]\), \(2\)]\)\>\"", ",", 
         "\"\<+\!\(\*SubscriptBox[\(r\), \(Thresh\)]\), \[Phi] = 0\>\"", ",", 
         "\"\<-\!\(\*SubscriptBox[\(r\), \(Thresh\)]\), \[Phi] = 0\>\""}], 
        "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Blue", ",", "Dashed"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{"\"\<not_main_relative_noise_vs_freq.pdf\>\"", ",", "plot"}], 
      "]"}], ";"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{
  3.806378376107194*^9, {3.806381583240574*^9, 3.806381712454879*^9}, {
   3.806381761137333*^9, 3.806381835219141*^9}, {3.806629727472595*^9, 
   3.8066297451372423`*^9}, {3.8066297764090776`*^9, 3.806629828501086*^9}, {
   3.80662986904792*^9, 3.806629971078545*^9}, {3.806630016945763*^9, 
   3.8066300432686787`*^9}, {3.806630085492319*^9, 3.806630162142193*^9}, {
   3.806630198510263*^9, 3.806630199776636*^9}, {3.806630229887113*^9, 
   3.806630230720895*^9}, {3.806630274769596*^9, 3.8066302853938217`*^9}, {
   3.806633379678844*^9, 3.806633382471661*^9}, {3.807237974246765*^9, 
   3.8072380123407803`*^9}, {3.807238097537736*^9, 3.80723811511458*^9}, {
   3.807238846452816*^9, 3.807238847419221*^9}, {3.812655929405755*^9, 
   3.8126559307674932`*^9}, {3.81268292444036*^9, 3.8126829268917313`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"b4e0a5aa-a2d1-4ea9-a3fb-6a3e1e6cdbd9"],

Cell["\<\
For the report, we also want a plot of the circulating power in an empty \
cavity.\
\>", "Text",
 CellChangeTimes->{{3.812655022608279*^9, 
  3.8126550388559093`*^9}},ExpressionUUID->"61d11c4d-845b-4b66-a54d-\
798e8cde0bdf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "relative", " ", "circulating", " ", "power", " ", "in", " ", 
    "overcoupled", " ", "cavity"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"circRelAmp", " ", "=", 
    RowBox[{
     RowBox[{"(", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "2", " ", "k", " ", "d"}], 
         "]"}], "\[ImaginaryI]", " ", "r2", " ", "t1"}], 
       RowBox[{"1", " ", "-", " ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "2", " ", "k", " ", "d"}], 
          "]"}], "r1", " ", "r2"}]}]], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k", " ", "d"}], " ", "\[Rule]", " ", 
       FractionBox[
        RowBox[{"\[CapitalOmega]", " ", "L", " "}], "c"]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"circRelAmpPlotter", "[", "\[CapitalOmega]_", "]"}], " ", ":=", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]}]], " ", "r2", " ", "t1"}], 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{
             "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
             "c"]}]], " ", "r1", " ", "r2"}]}]], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{"t1", "\[Rule]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["r1", "2"]}], ")"}], 
         RowBox[{"1", "/", "2"}]]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L", "\[Rule]", "1"}], ",", " ", 
       RowBox[{"r1", "\[Rule]", 
        SuperscriptBox["0.9", 
         RowBox[{"1", "/", "2"}]]}], ",", 
       RowBox[{"r2", "\[Rule]", "1"}], ",", " ", 
       RowBox[{"c", "\[Rule]", 
        RowBox[{"3", " ", 
         SuperscriptBox["10", "8"]}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"plot", " ", "=", " ", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          RowBox[{"circRelAmpPlotter", "[", "\[CapitalOmega]", "]"}], "]"}], 
         "2"], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]", ",", " ", "0", ",", " ", 
          RowBox[{"2.5", " ", 
           SuperscriptBox["10", "9"]}]}], "}"}], ",", " ", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
        RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<angular frequency, \[CapitalOmega] / Hz\>\"", ",", 
        "\"\<relative power of circulating field\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", " ", "Left"}], "}"}], ",", 
      RowBox[{"RotateLabel", "\[Rule]", "True"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<not_main_relative_circ_vs_freq.pdf\>\"", ",", "plot"}], 
     "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.807584289131544*^9, 3.807584289790142*^9}, {
   3.812486759872653*^9, 3.81248681365271*^9}, {3.812486844519082*^9, 
   3.812486867504752*^9}, {3.812486900900672*^9, 3.812487233382599*^9}, {
   3.812487263456245*^9, 3.812487354323683*^9}, {3.812487532314536*^9, 
   3.8124876039495153`*^9}, {3.812487656956622*^9, 3.8124876694553127`*^9}, {
   3.812488366575141*^9, 3.812488368317893*^9}, {3.812489170598131*^9, 
   3.8124891713016663`*^9}, {3.812489204146187*^9, 3.812489212814372*^9}, 
   3.81248952644004*^9},
 CellLabel->"In[45]:=",ExpressionUUID->"c3c04aa3-bc0b-44b4-93c8-b520cf69554e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "calculating", " ", "the", " ", "finesse", " ", "of", " ", "the", " ", 
    "cavity"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{"2", " ", "\[Pi]", 
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox["10", "8"]}], 
      RowBox[{"2", "  ", "1"}]]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{"circRelAmpPlotter", "[", "\[CapitalOmega]", "]"}], "]"}], 
      "2"], ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[CapitalOmega]", ",", " ", 
       RowBox[{"9", " ", 
        SuperscriptBox["10", "8"]}], ",", " ", 
       RowBox[{"1", " ", 
        SuperscriptBox["10", "9"]}]}], "}"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
   
   RowBox[{"FSR", " ", "=", " ", 
    FractionBox[
     RowBox[{"NArgMax", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           RowBox[{"circRelAmpPlotter", "[", "\[CapitalOmega]", "]"}], "]"}], 
          "2"], ",", " ", 
         RowBox[{
          RowBox[{"9", " ", 
           SuperscriptBox["10", "8"]}], "<", "\[CapitalOmega]", "<", 
          RowBox[{"1", " ", 
           SuperscriptBox["10", "9"]}]}]}], "}"}], ",", " ", 
       "\[CapitalOmega]"}], "]"}], 
     RowBox[{"2", " ", "\[Pi]"}]]}], "\[IndentingNewLine]", 
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     RowBox[{"circRelAmpPlotter", "[", 
      RowBox[{"9.346", " ", 
       SuperscriptBox["10", "8"]}], "]"}], "]"}], "2"], "\[IndentingNewLine]", 
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     RowBox[{"circRelAmpPlotter", "[", 
      RowBox[{"9.5035", " ", 
       SuperscriptBox["10", "8"]}], "]"}], "]"}], "2"], "\[IndentingNewLine]", 
   RowBox[{"FWHM", " ", "=", " ", 
    RowBox[{
     RowBox[{"9.5035", " ", 
      SuperscriptBox["10", "8"]}], " ", "-", " ", 
     RowBox[{"9.346", " ", 
      SuperscriptBox["10", "8"]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"finesse", " ", "=", " ", 
    FractionBox["FSR", "FWHM"]}]}]}]], "Input",
 CellChangeTimes->{{3.8124881303271847`*^9, 3.812488158966647*^9}, {
  3.812489176710105*^9, 3.8124891922447433`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"cf1ce9ea-fa8b-4399-b4a6-e435eb12d358"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"print", " ", "the", " ", "notebook", " ", "to", " ", 
     RowBox[{"a", " ", ".", "pdf"}]}], ",", " ", 
    RowBox[{
    "the", " ", "notebook", " ", "needs", " ", "to", " ", "be", " ", "saved", 
     " ", "for", " ", "this", " ", "to", " ", "function"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"NotebookPrint", "[", 
   RowBox[{
    RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<not_main_notebook.pdf\>\""}]}], "]"}]}]], "Input",
 CellFrame->{{0, 0}, {0, 2}},
 CellChangeTimes->{
  3.805523565520809*^9, {3.805523735147209*^9, 3.805523744064376*^9}, {
   3.806374661008909*^9, 3.806374664999815*^9}, {3.806374799160515*^9, 
   3.8063748196954403`*^9}, {3.806375070810156*^9, 3.8063750793081217`*^9}, {
   3.80637512994281*^9, 3.80637513092626*^9}, {3.806375166291004*^9, 
   3.806375166343843*^9}, {3.8063752179427834`*^9, 3.806375218873817*^9}, {
   3.806381980006678*^9, 3.806381981787475*^9}, {3.8126550467151003`*^9, 
   3.81265505415224*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"74ba13db-35a6-44fd-9c49-6139bae4e1d7"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.8163875965722*^9},
 CellLabel->"In[57]:=",ExpressionUUID->"fd3ba0db-d54a-4252-8062-c38d284bb0a1"]
},
WindowSize->{890, 590},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 589, 13, 220, "Text",ExpressionUUID->"39c62208-fd8d-4f47-b3ae-f8e054b8e8fb"],
Cell[1150, 35, 389, 9, 153, "Text",ExpressionUUID->"a7a48fbc-bd42-463c-98e0-5837de31a7ed"],
Cell[1542, 46, 5147, 156, 841, "Input",ExpressionUUID->"60b81c7e-a887-44a9-b376-43b41f52008d"],
Cell[6692, 204, 4480, 111, 555, "Input",ExpressionUUID->"119ecdc3-6fa1-4c2a-afc0-afebfd72aaf8"],
Cell[11175, 317, 1181, 28, 112, "Input",ExpressionUUID->"2c2c02e4-da7e-4d1a-afcc-29cc0ae90914"],
Cell[12359, 347, 236, 6, 51, "Text",ExpressionUUID->"8fd3e874-42df-42c3-83af-95f9bd8625f6"],
Cell[12598, 355, 26669, 783, 2352, "Text",ExpressionUUID->"400161cc-835d-4015-8163-4d30c1a0797b"],
Cell[39270, 1140, 939, 21, 110, "Input",ExpressionUUID->"538a57be-ccd9-4342-af09-0d8258f20fce"],
Cell[40212, 1163, 3908, 119, 226, "Input",ExpressionUUID->"a577ebcd-04f6-49b8-b579-2c11c0442b23"],
Cell[44123, 1284, 2650, 71, 273, "Input",ExpressionUUID->"c6ef84fd-f5e0-4a24-aceb-de1d43bea371"],
Cell[46776, 1357, 8134, 223, 582, "Input",ExpressionUUID->"eb69f030-4f96-4769-94b8-3d3310292795"],
Cell[54913, 1582, 1926, 56, 194, "Text",ExpressionUUID->"05608f11-2300-4b1d-af40-e150792d2ac5"],
Cell[56842, 1640, 204, 3, 52, "Text",ExpressionUUID->"12931b0c-38cc-4731-8972-b4b85a689d53"],
Cell[57049, 1645, 15873, 425, 1652, "Text",ExpressionUUID->"8d1e2bf2-1502-48c5-bdca-c43e07e3d292"],
Cell[72925, 2072, 1086, 29, 193, "Input",ExpressionUUID->"1edb6a28-5f6c-4bfd-9e3f-76799b750267"],
Cell[74014, 2103, 2003, 45, 166, "Input",ExpressionUUID->"3214cef3-b260-49f1-8a81-1f09bf82b900"],
Cell[76020, 2150, 226, 5, 86, "Text",ExpressionUUID->"e31d93cb-0d55-40e6-ace0-da1274d8f67a"],
Cell[76249, 2157, 495, 9, 45, "Input",ExpressionUUID->"ae39354c-bd1f-4add-bb22-1cac54566556"],
Cell[76747, 2168, 1170, 27, 119, "Input",ExpressionUUID->"33bca83c-f7af-4665-b875-5dde70dbe811"],
Cell[77920, 2197, 466, 10, 87, "Input",ExpressionUUID->"ab79bd3e-b9f5-4e12-aac2-64b2944632a1"],
Cell[78389, 2209, 324, 7, 66, "Input",ExpressionUUID->"eae8476d-62aa-4b67-b90a-73e6b1a92cd0"],
Cell[78716, 2218, 619, 15, 78, "Input",ExpressionUUID->"24285e97-6cf3-48d2-97e8-db58344385a0"],
Cell[79338, 2235, 4202, 95, 640, "Input",ExpressionUUID->"de8753ae-2adb-4c03-8ba6-a95d2ec0166b"],
Cell[83543, 2332, 920, 23, 119, "Input",ExpressionUUID->"1f39fe68-cf08-466b-9d32-55c239f50d2d"],
Cell[84466, 2357, 2141, 53, 410, "Input",ExpressionUUID->"166c5ca7-33e2-4c50-ad19-4bf3b5289b63"],
Cell[86610, 2412, 8051, 183, 1125, "Input",ExpressionUUID->"ed2f248c-3756-498a-a711-24626c76117f"],
Cell[94664, 2597, 4327, 102, 622, "Input",ExpressionUUID->"82d7234b-914e-4365-b123-5f64181a4e0c"],
Cell[98994, 2701, 1362, 34, 119, "Input",ExpressionUUID->"7e156740-9178-432c-be9e-546b2f0ce584"],
Cell[100359, 2737, 493, 11, 50, "Input",ExpressionUUID->"e896be03-7a35-48dd-befe-77ac387bcbf5"],
Cell[100855, 2750, 1106, 28, 252, "Input",ExpressionUUID->"22d83244-2ff3-4a99-bf67-3d8e77f9e007"],
Cell[101964, 2780, 888, 22, 124, "Input",ExpressionUUID->"dff21c90-5ecd-40da-82a4-2ba589148ed4"],
Cell[102855, 2804, 792, 20, 124, "Input",ExpressionUUID->"2303c239-ddb2-4e0a-8f33-c8cf1586c141"],
Cell[103650, 2826, 679, 15, 142, "Input",ExpressionUUID->"ced4c42b-09cb-4e6d-86b7-21fb079e422c"],
Cell[104332, 2843, 5083, 113, 824, "Input",ExpressionUUID->"b4e0a5aa-a2d1-4ea9-a3fb-6a3e1e6cdbd9"],
Cell[109418, 2958, 234, 6, 52, "Text",ExpressionUUID->"61d11c4d-845b-4b66-a54d-798e8cde0bdf"],
Cell[109655, 2966, 3948, 102, 547, "Input",ExpressionUUID->"c3c04aa3-bc0b-44b4-93c8-b520cf69554e"],
Cell[113606, 3070, 2364, 64, 484, "Input",ExpressionUUID->"cf1ce9ea-fa8b-4399-b4a6-e435eb12d358"],
Cell[115973, 3136, 1179, 25, 157, "Input",ExpressionUUID->"74ba13db-35a6-44fd-9c49-6139bae4e1d7"],
Cell[117155, 3163, 164, 2, 78, "Input",ExpressionUUID->"fd3ba0db-d54a-4252-8062-c38d284bb0a1"]
}
]
*)

