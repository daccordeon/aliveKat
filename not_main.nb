(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    150022,       4166]
NotebookOptionsPosition[    147475,       4125]
NotebookOutlinePosition[    147808,       4140]
CellTagsIndexPosition[    147765,       4137]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Id", " ", "=", " ", 
    RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "switching", " ", "mirror", " ", "convention", " ", "to", " ", "nothing", 
     " ", "on", " ", "transmission", " ", "and", " ", "a", " ", "sign", " ", 
     "change", " ", "on", " ", "one", " ", "face", " ", "of", " ", "a", " ", 
     "mirror", " ", "and", " ", "nothing", " ", "on", " ", "the", " ", 
     "other"}], ",", " ", 
    RowBox[{
     RowBox[{
     "let", " ", "the", " ", "reflection", " ", "matrix", " ", "off", " ", 
      "the", " ", "side", " ", "which", " ", "recieves", " ", "a"}], " ", "-", 
     RowBox[{
     "1", " ", "sign", " ", "change", " ", "be", " ", "called", " ", 
      "aR"}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "R1", ",", " ", "aR1", ",", " ", "T1", ",", " ", "R2", ",", "aR2", ",", 
      "T2", ",", " ", "RBS", ",", " ", "aRBS", ",", " ", "TBS"}], "}"}], " ", 
    "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r1", " ", "Id"}], ",", " ", 
      RowBox[{
       RowBox[{"-", "r1"}], " ", "Id"}], ",", " ", 
      RowBox[{"t1", " ", "Id"}], ",", " ", "Id", ",", 
      RowBox[{"-", "Id"}], ",", 
      RowBox[{"0", " ", "Id"}], ",", " ", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "2"}]]], "Id"}], ",", " ", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", 
         SuperscriptBox["2", 
          RowBox[{"1", "/", "2"}]]]}], "Id"}], ",", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "2"}]]], "Id"}]}], " ", "}"}]}], ";"}], "\n", 
  RowBox[{"(*", "rotation", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", "\[Phi]_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", "\[Phi]", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]},
      {
       RowBox[{"Sin", "[", "\[Phi]", "]"}], 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}
     }], ")"}]}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "propagation", " ", "across", " ", "a", " ", "space", " ", "of", " ", 
     "length", " ", "D"}], " ", "=", " ", 
    RowBox[{"L", " ", "+", " ", "\[Delta]l"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SpacePropa", "[", 
    RowBox[{"L_", ",", "\[Delta]l_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"\[ImaginaryI]", " ", 
      FractionBox["\[CapitalOmega]", "c"], 
      RowBox[{"(", 
       RowBox[{"L", "+", "\[Delta]l"}], ")"}]}], "]"}], 
    RowBox[{"P", "[", 
     FractionBox[
      RowBox[{
       SubscriptBox["\[Omega]", "0"], " ", "\[Delta]l"}], "c"], "]"}]}]}], 
  "\n", 
  RowBox[{"(*", "squeezer", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSqz", "[", 
    RowBox[{"r_", ",", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Phi]"}], "]"}], 
         RowBox[{"Sinh", "[", "r", "]"}]}], "+", 
        RowBox[{"Cosh", "[", "r", "]"}]}], 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}], 
        RowBox[{"Sinh", "[", "r", "]"}]}]},
      {
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}], 
        RowBox[{"Sinh", "[", "r", "]"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Phi]"}], "]"}]}], 
         RowBox[{"Sinh", "[", "r", "]"}]}], "+", 
        RowBox[{"Cosh", "[", "r", "]"}]}]}
     }], ")"}]}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "input", " ", "field", " ", "quadratures", " ", "in", " ", "frequency", 
     " ", "domain"}], ",", " ", 
    RowBox[{
     RowBox[{"caret", "/", "hat"}], " ", 
     RowBox[{"(", "^", ")"}], " ", "means", " ", "frequency", " ", 
     "dependant"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nvec", ",", " ", "avec", ",", " ", "Avec"}], "}"}], " ", "=", 
   " ", 
   RowBox[{"{", 
    RowBox[{GridBox[{
       {
        SubscriptBox[
         OverscriptBox["n", "^"], "1"]},
       {
        SubscriptBox[
         OverscriptBox["n", "^"], "2"]}
      }], ",", GridBox[{
       {
        SubscriptBox[
         OverscriptBox["a", "^"], "1"]},
       {
        SubscriptBox[
         OverscriptBox["a", "^"], "2"]}
      }], ",", GridBox[{
       {
        RowBox[{"A", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "0"], "]"}]}]},
       {
        RowBox[{"A", " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "0"], "]"}]}]}
      }]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.805518009488543*^9, 3.805518036923307*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"60b81c7e-a887-44a9-b376-43b41f52008d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "squeezing", " ", "midway", " ", "through", " ", "the", " ", "cavity"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cavP", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"SpacePropa", "[", 
        RowBox[{
         FractionBox["L", "2"], ",", 
         FractionBox["\[Delta]l", "2"]}], "]"}], ".", 
       RowBox[{"SSqz", "[", 
        RowBox[{"r", ",", "\[Phi]"}], "]"}], ".", 
       RowBox[{"SpacePropa", "[", 
        RowBox[{
         FractionBox["L", "2"], ",", 
         FractionBox["\[Delta]l", "2"]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"NB", ":", " ", 
      RowBox[{
       RowBox[{"should", " ", "alter", " ", "the", " ", "set"}], "-", 
       RowBox[{"up", " ", 
        RowBox[{"s", ".", "t", ".", " ", "the"}], " ", "beam", " ", "is", " ",
         "only", " ", "squeezed", " ", "from", " ", "one", " ", 
        "direction"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "from"}], " ", "M1", " ", "to", " ", 
      "M2", " ", "but", " ", "not", " ", "back", " ", "from", " ", "M2", " ", 
      "to", " ", 
      RowBox[{"M1", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "calculating", " ", "the", " ", "cavity", " ", "reflection", " ", 
      "matrix", " ", "by", " ", "borrowing", " ", "the", " ", "empty", " ", 
      "cavity", " ", "solution", " ", "and", " ", "substituting", " ", "in", 
      " ", "the", " ", "above", " ", "propagation", " ", "matrix", 
      "\[IndentingNewLine]", 
      SubscriptBox["a", "5"]}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["R", "1"], "+", 
        RowBox[{
         SubscriptBox["T", "1"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Id", "-", 
            RowBox[{"P", " ", 
             SubscriptBox["R", "2"], " ", "P", " ", 
             SubscriptBox["R", "1"]}]}], ")"}], 
          RowBox[{"-", "1"}]], "P", " ", 
         SubscriptBox["R", "2"], " ", "P", " ", 
         SubscriptBox["T", "1"]}]}], ")"}], 
      SubscriptBox["a", "0"], "\[IndentingNewLine]", "simplifying", " ", 
      "result", " ", "using", " ", "that", " ", 
      FractionBox[
       RowBox[{"\[Delta]l", " ", "\[CapitalOmega]"}], "c"], " ", 
      RowBox[{"<<", " ", "1"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cavMatrix", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"aR1", "+", 
         RowBox[{"T1", ".", 
          RowBox[{"Inverse", "[", 
           RowBox[{"Id", " ", "-", " ", 
            RowBox[{"cavP", ".", "R2", ".", "cavP", ".", "R1"}]}], "]"}], ".",
           "cavP", ".", "R2", ".", "cavP", ".", "T1"}]}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"\[Delta]l", " ", 
            SubscriptBox["\[Omega]", "0"]}], "c"], "\[Rule]", " ", "\[Psi]"}],
          ",", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"L", "+", "\[Delta]l"}], ")"}], " ", "\[CapitalOmega]"}],
            "c"], "->", 
          FractionBox[
           RowBox[{" ", 
            RowBox[{"L", " ", "\[CapitalOmega]"}]}], "c"]}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "field", " ", "reflected", " ", "off", " ", "the", " ", 
     "cavity"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"areflvec", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"cavMatrix", ".", "nvec"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.805060349494413*^9, 3.8050604603106318`*^9}, {
   3.80506057597893*^9, 3.805060626419115*^9}, 3.8050608741998*^9, {
   3.8050609680671453`*^9, 3.805060968605934*^9}, 3.8054227568794937`*^9, {
   3.8054228642531557`*^9, 3.805422873497765*^9}, {3.805422941389436*^9, 
   3.8054229428453293`*^9}, {3.8054229997411547`*^9, 3.805423014434753*^9}, {
   3.805513382945775*^9, 3.805513431950033*^9}, {3.805516314433888*^9, 
   3.805516345236754*^9}, {3.8055180513308067`*^9, 3.805518058377935*^9}, 
   3.8055180908796587`*^9, 3.805518153350175*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"119ecdc3-6fa1-4c2a-afc0-afebfd72aaf8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "frequency", " ", "domain", " ", "quadratures", " ", "at", " ", "the", " ",
     "photodiodes"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"aPD1vec", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"TBS", ".", 
        RowBox[{"(", 
         RowBox[{"Avec", "+", "avec"}], ")"}]}], "+", 
       RowBox[{"RBS", ".", "areflvec"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"aPD2vec", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"aRBS", ".", 
        RowBox[{"(", 
         RowBox[{"Avec", "+", "avec"}], ")"}]}], "+", 
       RowBox[{"TBS", ".", "areflvec"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.805059943525661*^9, 3.805060036266486*^9}, {
  3.80506008958035*^9, 3.805060106855197*^9}, {3.805060673065486*^9, 
  3.8050606846041193`*^9}, {3.8050608553255873`*^9, 3.8050608564043827`*^9}, {
  3.805422772773703*^9, 3.8054227731621943`*^9}, {3.805513316960659*^9, 
  3.805513319004156*^9}, {3.8055158957113657`*^9, 3.80551592020496*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"2c2c02e4-da7e-4d1a-afcc-29cc0ae90914"],

Cell[TextData[Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "homodyne", " ", "readout", " ", "takes", " ", "the", " ", "difference", 
      " ", "between", " ", "the", " ", "two", " ", "photo"}], "-", 
     "currents"}], ",", 
    RowBox[{
    "each", " ", "of", " ", "which", " ", "is", " ", "proportional", " ", 
     "to", " ", "the", " ", "time", " ", "average", " ", "of", " ", "the", 
     " ", "intensity", " ", "of", " ", "the", " ", "field"}], ",", 
    RowBox[{
    "due", " ", "to", " ", "the", " ", "slow", " ", "response", " ", "of", 
     " ", "the", " ", 
     RowBox[{"PD", "'"}], "s"}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    SubscriptBox["i", "hom"], "=", 
    RowBox[{
     SubscriptBox["i", "1"], "-", 
     SubscriptBox["i", "2"]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"let", " ", 
      RowBox[{"tilde", "/", "squiggle"}], " ", 
      RowBox[{"(", "~", ")"}], " ", "mean", " ", "time"}], "-", "domain"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["i", "1"], "\[Proportional]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       OverscriptBox["I", "~"], "[", "t", "]"}], "\[RightAngleBracket]"}]}], 
    "=", 
    RowBox[{"\[LeftAngleBracket]", 
     SuperscriptBox[
      RowBox[{"\[LeftBracketingBar]", 
       RowBox[{
        SubscriptBox[
         OverscriptBox[
          OverscriptBox["E", "~"], "^"], "PD1"], "[", "t", "]"}], 
       "\[RightBracketingBar]"}], "2"], "\[RightAngleBracket]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox[
       OverscriptBox["E", "~"], "^"], "PD1"], "[", "t", "]"}], " ", "=", 
    RowBox[{
     SubscriptBox["C", "0"], 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           StyleBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "~"],
            FontVariations->{"Underline"->False}], "^"], 
          StyleBox[
           RowBox[{"PD1", ",", "c"}],
           FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           StyleBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "~"],
            FontVariations->{"Underline"->False}], "^"], 
          StyleBox[
           RowBox[{"PD1", ",", "s"}],
           FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox[
       StyleBox[
        OverscriptBox[
         StyleBox["a",
          FontVariations->{"Underline"->False}], "~"],
        FontVariations->{"Underline"->False}], "^"], 
      StyleBox[
       RowBox[{"PD1", ",", "c"}],
       FontVariations->{"Underline"->False}]], "[", "t", "]"}], " ", "=", " ", 
    RowBox[{"InverseFourierTransform", "[", 
     RowBox[{
      RowBox[{
       StyleBox[
        SubscriptBox[
         OverscriptBox[
          StyleBox["a",
           FontVariations->{"Underline"->False}], "^"], 
         StyleBox[
          RowBox[{"PD1", ",", "c"}],
          FontVariations->{"Underline"->False}]],
        FontVariations->{"Underline"->True}], 
       StyleBox["[",
        FontVariations->{"Underline"->True}], 
       StyleBox["\[CapitalOmega]",
        FontVariations->{"Underline"->False}], 
       StyleBox["]",
        FontVariations->{"Underline"->True}]}], ",", "\[CapitalOmega]", ",", 
      "t"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"time", "-", 
     RowBox[{
     "domain", " ", "intensity", " ", "of", " ", "the", " ", "light", " ", 
      "at", " ", "photo"}], "-", 
     RowBox[{"diode", " ", "1"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["C", "0"], "2"], 
     RowBox[{"\[LeftAngleBracket]", 
      SuperscriptBox[
       RowBox[{"\[LeftBracketingBar]", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             StyleBox[
              OverscriptBox[
               StyleBox["a",
                FontVariations->{"Underline"->False}], "~"],
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD1", ",", "c"}],
             FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             StyleBox[
              OverscriptBox[
               StyleBox["a",
                FontVariations->{"Underline"->False}], "~"],
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD1", ",", "s"}],
             FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], 
        "\[RightBracketingBar]"}], "2"], "\[RightAngleBracket]"}]}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "assume", " ", "time", " ", "domain", " ", "quadratures", " ", "are", " ",
      "Hermitian"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["C", "0"], "2"], 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{
          SubscriptBox[
           OverscriptBox[
            StyleBox[
             OverscriptBox[
              StyleBox["a",
               FontVariations->{"Underline"->False}], "~"],
             FontVariations->{"Underline"->False}], "^"], 
           StyleBox[
            RowBox[{"PD1", ",", "c"}],
            FontVariations->{"Underline"->False}]], "[", "t", "]"}], "2"], 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Omega]", "0"], "t"}], "]"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{
          SubscriptBox[
           OverscriptBox[
            StyleBox[
             OverscriptBox[
              StyleBox["a",
               FontVariations->{"Underline"->False}], "~"],
             FontVariations->{"Underline"->False}], "^"], 
           StyleBox[
            RowBox[{"PD1", ",", "s"}],
            FontVariations->{"Underline"->False}]], "[", "t", "]"}], "2"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Omega]", "0"], "t"}], "]"}], 
         RowBox[{"2", " "}]]}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              StyleBox[
               OverscriptBox[
                StyleBox["a",
                 FontVariations->{"Underline"->False}], "~"],
               FontVariations->{"Underline"->False}], "^"], 
             StyleBox[
              RowBox[{"PD1", ",", "c"}],
              FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              StyleBox[
               OverscriptBox[
                StyleBox["a",
                 FontVariations->{"Underline"->False}], "~"],
               FontVariations->{"Underline"->False}], "^"], 
             StyleBox[
              RowBox[{"PD1", ",", "s"}],
              FontVariations->{"Underline"->False}]], "[", "t", "]"}]}], "+", 
          
          RowBox[{
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              StyleBox[
               OverscriptBox[
                StyleBox["a",
                 FontVariations->{"Underline"->False}], "~"],
               FontVariations->{"Underline"->False}], "^"], 
             StyleBox[
              RowBox[{"PD1", ",", "s"}],
              FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              StyleBox[
               OverscriptBox[
                StyleBox["a",
                 FontVariations->{"Underline"->False}], "~"],
               FontVariations->{"Underline"->False}], "^"], 
             StyleBox[
              RowBox[{"PD1", ",", "c"}],
              FontVariations->{"Underline"->False}]], "[", "t", "]"}]}]}], 
         ")"}], 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], 
      "\[RightAngleBracket]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"time", " ", "average", " ", "of", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Omega]", "0"], "t"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Omega]", "0"], "t"}], "]"}], " ", "is", " ", "zero"}],
      ",", " ", 
     RowBox[{"time", " ", "average", " ", "of", " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Omega]", "0"], "t"}], "]"}], "2"], " ", "or", " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["\[Omega]", "0"], "t"}], "]"}], "2"], " ", "is", " ", 
      RowBox[{
       FractionBox["1", "2"], ".", "\[IndentingNewLine]", "then"}], " ", 
      "assume", " ", "quadratures", " ", "change", " ", "slowly", " ", "wrt", 
      " ", 
      SubscriptBox["\[Omega]", "0"]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       SubscriptBox["C", "0"], "2"], "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           StyleBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "~"],
            FontVariations->{"Underline"->False}], "^"], 
          StyleBox[
           RowBox[{"PD1", ",", "c"}],
           FontVariations->{"Underline"->False}]], "[", "t", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           StyleBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "~"],
            FontVariations->{"Underline"->False}], "^"], 
          StyleBox[
           RowBox[{"PD1", ",", "s"}],
           FontVariations->{"Underline"->False}]], "[", "t", "]"}], "2"]}], 
      ")"}]}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "spliting", " ", "time", " ", "signals", " ", "into", " ", "average", " ",
      "and", " ", "time", " ", "varying", " ", "parts"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox[
       StyleBox[
        OverscriptBox[
         StyleBox["a",
          FontVariations->{"Underline"->False}], "~"],
        FontVariations->{"Underline"->False}], "^"], 
      StyleBox[
       RowBox[{"PD1", ",", "c"}],
       FontVariations->{"Underline"->False}]], "[", "t", "]"}], " ", "=", " ", 
    RowBox[{
     SubscriptBox["B", 
      RowBox[{"1", ",", "c"}]], "+", 
     RowBox[{
      SubscriptBox[
       OverscriptBox[
        OverscriptBox["b", "~"], "^"], 
       RowBox[{"1", ",", "c"}]], "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox[
       StyleBox[
        OverscriptBox[
         StyleBox["a",
          FontVariations->{"Underline"->False}], "~"],
        FontVariations->{"Underline"->False}], "^"], 
      StyleBox[
       RowBox[{"PD1", ",", "s"}],
       FontVariations->{"Underline"->False}]], "[", "t", "]"}], " ", "=", " ", 
    RowBox[{
     SubscriptBox["B", 
      RowBox[{"1", ",", "s"}]], "+", 
     RowBox[{
      SubscriptBox[
       OverscriptBox[
        OverscriptBox["b", "~"], "^"], 
       RowBox[{"1", ",", "s"}]], "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       SubscriptBox["C", "0"], "2"], "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["B", 
           RowBox[{"1", ",", "c"}]], "+", 
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             OverscriptBox["b", "~"], "^"], 
            RowBox[{"1", ",", "c"}]], "[", "t", "]"}]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["B", 
           RowBox[{"1", ",", "s"}]], "+", 
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             OverscriptBox["b", "~"], "^"], 
            RowBox[{"1", ",", "s"}]], "[", "t", "]"}]}], ")"}], "2"]}], 
      ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       SubscriptBox["C", "0"], "2"], "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["B", 
         RowBox[{"1", ",", "c"}]], "2"], "+", 
       SuperscriptBox[
        SubscriptBox["B", 
         RowBox[{"1", ",", "s"}]], "2"], "+", 
       SuperscriptBox[
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           OverscriptBox["b", "~"], "^"], 
          RowBox[{"1", ",", "s"}]], "[", "t", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           OverscriptBox["b", "~"], "^"], 
          RowBox[{"1", ",", "c"}]], "[", "t", "]"}], "2"], "+", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "c"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              OverscriptBox["b", "~"], "^"], 
             RowBox[{"1", ",", "c"}]], "[", "t", "]"}]}], "+", 
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "s"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              OverscriptBox["b", "~"], "^"], 
             RowBox[{"1", ",", "s"}]], "[", "t", "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "assume", " ", "time", " ", "varying", " ", "part", " ", "is", " ", 
     "small", " ", "wrt", " ", "average", " ", 
     RowBox[{"s", ".", "t", ".", " ", "time"}], " ", "varying", " ", "part", 
     " ", "squared", " ", "is", " ", "vanishingly", " ", "small", 
     "\[IndentingNewLine]", "this", " ", "is", " ", "true", " ", "for", " ", 
     "comparing", " ", "quantum", " ", "noise", " ", "to", " ", "the", " ", 
     "local", " ", "oscillator"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       SubscriptBox["C", "0"], "2"], "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["B", 
         RowBox[{"1", ",", "c"}]], "2"], "+", 
       SuperscriptBox[
        SubscriptBox["B", 
         RowBox[{"1", ",", "s"}]], "2"], "+", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "c"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              OverscriptBox["b", "~"], "^"], 
             RowBox[{"1", ",", "c"}]], "[", "t", "]"}]}], "+", 
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "s"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              OverscriptBox["b", "~"], "^"], 
             RowBox[{"1", ",", "s"}]], "[", "t", "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"apply", " ", "Fourier", " ", "transform"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["I", "PD1"], "[", "\[CapitalOmega]", "]"}], " ", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       SubscriptBox["C", "0"], "2"], "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["B", 
            RowBox[{"1", ",", "c"}]], "2"], "+", 
          SuperscriptBox[
           SubscriptBox["B", 
            RowBox[{"1", ",", "s"}]], "2"]}], ")"}], 
        RowBox[{"\[Delta]", "[", 
         RowBox[{"\[CapitalOmega]", "-", "0"}], "]"}]}], "+", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "c"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox["b", "^"], 
             RowBox[{"1", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]}], "+", 
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "s"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox["b", "^"], 
             RowBox[{"1", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}]}], 
         ")"}]}]}], ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "but", " ", "we", " ", "are", " ", "only", " ", "interested", " ", "in", 
      " ", "the", " ", "quantum", " ", "noise"}], ",", " ", 
     RowBox[{"not", " ", "the", " ", "DC", " ", "part"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["I", "PD1"], "[", "\[CapitalOmega]", "]"}], " ", "=", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["C", "0"], "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"1", ",", "c"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"1", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]}], "+", 
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"1", ",", "s"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"1", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}]}], 
      ")"}]}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "homodyne", " ", "readout", " ", "is", " ", "proportional", " ", "to", 
      " ", "the", " ", "difference", " ", "in", " ", "intensities"}], ",", 
     " ", 
     RowBox[{
     "since", " ", "the", " ", "Fourier", " ", "transform", " ", "is", " ", 
      "linear", " ", "we", " ", "can", " ", "look", " ", "at", " ", "the", 
      " ", "difference", " ", "in", " ", "the", " ", "spectra"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["I", "hom"], "[", "\[CapitalOmega]", "]"}], "=", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{
       SubscriptBox["I", "PD1"], "[", "\[CapitalOmega]", "]"}], "-", 
      RowBox[{
       SubscriptBox["I", "PD2"], "[", "\[CapitalOmega]", "]"}]}], 
     "\[RightAngleBracket]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["I", "hom"], "[", "\[CapitalOmega]", "]"}], "=", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["C", "0"], "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"1", ",", "c"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"1", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]}], "+", 
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"1", ",", "s"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"1", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}], "-", 
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"2", ",", "c"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"2", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]}], "-", 
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"2", ",", "s"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"2", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}]}], 
      ")"}]}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "identify", " ", "these", " ", "components", " ", "as", " ", "the", " ", 
     "constant", " ", "and", " ", "frequency", " ", "dependant", " ", "parts",
      " ", "of", " ", "the", " ", "original", " ", "quadratures"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"aPD1vec", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          StyleBox[
           SubscriptBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD1", ",", "c"}],
             FontVariations->{"Underline"->False}]],
           FontVariations->{"Underline"->True}], 
          StyleBox["[",
           FontVariations->{"Underline"->True}], 
          StyleBox["\[CapitalOmega]",
           FontVariations->{"Underline"->False}], 
          StyleBox["]",
           FontVariations->{"Underline"->True}]}]},
        {
         RowBox[{
          StyleBox[
           SubscriptBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD1", ",", "s"}],
             FontVariations->{"Underline"->False}]],
           FontVariations->{"Underline"->True}], 
          StyleBox["[",
           FontVariations->{"Underline"->True}], 
          StyleBox["\[CapitalOmega]",
           FontVariations->{"Underline"->False}], 
          StyleBox["]",
           FontVariations->{"Underline"->True}]}]}
       }], ")"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubscriptBox["B", 
           RowBox[{"1", ",", "c"}]]},
         {
          SubscriptBox["B", 
           RowBox[{"1", ",", "s"}]]}
        }], ")"}], " ", "+", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           SubscriptBox[
            OverscriptBox["b", "^"], 
            RowBox[{"1", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]},
         {
          RowBox[{
           SubscriptBox[
            OverscriptBox["b", "^"], 
            RowBox[{"1", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}
        }], ")"}]}]}]}], " ", "\[IndentingNewLine]", 
   RowBox[{"aPD2vec", "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          StyleBox[
           SubscriptBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD2", ",", "c"}],
             FontVariations->{"Underline"->False}]],
           FontVariations->{"Underline"->True}], 
          StyleBox["[",
           FontVariations->{"Underline"->True}], 
          StyleBox["\[CapitalOmega]",
           FontVariations->{"Underline"->False}], 
          StyleBox["]",
           FontVariations->{"Underline"->True}]}]},
        {
         RowBox[{
          StyleBox[
           SubscriptBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD2", ",", "s"}],
             FontVariations->{"Underline"->False}]],
           FontVariations->{"Underline"->True}], 
          StyleBox["[",
           FontVariations->{"Underline"->True}], 
          StyleBox["\[CapitalOmega]",
           FontVariations->{"Underline"->False}], 
          StyleBox["]",
           FontVariations->{"Underline"->True}]}]}
       }], ")"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubscriptBox["B", 
           RowBox[{"2", ",", "c"}]]},
         {
          SubscriptBox["B", 
           RowBox[{"2", ",", "s"}]]}
        }], ")"}], " ", "+", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           SubscriptBox[
            OverscriptBox["b", "^"], 
            RowBox[{"2", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]},
         {
          RowBox[{
           SubscriptBox[
            OverscriptBox["b", "^"], 
            RowBox[{"2", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}
        }], ")"}]}]}]}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"NB", ":", " ", 
      RowBox[{"this", " ", 
       RowBox[{"doesn", "'"}], "t", " ", "sound", " ", "true"}]}], ",", " ", 
     RowBox[{
     "the", " ", "added", " ", "constant", " ", "picks", " ", "up", " ", "a", 
      " ", "delta", " ", "function", " ", "when", " ", "transformed", " ", 
      "forwards", " ", "or", " ", 
      RowBox[{"backwards", "?"}]}]}], "*)"}]}]}]], "Input",
 CellFrame->{{0, 0}, {0, 2}},
 CellChangeTimes->{{3.805513868266603*^9, 3.8055139485825787`*^9}, {
  3.805515530528767*^9, 3.805515537024125*^9}, {3.805515575338846*^9, 
  3.8055155966522913`*^9}, {3.805518215856917*^9, 
  3.805518216504794*^9}},ExpressionUUID->"1c716c22-cd95-4036-8a5e-\
e3aaac0084b8"]], "Text",
 CellChangeTimes->{
  3.805518316350728*^9, {3.8055183491365547`*^9, 3.805518371854121*^9}, 
   3.805523936428537*^9},ExpressionUUID->"400161cc-835d-4015-8163-\
4d30c1a0797b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "spotting", " ", "the", " ", "frequency", " ", "dependent", " ", 
    "sections", " ", "by", " ", "eye"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Column", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"aPD1vec", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"aPD1vec", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"aPD2vec", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"aPD2vec", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.805515634410458*^9, 3.805515635276225*^9}, {
   3.805516533463911*^9, 3.8055165374180737`*^9}, {3.8055178499362497`*^9, 
   3.805517869116086*^9}, 3.8055182729122458`*^9, {3.805518392623622*^9, 
   3.8055184755812273`*^9}, {3.805518538320611*^9, 3.805518545513605*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"538a57be-ccd9-4342-af09-0d8258f20fce"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", 
        SqrtBox["2"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"A", " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], "+", 
         SubscriptBox[
          OverscriptBox["a", "^"], "1"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "r1"}], " ", 
             SubscriptBox[
              OverscriptBox["n", "^"], "1"]}], "-", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", "r1", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r1", "2"], "+", 
               SuperscriptBox["t1", "2"]}], ")"}], " ", 
             SubscriptBox[
              OverscriptBox["n", "^"], "1"]}], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    SuperscriptBox["r1", "2"]}], "+", 
                    SuperscriptBox["t1", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
                    SuperscriptBox[
                    RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["t1", "2"], " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                   RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
                   RowBox[{"Sinh", "[", 
                    RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}], " ", 
                SubscriptBox[
                 OverscriptBox["n", "^"], "1"]}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["t1", "2"], " ", 
                RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
                RowBox[{"Cosh", "[", "r", "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"Cosh", "[", "r", "]"}]}], " ", 
                   RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                   RowBox[{"Sinh", "[", "r", "]"}]}]}], ")"}], " ", 
                SubscriptBox[
                 OverscriptBox["n", "^"], "2"]}]}], ")"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", 
             SuperscriptBox["r1", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", "r1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
               SuperscriptBox[
                RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}]}],
         ")"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", 
        SqrtBox["2"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"A", " ", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], "+", 
         SubscriptBox[
          OverscriptBox["a", "^"], "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "r1"}], " ", 
             SubscriptBox[
              OverscriptBox["n", "^"], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["t1", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"Cosh", "[", "r", "]"}], "2"], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                   RowBox[{"Sinh", "[", 
                    RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}], " ", 
                SubscriptBox[
                 OverscriptBox["n", "^"], "1"]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    SuperscriptBox["\[ExponentialE]", 
                    FractionBox[
                    RowBox[{
                    "2", " ", "\[ImaginaryI]", " ", "L", " ", 
                    "\[CapitalOmega]"}], "c"]]}], " ", "r1", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["r1", "2"], "+", 
                    SuperscriptBox["t1", "2"]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    SuperscriptBox["r1", "2"]}], "+", 
                    SuperscriptBox["t1", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
                    SuperscriptBox[
                    RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}], "-", 
                  RowBox[{
                   SuperscriptBox["t1", "2"], " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                   RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
                   RowBox[{"Sinh", "[", 
                    RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}], " ", 
                SubscriptBox[
                 OverscriptBox["n", "^"], "2"]}]}], ")"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", 
             SuperscriptBox["r1", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", "r1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
               SuperscriptBox[
                RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}]}],
         ")"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", 
        SqrtBox["2"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "A"}], " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], "-", 
         SubscriptBox[
          OverscriptBox["a", "^"], "1"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "r1"}], " ", 
             SubscriptBox[
              OverscriptBox["n", "^"], "1"]}], "-", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", "r1", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r1", "2"], "+", 
               SuperscriptBox["t1", "2"]}], ")"}], " ", 
             SubscriptBox[
              OverscriptBox["n", "^"], "1"]}], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    SuperscriptBox["r1", "2"]}], "+", 
                    SuperscriptBox["t1", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
                    SuperscriptBox[
                    RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["t1", "2"], " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                   RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
                   RowBox[{"Sinh", "[", 
                    RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}], " ", 
                SubscriptBox[
                 OverscriptBox["n", "^"], "1"]}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["t1", "2"], " ", 
                RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
                RowBox[{"Cosh", "[", "r", "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"Cosh", "[", "r", "]"}]}], " ", 
                   RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                   RowBox[{"Sinh", "[", "r", "]"}]}]}], ")"}], " ", 
                SubscriptBox[
                 OverscriptBox["n", "^"], "2"]}]}], ")"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", 
             SuperscriptBox["r1", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", "r1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
               SuperscriptBox[
                RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}]}],
         ")"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", 
        SqrtBox["2"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "A"}], " ", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], "-", 
         SubscriptBox[
          OverscriptBox["a", "^"], "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "r1"}], " ", 
             SubscriptBox[
              OverscriptBox["n", "^"], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["t1", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"Cosh", "[", "r", "]"}], "2"], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                   RowBox[{"Sinh", "[", 
                    RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}], " ", 
                SubscriptBox[
                 OverscriptBox["n", "^"], "1"]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    SuperscriptBox["\[ExponentialE]", 
                    FractionBox[
                    RowBox[{
                    "2", " ", "\[ImaginaryI]", " ", "L", " ", 
                    "\[CapitalOmega]"}], "c"]]}], " ", "r1", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["r1", "2"], "+", 
                    SuperscriptBox["t1", "2"]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    SuperscriptBox["r1", "2"]}], "+", 
                    SuperscriptBox["t1", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
                    SuperscriptBox[
                    RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}], "-", 
                  RowBox[{
                   SuperscriptBox["t1", "2"], " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                   RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
                   RowBox[{"Sinh", "[", 
                    RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}], " ", 
                SubscriptBox[
                 OverscriptBox["n", "^"], "2"]}]}], ")"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", 
             SuperscriptBox["r1", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", "r1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
               SuperscriptBox[
                RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}]}],
         ")"}]}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.8055185401736917`*^9, 3.805518546588161*^9}, 
   3.805523973158722*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"80eb186d-6b28-463a-bc0b-f4cd5834b7bb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     SuperscriptBox["2", 
      RowBox[{"1", "/", "2"}]], " ", "expression", " ", "for", " ", "freq"}], 
    "-", 
    RowBox[{"dependent", " ", "avoids", " ", "using", " ", "Simplify"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["B", 
         RowBox[{"1", ",", "c"}]], 
        SubscriptBox[
         OverscriptBox["b", "^"], 
         RowBox[{"1", ",", "c"}]]},
       {
        SubscriptBox["B", 
         RowBox[{"1", ",", "s"}]], 
        SubscriptBox[
         OverscriptBox["b", "^"], 
         RowBox[{"1", ",", "s"}]]},
       {
        SubscriptBox["B", 
         RowBox[{"2", ",", "c"}]], 
        SubscriptBox[
         OverscriptBox["b", "^"], 
         RowBox[{"2", ",", "c"}]]},
       {
        SubscriptBox["B", 
         RowBox[{"2", ",", "s"}]], 
        SubscriptBox[
         OverscriptBox["b", "^"], 
         RowBox[{"2", ",", "s"}]]}
      }], ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"1", "/", "2"}]]], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"A", " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"aPD1vec", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], 
           SubscriptBox["B", 
            RowBox[{"1", ",", "c"}]]}]}]},
        {
         RowBox[{"A", " ", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"aPD1vec", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], 
           SubscriptBox["B", 
            RowBox[{"1", ",", "s"}]]}]}]},
        {
         RowBox[{
          RowBox[{"-", "A"}], " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"aPD2vec", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], 
           SubscriptBox["B", 
            RowBox[{"2", ",", "c"}]]}]}]},
        {
         RowBox[{
          RowBox[{"-", "A"}], " ", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"aPD2vec", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], 
           SubscriptBox["B", 
            RowBox[{"2", ",", "s"}]]}]}]}
       }], ")"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.805517201742526*^9, 3.805517260542101*^9}, {
  3.805517361025305*^9, 3.805517383796362*^9}, {3.805517790800758*^9, 
  3.805517830472193*^9}, {3.8055185899405947`*^9, 3.805518735049914*^9}, {
  3.805518771742667*^9, 3.805518772282138*^9}, {3.805518859751245*^9, 
  3.8055189051710653`*^9}, {3.805519017426511*^9, 3.8055190419226713`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"a577ebcd-04f6-49b8-b579-2c11c0442b23"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"computing", " ", "the", " ", "homodyne", " ", "intensity", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], "=", " ", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["I", "hom"], "^"], "[", "\[CapitalOmega]", "]"}]}], 
      ")"}], " ", "in", " ", "frequency", " ", "domain", 
     "\[IndentingNewLine]", 
     RowBox[{"NB", ":", " ", 
      RowBox[{
       RowBox[{"I", "'"}], "ve", " ", "dropped", " ", 
       SubscriptBox["C", "0"], " ", "here"}]}]}], ",", " ", 
    RowBox[{"should", " ", "it", " ", "have", " ", "stayed", " ", 
     RowBox[{"it", "?", " ", "and"}], " ", "if", " ", "so"}], ",", " ", 
    RowBox[{"what", " ", "is", " ", 
     RowBox[{"it", "?"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    OverscriptBox["HomI", "^"], "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", 
        RowBox[{"1", ",", "c"}]], 
       SubscriptBox[
        OverscriptBox["b", "^"], 
        RowBox[{"1", ",", "c"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", 
        RowBox[{"1", ",", "s"}]], 
       SubscriptBox[
        OverscriptBox["b", "^"], 
        RowBox[{"1", ",", "s"}]]}], "-", 
      RowBox[{
       SubscriptBox["B", 
        RowBox[{"2", ",", "c"}]], 
       SubscriptBox[
        OverscriptBox["b", "^"], 
        RowBox[{"2", ",", "c"}]]}], "-", 
      RowBox[{
       SubscriptBox["B", 
        RowBox[{"2", ",", "s"}]], 
       SubscriptBox[
        OverscriptBox["b", "^"], 
        RowBox[{"2", ",", "s"}]]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "notice", " ", "that", " ", "the", " ", "laser", " ", "noise", " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["a", "^"], "1"], ",", 
        SubscriptBox[
         OverscriptBox["a", "^"], "2"]}], ")"}], " ", "has", " ", "cancelled",
       " ", "out"}], ",", " ", 
     RowBox[{
     "just", " ", "as", " ", "expected", " ", "for", " ", "homodyne", " ", 
      "readout"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{
  3.8055178848866787`*^9, {3.8055191075457478`*^9, 3.805519315161327*^9}, {
   3.805519721598878*^9, 3.805519721849345*^9}, {3.805520260364334*^9, 
   3.8055204104913273`*^9}, {3.805520544463285*^9, 3.8055206447047167`*^9}, {
   3.80552071073689*^9, 3.805520752429997*^9}, {3.8055217772502613`*^9, 
   3.805521782349103*^9}, {3.805521933576976*^9, 3.805521935399577*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"c6ef84fd-f5e0-4a24-aceb-de1d43bea371"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"A", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r1", " ", 
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "0"], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox["r1", "3"], " ", 
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "0"], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", "r1", " ", 
            SuperscriptBox["t1", "2"], " ", 
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "0"], "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r", "]"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  SuperscriptBox["r1", "2"]}], "+", 
                 SuperscriptBox["t1", "2"]}], ")"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "0"], "]"}]}], "+", 
              RowBox[{
               SuperscriptBox["t1", "2"], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                SubscriptBox["\[Theta]", "0"], "]"}]}]}], ")"}]}], "-", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               SuperscriptBox["r1", "2"]}], "+", 
              SuperscriptBox["t1", "2"]}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "0"], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "-", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox["t1", "2"], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
            RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "0"], "]"}], " ", 
            RowBox[{"Sinh", "[", 
             RowBox[{"2", " ", "r"}], "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox["t1", "2"], " ", 
            RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "0"], "]"}], " ", 
            RowBox[{"Sinh", "[", 
             RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}], " ", 
         SubscriptBox[
          OverscriptBox["n", "^"], "1"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r", "]"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["t1", "2"], " ", 
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "0"], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  SuperscriptBox["r1", "2"]}], "+", 
                 SuperscriptBox["t1", "2"]}], ")"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                SubscriptBox["\[Theta]", "0"], "]"}]}]}], ")"}]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox["t1", "2"], " ", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "0"], "]"}], " ", 
            RowBox[{"Cosh", "[", "r", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Sinh", "[", "r", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "0"], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"r1", "+", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{
                 "4", " ", "\[ImaginaryI]", " ", "L", " ", 
                  "\[CapitalOmega]"}], "c"]], " ", 
               SuperscriptBox["r1", "3"]}], "+", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{
                 "4", " ", "\[ImaginaryI]", " ", "L", " ", 
                  "\[CapitalOmega]"}], "c"]], " ", "r1", " ", 
               SuperscriptBox["t1", "2"]}], "-", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{
                 "2", " ", "\[ImaginaryI]", " ", "L", " ", 
                  "\[CapitalOmega]"}], "c"]], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  SuperscriptBox["r1", "2"]}], "+", 
                 SuperscriptBox["t1", "2"]}], ")"}], " ", 
               SuperscriptBox[
                RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "+", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{
                 "2", " ", "\[ImaginaryI]", " ", "L", " ", 
                  "\[CapitalOmega]"}], "c"]], " ", 
               SuperscriptBox["t1", "2"], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
               RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
               RowBox[{"Sinh", "[", 
                RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
         SubscriptBox[
          OverscriptBox["n", "^"], "2"]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       SuperscriptBox["r1", "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", "r1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", "r1", " ", 
       SuperscriptBox[
        RowBox[{"Sinh", "[", "r", "]"}], "2"]}]}], ")"}]}], ")"}]}]], "Output",\

 CellChangeTimes->{{3.805519303970126*^9, 3.8055193208237553`*^9}, 
   3.805519738032012*^9, 3.805523978245955*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"6e312a55-a550-4717-9a10-581e461223f1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"extracting", " ", "the", " ", "co"}], "-", 
     RowBox[{"efficients", " ", "of", " ", 
      SubscriptBox[
       OverscriptBox["n", "^"], "1"]}]}], ",", " ", 
    SubscriptBox[
     OverscriptBox["n", "^"], "2"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"g1", "[", 
     RowBox[{
     "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "L_", ",", "\[Psi]_", 
      ",", "r_", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       SuperscriptBox["r1", "3"], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", "r1", " ", 
       SuperscriptBox["t1", "2"], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       SuperscriptBox[
        RowBox[{"Cosh", "[", "r", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["r1", "2"]}], "+", 
            SuperscriptBox["t1", "2"]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["t1", "2"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["r1", "2"]}], "+", 
         SuperscriptBox["t1", "2"]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       SuperscriptBox["t1", "2"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sinh", "[", 
        RowBox[{"2", " ", "r"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       SuperscriptBox["t1", "2"], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sinh", "[", 
        RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g2", "[", 
     RowBox[{
     "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "L_", ",", "\[Psi]_", 
      ",", "r_", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       SuperscriptBox[
        RowBox[{"Cosh", "[", "r", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["t1", "2"], " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["r1", "2"]}], "+", 
            SuperscriptBox["t1", "2"]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       SuperscriptBox["t1", "2"], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cosh", "[", "r", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sinh", "[", "r", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"r1", "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]], " ", 
          SuperscriptBox["r1", "3"]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]], " ", "r1", " ", 
          SuperscriptBox["t1", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["r1", "2"]}], "+", 
            SuperscriptBox["t1", "2"]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]], " ", 
          SuperscriptBox["t1", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g3", "[", 
     RowBox[{
     "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "L_", ",", "\[Psi]_", 
      ",", "r_", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       SuperscriptBox["r1", "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", "r1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", "r1", " ", 
       SuperscriptBox[
        RowBox[{"Sinh", "[", "r", "]"}], "2"]}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8055232308581657`*^9, 3.805523272017584*^9}, {
  3.805523304608532*^9, 3.805523517265197*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"eb69f030-4f96-4769-94b8-3d3310292795"],

Cell[TextData[Cell[BoxData[{
 RowBox[{
  RowBox[{
   OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], "=", " ", 
  RowBox[{
   FractionBox["A", 
    RowBox[{"g3", "[", 
     RowBox[{
      RowBox[{"\[CapitalOmega]", ";", "r1"}], ",", "t1", ",", "L", ",", 
      "\[Psi]", ",", "r", ",", "\[Phi]", ",", 
      SubscriptBox["\[Theta]", "0"]}], "]"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"g1", "[", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", ";", "r1"}], ",", "t1", ",", "L", ",", 
        "\[Psi]", ",", "r", ",", "\[Phi]", ",", 
        SubscriptBox["\[Theta]", "0"]}], "]"}], 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}]}], " ", 
     "\[IndentingNewLine]", "+", " ", 
     RowBox[{
      RowBox[{"g2", "[", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", ";", "r1"}], ",", "t1", ",", "L", ",", 
        "\[Psi]", ",", "r", ",", "\[Phi]", ",", 
        SubscriptBox["\[Theta]", "0"]}], "]"}], 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], "=", " ", 
   RowBox[{
    FractionBox["A", 
     RowBox[{"g3", "[", "\[CapitalOmega]", "]"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}]}], " ", 
      "+", " ", 
      RowBox[{
       RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}]}]}], 
     ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "computing", " ", "the", " ", "power", " ", "spectral", " ", "density",
         " ", 
        RowBox[{"(", "PSD", ")"}], " ", "of", " ", "the", " ", "homodyne", 
        " ", "intensity"}], ",", " ", 
       RowBox[{
        RowBox[{"this", " ", "quantifies", " ", "the", " ", "quantum", " ", 
         RowBox[{"noise", ".", "\[IndentingNewLine]", "Let"}]}], " ", "|", 
        "0"}]}], "\[RightAngleBracket]"}], " ", "represent", " ", "the", " ", 
     "vacuum", " ", 
     RowBox[{"(", "ground", ")"}], " ", "state"}], ",", " ", 
    RowBox[{"for", " ", "reasons", " ", "I", " ", 
     RowBox[{"don", "'"}], "t", " ", "understand"}], ",", " ", 
    RowBox[{
    "we", " ", "take", " ", "expectation", " ", "against", " ", "this", " ", 
     "instead", " ", "of", " ", "the", " ", "actual", " ", 
     RowBox[{"state", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     OverscriptBox[
      SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", 
    "2", "\[Pi]", " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"\[CapitalOmega]", "-", 
      RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], " ", "=", " ", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"0", "|", 
     RowBox[{
      RowBox[{
       OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], 
      "\[EmptyCircle]", 
      RowBox[{
       RowBox[{
        OverscriptBox["HomI", "^"], "\[ConjugateTranspose]"}], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "|", "0"}], 
    "\[RightAngleBracket]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"[", "D", "]"}], "pg", ".35"}], ",", " ", 
    RowBox[{
    "from", " ", "assuming", " ", "the", " ", "time", " ", "domain", " ", 
     "is", " ", "Hermitian"}], ",", " ", 
    RowBox[{
     RowBox[{"frequency", " ", "domain", " ", "obeys", " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["a", 
         RowBox[{"c", ",", "s"}]], "\[Dagger]"], "[", "\[CapitalOmega]", 
       "]"}]}], " ", "=", " ", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"c", ",", "s"}]], "[", 
      RowBox[{"-", "\[CapitalOmega]"}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"NB", ":", " ", 
     RowBox[{"for", " ", "now"}]}], ",", " ", 
    RowBox[{
     RowBox[{"I", "'"}], "ll", " ", "assume", " ", 
     RowBox[{
      OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], " ", "is", 
     " ", "Hermitian"}], ",", " ", 
    RowBox[{
    "although", " ", "I", " ", "think", " ", "that", " ", "this", " ", "is", 
     " ", "wrong"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    OverscriptBox[
     SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", "2",
    "\[Pi]", " ", 
   RowBox[{"\[Delta]", "[", 
    RowBox[{"\[CapitalOmega]", "-", 
     RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], " ", "=", " ", 
  RowBox[{
   FractionBox["1", "2"], 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"0", "|", 
     RowBox[{
      RowBox[{
       RowBox[{
        OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], 
       RowBox[{
        RowBox[{
         OverscriptBox["HomI", "^"], "\[ConjugateTranspose]"}], "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{
         OverscriptBox["HomI", "^"], "\[ConjugateTranspose]"}], "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
       RowBox[{
        OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}]}]}], "|", 
     "0"}], "\[RightAngleBracket]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     OverscriptBox[
      SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", 
    "2", "\[Pi]", " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"\[CapitalOmega]", "-", 
      RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], " ", "=", " ", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"0", "|", 
      RowBox[{
       RowBox[{
        FractionBox["A", 
         RowBox[{"g3", "[", "\[CapitalOmega]", "]"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}]}], 
          " ", "+", " ", 
          RowBox[{
           RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}]}]}],
          ")"}], 
        FractionBox["A", 
         RowBox[{"g3", "[", 
          RowBox[{"\[CapitalOmega]", "'"}], "]"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"g1", "[", 
            RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "1"], "[", 
            RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"g2", "[", 
            RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "2"], "[", 
            RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["A", 
         RowBox[{"g3", "[", 
          RowBox[{"\[CapitalOmega]", "'"}], "]"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"g1", "[", 
            RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "1"], "[", 
            RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"g2", "[", 
            RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "2"], "[", 
            RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]}], ")"}], 
        FractionBox["A", 
         RowBox[{"g3", "[", "\[CapitalOmega]", "]"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}]}], 
          " ", "+", " ", 
          RowBox[{
           RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}]}]}],
          ")"}]}]}], "|", "0"}], "\[RightAngleBracket]"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "expanding", " ", "out", " ", "terms", " ", "and", " ", "spotting", " ", 
    "symmetric", " ", "products"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     OverscriptBox[
      SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", 
    "2", "\[Pi]", " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"\[CapitalOmega]", "-", 
      RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], " ", "=", " ", 
   RowBox[{
    FractionBox[
     SuperscriptBox["A", "2"], 
     RowBox[{
      RowBox[{"g3", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{"g3", "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]], 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"0", "|", 
      RowBox[{
       RowBox[{
        RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
        RowBox[{"g1", "[", 
         RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
          "\[EmptyCircle]", 
          RowBox[{
           SubscriptBox[
            OverscriptBox["n", "^"], "1"], "[", 
           RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
        RowBox[{"g2", "[", 
         RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
          "\[EmptyCircle]", 
          RowBox[{
           SubscriptBox[
            OverscriptBox["n", "^"], "2"], "[", 
           RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], ")"}]}], 
       "\[IndentingNewLine]", "+", 
       RowBox[{
        RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
        RowBox[{"g2", "[", 
         RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
          "\[EmptyCircle]", 
          RowBox[{
           SubscriptBox[
            OverscriptBox["n", "^"], "2"], "[", 
           RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
        RowBox[{"g1", "[", 
         RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
          "\[EmptyCircle]", 
          RowBox[{
           SubscriptBox[
            OverscriptBox["n", "^"], "1"], "[", 
           RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], ")"}]}]}], "|", "0"}], 
     "\[RightAngleBracket]"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"results", " ", "from", " ", "the", " ", "top", " ", 
    RowBox[{"of", " ", "[", "D", "]"}], "pg", ".38"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"0", "|", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
     "\[EmptyCircle]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["n", "^"], "1"], "[", 
      RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "|", "0"}], 
   "\[RightAngleBracket]"}], " ", "=", " ", 
  RowBox[{
   FractionBox["1", "2"], "2", "\[Pi]", " ", 
   RowBox[{"\[Delta]", "[", 
    RowBox[{"\[CapitalOmega]", "-", 
     RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"0", "|", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
     "\[EmptyCircle]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["n", "^"], "2"], "[", 
      RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "|", "0"}], 
   "\[RightAngleBracket]"}], " ", "=", " ", 
  RowBox[{
   FractionBox["1", "2"], "2", "\[Pi]", " ", 
   RowBox[{"\[Delta]", "[", 
    RowBox[{"\[CapitalOmega]", "-", 
     RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"0", "|", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
      "\[EmptyCircle]", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "2"], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], " ", "|", "0"}], 
    "\[RightAngleBracket]"}], "=", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"0", "|", " ", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
       "\[EmptyCircle]", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "1"], "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], " ", "|", "0"}], 
     "\[RightAngleBracket]"}], "=", " ", "0"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "as", " ", "so", " ", "we", " ", "have", " ", "the", " ", "PSD", " ", 
     "of", " ", "the", " ", "homodyne", " ", "intensity"}], ",", " ", 
    RowBox[{
    "to", " ", "quantify", " ", "the", " ", "quantum", " ", "noise"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    OverscriptBox[
     SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", 
   RowBox[{"\[Delta]", "[", 
    RowBox[{"\[CapitalOmega]", "-", 
     RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], " ", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["A", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
        RowBox[{"g1", "[", 
         RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
        RowBox[{"g2", "[", 
         RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]}], ")"}]}], 
    RowBox[{"2", 
     RowBox[{"g3", "[", "\[CapitalOmega]", "]"}], 
     RowBox[{"g3", "[", 
      RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]], 
   RowBox[{"\[Delta]", "[", 
    RowBox[{"\[CapitalOmega]", "-", 
     RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.805425327335909*^9, 3.805425353277169*^9}, {
   3.80542606670446*^9, 3.805426077824092*^9}, 3.805513119714265*^9, {
   3.8055132659587927`*^9, 3.8055132888678923`*^9}, 3.805515125648028*^9, {
   3.805515239246922*^9, 3.805515239366498*^9}, {3.8055158336980133`*^9, 
   3.8055158456038637`*^9}, {3.805520003392823*^9, 3.805520057417431*^9}, 
   3.805520827035976*^9, {3.805520919592492*^9, 
   3.805521002318198*^9}},ExpressionUUID->"9dd7e2a2-4d60-461f-862a-\
c8b37fd06d19"]], "Text",
 CellChangeTimes->{{3.805521269856475*^9, 3.805521299259407*^9}, {
  3.805521359419512*^9, 3.8055213619952*^9}, {3.805521442289694*^9, 
  3.805521445793496*^9}, {3.8055214913866663`*^9, 3.8055214913868113`*^9}, {
  3.80552162836655*^9, 3.8055217903272142`*^9}, {3.805521831584648*^9, 
  3.8055218820340977`*^9}, {3.8055219438763037`*^9, 3.805522029996286*^9}, {
  3.8055221197141447`*^9, 3.805522277494151*^9}, {3.805522425556931*^9, 
  3.8055224255874243`*^9}, {3.8055224869748087`*^9, 3.805522596011817*^9}, {
  3.80552263079504*^9, 3.805522712216754*^9}, {3.8055227470594463`*^9, 
  3.805522781902648*^9}, {3.80552282255931*^9, 3.805522847871427*^9}, {
  3.8055229723476562`*^9, 3.8055229849839287`*^9}, {3.805523040352229*^9, 
  3.805523142802541*^9}, {3.805523200455138*^9, 3.8055232019227448`*^9}, {
  3.8055234455595083`*^9, 
  3.805523445560379*^9}},ExpressionUUID->"8d1e2bf2-1502-48c5-bdca-\
c43e07e3d292"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "calculating", " ", "the", " ", "fraction", " ", "above", " ", "in", " ", 
     "the", " ", "formula", " ", "for", " ", "the", " ", "PSD", " ", "of", 
     " ", "homodyne", " ", "intensity"}], ",", " ", 
    RowBox[{
     RowBox[{"using", " ", "\[CapitalOmega]2"}], " ", "=", " ", 
     RowBox[{"\[CapitalOmega]", "'"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SHomIfrac", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["A", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"g1", "[", 
           RowBox[{
           "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "L", ",", "\[Psi]", 
            ",", "r", ",", "\[Phi]", ",", 
            SubscriptBox["\[Theta]", "0"]}], "]"}], 
          RowBox[{"g1", "[", 
           RowBox[{
           "\[CapitalOmega]2", ",", "r1", ",", "t1", ",", "L", ",", "\[Psi]", 
            ",", "r", ",", "\[Phi]", ",", 
            SubscriptBox["\[Theta]", "0"]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"g2", "[", 
           RowBox[{
           "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "L", ",", "\[Psi]", 
            ",", "r", ",", "\[Phi]", ",", 
            SubscriptBox["\[Theta]", "0"]}], "]"}], 
          RowBox[{"g2", "[", 
           RowBox[{
           "\[CapitalOmega]2", ",", "r1", ",", "t1", ",", "L", ",", "\[Psi]", 
            ",", "r", ",", "\[Phi]", ",", 
            SubscriptBox["\[Theta]", "0"]}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", 
       RowBox[{"g3", "[", 
        RowBox[{
        "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "L", ",", "\[Psi]", ",",
          "r", ",", "\[Phi]", ",", 
         SubscriptBox["\[Theta]", "0"]}], "]"}], 
       RowBox[{"g3", "[", 
        RowBox[{
        "\[CapitalOmega]2", ",", "r1", ",", "t1", ",", "L", ",", "\[Psi]", 
         ",", "r", ",", "\[Phi]", ",", 
         SubscriptBox["\[Theta]", "0"]}], "]"}]}], ")"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8055228257890463`*^9, 3.80552282640447*^9}, 
   3.8055232113105183`*^9, {3.805523541153281*^9, 3.805523673760887*^9}, {
   3.805523748198502*^9, 3.805523818140089*^9}, 3.805523868009508*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"3214cef3-b260-49f1-8a81-1f09bf82b900"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["A", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r1", " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]], " ", 
          SuperscriptBox["r1", "3"], " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]], " ", "r1", " ", 
          SuperscriptBox["t1", "2"], " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               SuperscriptBox["t1", "2"]}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "0"], "]"}]}], "+", 
            RowBox[{
             SuperscriptBox["t1", "2"], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "0"], "]"}]}]}], ")"}]}], "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["r1", "2"]}], "+", 
            SuperscriptBox["t1", "2"]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}], " ", 
          SuperscriptBox[
           RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]], " ", 
          SuperscriptBox["t1", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}], " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", " ", "r"}], "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]], " ", 
          SuperscriptBox["t1", "2"], " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}], " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r1", " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]2"}], 
            "c"]], " ", 
          SuperscriptBox["r1", "3"], " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]2"}], 
            "c"]], " ", "r1", " ", 
          SuperscriptBox["t1", "2"], " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]2"}], 
            "c"]], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               SuperscriptBox["t1", "2"]}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "0"], "]"}]}], "+", 
            RowBox[{
             SuperscriptBox["t1", "2"], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "0"], "]"}]}]}], ")"}]}], "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]2"}], 
            "c"]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["r1", "2"]}], "+", 
            SuperscriptBox["t1", "2"]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}], " ", 
          SuperscriptBox[
           RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]2"}], 
            "c"]], " ", 
          SuperscriptBox["t1", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}], " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", " ", "r"}], "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]2"}], 
            "c"]], " ", 
          SuperscriptBox["t1", "2"], " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}], " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["t1", "2"], " ", 
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "0"], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               SuperscriptBox["t1", "2"]}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "0"], "]"}]}]}], ")"}]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]], " ", 
          SuperscriptBox["t1", "2"], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}], " ", 
          RowBox[{"Cosh", "[", "r", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sinh", "[", "r", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"r1", "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", 
             SuperscriptBox["r1", "3"]}], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", "r1", " ", 
             SuperscriptBox["t1", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               SuperscriptBox["t1", "2"]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", 
             SuperscriptBox["t1", "2"], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
             RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
             RowBox[{"Sinh", "[", 
              RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]2"}], 
            "c"]], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["t1", "2"], " ", 
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "0"], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               SuperscriptBox["t1", "2"]}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "0"], "]"}]}]}], ")"}]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]2"}], 
            "c"]], " ", 
          SuperscriptBox["t1", "2"], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}], " ", 
          RowBox[{"Cosh", "[", "r", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sinh", "[", "r", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "0"], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"r1", "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]2"}],
                "c"]], " ", 
             SuperscriptBox["r1", "3"]}], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]2"}],
                "c"]], " ", "r1", " ", 
             SuperscriptBox["t1", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]2"}],
                "c"]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               SuperscriptBox["t1", "2"]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]2"}],
                "c"]], " ", 
             SuperscriptBox["t1", "2"], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
             RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
             RowBox[{"Sinh", "[", 
              RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", 
       SuperscriptBox["r1", "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", "r1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], "c"]],
        " ", "r1", " ", 
       SuperscriptBox[
        RowBox[{"Sinh", "[", "r", "]"}], "2"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]2"}], 
         "c"]], " ", 
       SuperscriptBox["r1", "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]2"}], 
         "c"]], " ", "r1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]2"}], 
         "c"]], " ", "r1", " ", 
       SuperscriptBox[
        RowBox[{"Sinh", "[", "r", "]"}], "2"]}]}], ")"}]}], ")"}]}]], "Output",\

 CellChangeTimes->{{3.805523784289824*^9, 3.805523797623522*^9}, {
   3.8055238816601343`*^9, 3.8055238882909327`*^9}, 3.805523981598647*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"2e3ae144-c508-466f-9be4-c07032c8650c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.805523565520809*^9, {3.805523735147209*^9, 
   3.805523744064376*^9}},ExpressionUUID->"74ba13db-35a6-44fd-9c49-\
6139bae4e1d7"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"sanity", " ", "checks"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"areflvec", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"\[Delta]l", " ", 
             SubscriptBox["\[Omega]", "0"]}], "c"], "\[Rule]", " ", 
           "\[Psi]"}], ",", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "+", "\[Delta]l"}], ")"}], " ", 
             "\[CapitalOmega]"}], "c"], "->", 
           FractionBox[
            RowBox[{" ", 
             RowBox[{"L", " ", "\[CapitalOmega]"}]}], "c"]}], ",", 
          RowBox[{"r1", "\[Rule]", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["t1", "2"]}], ")"}], 
            RowBox[{"1", "/", "2"}]]}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "\[Rule]", "0"}], ",", 
         RowBox[{"\[CapitalOmega]", "\[Rule]", "0"}]}], "}"}]}], "]"}], "/.", 
     
     RowBox[{"{", 
      RowBox[{"\[Psi]", "\[Rule]", "0"}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r1", "\[Rule]", 
       SuperscriptBox["0.84", 
        RowBox[{"1", "/", "2"}]]}], ",", 
      RowBox[{"t1", "\[Rule]", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "0.84"}], ")"}], 
        RowBox[{"1", "/", "2"}]]}]}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"areflvec", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"\[Delta]l", " ", 
             SubscriptBox["\[Omega]", "0"]}], "c"], "\[Rule]", " ", 
           "\[Psi]"}], ",", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "+", "\[Delta]l"}], ")"}], " ", 
             "\[CapitalOmega]"}], "c"], "->", 
           FractionBox[
            RowBox[{" ", 
             RowBox[{"L", " ", "\[CapitalOmega]"}]}], "c"]}], ",", 
          RowBox[{"r1", "\[Rule]", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["t1", "2"]}], ")"}], 
            RowBox[{"1", "/", "2"}]]}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "\[Rule]", "0"}], ",", 
         RowBox[{"\[CapitalOmega]", "\[Rule]", "0"}]}], "}"}]}], "]"}], "/.", 
     
     RowBox[{"{", 
      RowBox[{"\[Psi]", "\[Rule]", 
       FractionBox["\[Pi]", "2"]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r1", "\[Rule]", 
       SuperscriptBox["0.84", 
        RowBox[{"1", "/", "2"}]]}], ",", 
      RowBox[{"t1", "\[Rule]", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "0.84"}], ")"}], 
        RowBox[{"1", "/", "2"}]]}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"cavMatrixB", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"cavMatrix", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"\[Delta]l", " ", 
            SubscriptBox["\[Omega]", "0"]}], "c"], "\[Rule]", " ", "\[Psi]"}],
          ",", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"L", "+", "\[Delta]l"}], ")"}], " ", "\[CapitalOmega]"}],
            "c"], "->", 
          FractionBox[
           RowBox[{" ", 
            RowBox[{"L", " ", "\[CapitalOmega]"}]}], "c"]}], ",", 
         RowBox[{"r1", "\[Rule]", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["t1", "2"]}], ")"}], 
           RowBox[{"1", "/", "2"}]]}], ",", 
         RowBox[{"\[Phi]", "\[Rule]", " ", "0"}]}], " ", "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "\[Rule]", "0"}], ",", 
        RowBox[{"r1", "\[Rule]", 
         SuperscriptBox["0.84", 
          RowBox[{"1", "/", "2"}]]}], ",", 
        RowBox[{"t1", "\[Rule]", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "0.84"}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ",", 
        RowBox[{"\[Psi]", "\[Rule]", "0"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"cavMatrixB", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"cavMatrixB", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "0", ",", "0.1"}], "}"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], 
    "]"}]}]}]], "Input",
 CellFrame->{{0, 0}, {0, 2}},
 CellChangeTimes->{{3.805422838605166*^9, 3.8054228469011917`*^9}, {
   3.8055127283776093`*^9, 3.805512729249014*^9}, 3.805515116611477*^9, {
   3.805515249121656*^9, 3.805515249856392*^9}, {3.805522792216992*^9, 
   3.8055227923610687`*^9}},ExpressionUUID->"8b9915ce-6217-49bf-b8f8-\
0018d531014b"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"old", " ", "working", " ", "below"}], "*)"}]}]], "Input",
 CellFrame->{{0, 0}, {0, 2}},
 CellChangeTimes->{{3.805512714956129*^9, 3.805512720227758*^9}, {
  3.805515109811583*^9, 3.805515110129045*^9}, {3.805515255357596*^9, 
  3.805515260205007*^9}, {3.805522797631563*^9, 
  3.80552279780641*^9}},ExpressionUUID->"9147f3c4-413a-4fee-a951-\
99260bb89c5b"],

Cell[TextData[{
 "homodyne readout takes the difference between the two photo-currents, each \
of which is proportional to the time average of the intensity of the field, \
due to the slow response of the PD\[CloseCurlyQuote]s\n",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["i", "hom"], "=", 
   RowBox[{
    SubscriptBox["i", "1"], "-", 
    SubscriptBox["i", "2"]}]}]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"ef801ce9-367a-4855-ba22-0789418acade"],
 "\n",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SubscriptBox["i", "1"], "\[Proportional]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"I", "[", "t", "]"}], "\[RightAngleBracket]"}]}], "=", 
   RowBox[{"\[LeftAngleBracket]", 
    SuperscriptBox[
     RowBox[{"\[LeftBracketingBar]", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["E", "^"], "PD1"], "[", "t", "]"}], 
      "\[RightBracketingBar]"}], "2"], "\[RightAngleBracket]"}]}]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"21ca2984-3f59-4cb7-ba85-421762d886e2"],
 "\nto find the intensity, we need the time domain signal, so let  ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox[
      StyleBox[
       OverscriptBox[
        StyleBox["a",
         FontVariations->{"Underline"->False}], "~"],
       FontVariations->{"Underline"->False}], "^"], 
     StyleBox[
      RowBox[{"PD1", ",", "c"}],
      FontVariations->{"Underline"->False}]], "[", "t", "]"}], " ", "=", " ", 
   
   RowBox[{"InverseFourierTransform", "[", 
    RowBox[{
     StyleBox[
      SubscriptBox[
       OverscriptBox[
        StyleBox["a",
         FontVariations->{"Underline"->False}], "^"], 
       StyleBox[
        RowBox[{"PD1", ",", "c"}],
        FontVariations->{"Underline"->False}]],
      FontVariations->{"Underline"->True}], 
     StyleBox["[",
      FontVariations->{"Underline"->True}], 
     StyleBox["\[CapitalOmega]",
      FontVariations->{"Underline"->False}], 
     StyleBox["]",
      FontVariations->{"Underline"->True}]}], "]"}]}]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"33a632e6-80a7-4ac6-a363-74a206a0c019"],
 "\n",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["E", "^"], "PD1"], "[", "t", "]"}], "=", " ", 
   RowBox[{
    SubscriptBox["C", "0"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox[
          StyleBox[
           OverscriptBox[
            StyleBox["a",
             FontVariations->{"Underline"->False}], "~"],
           FontVariations->{"Underline"->False}], "^"], 
         StyleBox[
          RowBox[{"PD1", ",", "c"}],
          FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox[
          StyleBox[
           OverscriptBox[
            StyleBox["a",
             FontVariations->{"Underline"->False}], "~"],
           FontVariations->{"Underline"->False}], "^"], 
         StyleBox[
          RowBox[{"PD1", ",", "s"}],
          FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], ")"}]}]}]], "Input",
  
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"89e07874-3d79-4123-85a4-f1f59a00cf4b"],
 "\n",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["i", "1"], "\[Proportional]", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["C", "0"], "2"], 
    RowBox[{"\[LeftAngleBracket]", 
     SuperscriptBox[
      RowBox[{"\[LeftBracketingBar]", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox[
           OverscriptBox[
            StyleBox[
             OverscriptBox[
              StyleBox["a",
               FontVariations->{"Underline"->False}], "~"],
             FontVariations->{"Underline"->False}], "^"], 
           StyleBox[
            RowBox[{"PD1", ",", "c"}],
            FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          SubscriptBox[
           OverscriptBox[
            StyleBox[
             OverscriptBox[
              StyleBox["a",
               FontVariations->{"Underline"->False}], "~"],
             FontVariations->{"Underline"->False}], "^"], 
           StyleBox[
            RowBox[{"PD1", ",", "s"}],
            FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], 
       "\[RightBracketingBar]"}], "2"], "\[RightAngleBracket]"}]}]}]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"bced0e7c-abdc-49aa-8ec0-1f3b90820ef5"],
 "\nand similarly for ",
 Cell[BoxData[
  SubscriptBox["i", "2"]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"7eab9a4c-47ad-41de-bf9c-71b1d404cf27"],
 "\n",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["i", "2"], "\[Proportional]", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["C", "0"], "2"], 
    RowBox[{"\[LeftAngleBracket]", 
     SuperscriptBox[
      RowBox[{"\[LeftBracketingBar]", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox[
           OverscriptBox[
            StyleBox[
             OverscriptBox[
              StyleBox["a",
               FontVariations->{"Underline"->False}], "~"],
             FontVariations->{"Underline"->False}], "^"], 
           StyleBox[
            RowBox[{"PD2", ",", "c"}],
            FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          SubscriptBox[
           OverscriptBox[
            StyleBox[
             OverscriptBox[
              StyleBox["a",
               FontVariations->{"Underline"->False}], "~"],
             FontVariations->{"Underline"->False}], "^"], 
           StyleBox[
            RowBox[{"PD2", ",", "s"}],
            FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], 
       "\[RightBracketingBar]"}], "2"], "\[RightAngleBracket]"}]}]}]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"ec63b1c8-df0e-40fd-874e-fc68fa69803a"],
 "\n",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["i", "hom"], "\[Proportional]", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["C", "0"], "2"], 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"\[LeftBracketingBar]", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             StyleBox[
              OverscriptBox[
               StyleBox["a",
                FontVariations->{"Underline"->False}], "~"],
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD1", ",", "c"}],
             FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             StyleBox[
              OverscriptBox[
               StyleBox["a",
                FontVariations->{"Underline"->False}], "~"],
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD1", ",", "s"}],
             FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], 
        "\[RightBracketingBar]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"\[LeftBracketingBar]", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             StyleBox[
              OverscriptBox[
               StyleBox["a",
                FontVariations->{"Underline"->False}], "~"],
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD2", ",", "c"}],
             FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             StyleBox[
              OverscriptBox[
               StyleBox["a",
                FontVariations->{"Underline"->False}], "~"],
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD2", ",", "s"}],
             FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], 
        "\[RightBracketingBar]"}], "2"]}], "\[RightAngleBracket]"}]}]}]], 
  "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"8cf44821-53fb-4a9a-8808-e5d98260e784"],
 "\n",
 StyleBox["[equation b1]",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.804891498835876*^9, 3.804891570660561*^9}, {
  3.8048916576833487`*^9, 3.8048916600553293`*^9}, {3.8048919160022583`*^9, 
  3.804892179379951*^9}, {3.804892224471863*^9, 3.8048922491941433`*^9}, {
  3.8048924473379602`*^9, 3.804892615018312*^9}, {3.8048926461851273`*^9, 
  3.804892724455352*^9}, {3.804892764003929*^9, 3.8048927745626307`*^9}, {
  3.8048928643459177`*^9, 3.804892994196513*^9}, {3.804893155906494*^9, 
  3.804893157126227*^9}, {3.804893309870536*^9, 3.804893355910508*^9}, {
  3.805061037061695*^9, 3.8050610571331053`*^9}, {3.805061125395212*^9, 
  3.805061127335663*^9}, {3.805512767876071*^9, 
  3.805512816937505*^9}},ExpressionUUID->"1f7002e5-0233-4495-9936-\
3c530f1e918d"],

Cell[BoxData[
 RowBox[{"iHomIsPropTo", " ", "=", " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Abs", "[", "E1", "]"}], "2"], "-", 
   SuperscriptBox[
    RowBox[{"Abs", "[", "E2", "]"}], "2"]}]}]], "Input",
 CellChangeTimes->{{3.805061627660615*^9, 
  3.8050616596074*^9}},ExpressionUUID->"0a4f665c-38af-4293-9be3-ec46336b299e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "we", " ", "need", " ", "to", " ", "take", " ", "Fourier", " ", 
     "transform", " ", "of", " ", "the", " ", "above", " ", "expressions"}], 
    ",", " ", 
    RowBox[{"but", " ", "Mathematica", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "know", " ", "that", " ", "the", " ", 
     "quadratures", " ", "depend", " ", "on", " ", "frequency"}], ",", " ", 
    RowBox[{"i", ".", "e", ".", " ", 
     RowBox[{
      SubscriptBox["a", "1"], "[", "\[CapitalOmega]", "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TimeaPD1vec", " ", "=", " ", 
    RowBox[{"InverseFourierTransform", "[", 
     RowBox[{"aPD1vec", ",", " ", "\[CapitalOmega]", ",", " ", "t"}], "]"}]}],
    "\[IndentingNewLine]", 
   RowBox[{"TimeaPD2vec", " ", "=", " ", 
    RowBox[{"InverseFourierTransform", "[", 
     RowBox[{"aPD2vec", ",", " ", "\[CapitalOmega]", ",", " ", "t"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.805061234865275*^9, 
  3.8050614576552877`*^9}},ExpressionUUID->"3ad244e4-4d22-41dd-8ee8-\
d4ad44515f0f"],

Cell[BoxData[{
 RowBox[{"E1", " ", "=", " ", 
  RowBox[{"C0", " ", 
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}], "0"},
       {"0", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}
      }], ")"}], ".", "TimeaPD1vec"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"E2", " ", "=", " ", 
  RowBox[{"C0", " ", 
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}], "0"},
       {"0", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}
      }], ")"}], ".", "TimeaPD2vec"}]}]}]}], "Input",
 CellChangeTimes->{{3.805061524932918*^9, 
  3.8050616165157633`*^9}},ExpressionUUID->"cb2f7384-a0fc-431b-a3c6-\
4082243c4b47"],

Cell[TextData[{
 "working with quadratures in frequency domain, ignoring all propagation \
outside of the cavity \n",
 Cell[BoxData[
  RowBox[{
   StyleBox[
    SubscriptBox[
     OverscriptBox["a", "^"], 
     StyleBox["PD1",
      FontVariations->{"Underline"->False}]],
    FontVariations->{"Underline"->True}], " ", "=", " ", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["2", 
      RowBox[{"1", "/", "2"}]]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"P", "[", 
        FractionBox["\[Pi]", "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         StyleBox["A",
          FontVariations->{"Underline"->True}], " ", "+", " ", 
         StyleBox[
          OverscriptBox["a", "^"],
          FontVariations->{"Underline"->True}]}], ")"}]}], "+", 
      SubscriptBox[
       StyleBox[
        OverscriptBox["a", "^"],
        FontVariations->{"Underline"->True}], "refl"]}], ")"}]}]}]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"bc762a23-f884-40ab-bf82-9206952e3794"],
 "\n",
 Cell[BoxData[
  RowBox[{
   StyleBox[
    SubscriptBox[
     OverscriptBox["a", "^"], 
     StyleBox["PD2",
      FontVariations->{"Underline"->False}]],
    FontVariations->{"Underline"->True}], " ", "=", " ", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["2", 
      RowBox[{"1", "/", "2"}]]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"P", "[", 
        FractionBox["\[Pi]", "2"], "]"}], 
       SubscriptBox[
        StyleBox[
         OverscriptBox["a", "^"],
         FontVariations->{"Underline"->True}], "refl"]}], "-", 
      RowBox[{"(", 
       RowBox[{
        StyleBox["A",
         FontVariations->{"Underline"->True}], " ", "+", " ", 
        StyleBox[
         OverscriptBox["a", "^"],
         FontVariations->{"Underline"->True}]}], ")"}]}], ")"}]}]}]], "Input",
  
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"0635ba3f-c6c9-4943-bb5d-279227a96b45"],
 "\n",
 StyleBox["[equation a1]",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.804889603781643*^9, 3.8048896153457823`*^9}, {
   3.8048896684110613`*^9, 3.8048896693274803`*^9}, {3.804889715613905*^9, 
   3.8048899212189903`*^9}, {3.804891129312146*^9, 3.804891129975185*^9}, {
   3.80489311838515*^9, 3.804893121951481*^9}, 3.805061132867296*^9},
 FontSize->16,ExpressionUUID->"2cfa5f72-a603-4771-916e-b92160375c7d"],

Cell[TextData[{
 "to find ",
 Cell[BoxData[
  SubscriptBox[
   StyleBox[
    OverscriptBox["a", "^"],
    FontVariations->{"Underline"->True}], "refl"]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"3902b714-470d-4895-90a6-e7f9aef21c45"],
 " use solution for lossless mirrors cavity (ex2_3.nb), but add in squeezing \
midway through the cavity propagation (I assume that this placement doesn\
\[CloseCurlyQuote]t matter else it would have been given?)\n",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["a", "5"], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["R", "1"], "+", 
      RowBox[{
       SubscriptBox["T", "1"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Id", "-", 
          RowBox[{"P", " ", 
           SubscriptBox["R", "2"], " ", "P", " ", 
           SubscriptBox["R", "1"]}]}], ")"}], 
        RowBox[{"-", "1"}]], "P", " ", 
       SubscriptBox["R", "2"], " ", "P", " ", 
       SubscriptBox["T", "1"]}]}], ")"}], 
    SubscriptBox["a", "0"]}]}]], "Input",ExpressionUUID->
  "7961fdd4-7619-4aa7-9c39-66d4f256618f"],
 " \n",
 Cell[BoxData[
  RowBox[{
   StyleBox["\[Psi]",
    FontVariations->{"Underline"->False}], 
   StyleBox["=",
    FontVariations->{"Underline"->False}], 
   FractionBox[
    RowBox[{
     SubscriptBox["\[Omega]", "0"], " ", "\[Delta]l"}], "c"], " "}]], "Input",
  
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"b3848182-6b28-4538-8cc6-ad9705428f9b"],
 "\n",
 Cell[BoxData[
  RowBox[{"P", "\[LeftArrow]", " ", 
   RowBox[{
    RowBox[{"P", "[", 
     FractionBox["\[Psi]", "2"], "]"}], 
    RowBox[{
     SubscriptBox["S", "sqz"], "[", 
     RowBox[{"r", ",", "\[Phi]"}], "]"}], 
    RowBox[{"P", "[", 
     FractionBox["\[Psi]", "2"], "]"}]}]}]], "Input",ExpressionUUID->
  "1ef304cc-f1af-40f6-b5d8-c322919ca09f"],
 "\n",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["P", "2"], "\[LeftArrow]", " ", 
   RowBox[{
    RowBox[{"P", "[", 
     FractionBox["\[Psi]", "2"], "]"}], 
    RowBox[{
     SubscriptBox["S", "sqz"], "[", 
     RowBox[{"r", ",", "\[Phi]"}], "]"}], 
    RowBox[{"P", "[", "\[Psi]", "]"}], 
    RowBox[{
     SubscriptBox["S", "sqz"], "[", 
     RowBox[{"r", ",", "\[Phi]"}], "]"}], 
    RowBox[{"P", "[", 
     FractionBox["\[Psi]", "2"], "]"}]}]}]], "Input",ExpressionUUID->
  "b58745af-811e-45b4-9ecf-1d3c9cb2b3be"],
 "\n",
 Cell[BoxData[
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["T", "1"], ",", 
     SubscriptBox["R", "1"], ",", 
     SubscriptBox["T", "2"], ",", 
     SubscriptBox["R", "2"]}], "}"}], "\[LeftArrow]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["t", "1"], 
      RowBox[{"P", "[", 
       FractionBox["\[Pi]", "2"], "]"}]}], ",", " ", 
     SubscriptBox["r", "1"], ",", "0", ",", "1"}], "}"}]}]], "Input",
  ExpressionUUID->"9458b15d-3fe4-4d96-bb06-fbf610e43e16"],
 "\n",
 Cell[BoxData[{
  RowBox[{
   StyleBox[
    SubscriptBox[
     StyleBox[
      OverscriptBox["a", "^"],
      FontVariations->{"Underline"->True}], 
     StyleBox["refl",
      FontVariations->{"Underline"->False}]],
    FontVariations->{"Underline"->True}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["r", "1"], "+", 
      RowBox[{
       SubscriptBox["t", "1"], 
       RowBox[{"P", "[", 
        FractionBox["\[Pi]", "2"], "]"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Id", "-", 
          RowBox[{
           RowBox[{"P", "[", 
            FractionBox["\[Psi]", "2"], "]"}], 
           RowBox[{
            SubscriptBox["S", "sqz"], "[", 
            RowBox[{"r", ",", "\[Phi]"}], "]"}], 
           RowBox[{"P", "[", "\[Psi]", "]"}], 
           RowBox[{
            SubscriptBox["S", "sqz"], "[", 
            RowBox[{"r", ",", "\[Phi]"}], "]"}], 
           RowBox[{"P", "[", 
            FractionBox["\[Psi]", "2"], "]"}], " ", 
           SubscriptBox["r", "1"]}]}], ")"}], 
        RowBox[{"-", "1"}]], 
       RowBox[{"P", "[", 
        FractionBox["\[Psi]", "2"], "]"}], 
       RowBox[{
        SubscriptBox["S", "sqz"], "[", 
        RowBox[{"r", ",", "\[Phi]"}], "]"}], 
       RowBox[{"P", "[", "\[Psi]", "]"}], 
       RowBox[{
        SubscriptBox["S", "sqz"], "[", 
        RowBox[{"r", ",", "\[Phi]"}], "]"}], 
       RowBox[{"P", "[", 
        FractionBox["\[Psi]", "2"], "]"}], " ", 
       SubscriptBox["t", "1"], 
       RowBox[{"P", "[", 
        FractionBox["\[Pi]", "2"], "]"}]}]}], ")"}], 
    StyleBox[
     OverscriptBox["n", "^"],
     FontVariations->{"Underline"->True}]}]}], "\[IndentingNewLine]", 
  RowBox[{"=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["r", "1"], "+", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["t", "1"], "2"], 
       RowBox[{"P", "[", 
        FractionBox["\[Pi]", "2"], "]"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Id", "-", 
          RowBox[{
           SubscriptBox["r", "1"], 
           RowBox[{"P", "[", 
            FractionBox["\[Psi]", "2"], "]"}], 
           RowBox[{
            SubscriptBox["S", "sqz"], "[", 
            RowBox[{"r", ",", "\[Phi]"}], "]"}], 
           RowBox[{"P", "[", "\[Psi]", "]"}], 
           RowBox[{
            SubscriptBox["S", "sqz"], "[", 
            RowBox[{"r", ",", "\[Phi]"}], "]"}], 
           RowBox[{"P", "[", 
            FractionBox["\[Psi]", "2"], "]"}]}]}], " ", ")"}], 
        RowBox[{"-", "1"}]], 
       RowBox[{"P", "[", 
        FractionBox["\[Psi]", "2"], "]"}], 
       RowBox[{
        SubscriptBox["S", "sqz"], "[", 
        RowBox[{"r", ",", "\[Phi]"}], "]"}], 
       RowBox[{"P", "[", "\[Psi]", "]"}], 
       RowBox[{
        SubscriptBox["S", "sqz"], "[", 
        RowBox[{"r", ",", "\[Phi]"}], "]"}], 
       RowBox[{"P", "[", 
        FractionBox[
         RowBox[{"\[Psi]", "+", "\[Pi]"}], "2"], "]"}]}]}], ")"}], 
    StyleBox[
     OverscriptBox["n", "^"],
     FontVariations->{"Underline"->True}]}]}]}], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"6097050b-fcf0-42a3-b198-306dd1bc8f80"],
 "\n",
 StyleBox["[equation a2]",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.8048905953363447`*^9, 3.804890858998645*^9}, {
   3.804890889525486*^9, 3.8048910857531*^9}, {3.804891135053113*^9, 
   3.8048911562858477`*^9}, {3.80489118719943*^9, 3.804891257784699*^9}, {
   3.8048913671892157`*^9, 3.804891454809136*^9}, {3.8048916071216497`*^9, 
   3.8048916351675*^9}, {3.804893139168474*^9, 3.8048931404863377`*^9}, 
   3.804893394513235*^9, 
   3.8050611344376373`*^9},ExpressionUUID->"7897e3d3-efca-4dd5-b929-\
b091e7b733b3"],

Cell[TextData[{
 "now putting it all together, this will get rather messy \n",
 Cell[BoxData[
  RowBox[{
   StyleBox[
    SubscriptBox[
     OverscriptBox["a", "^"], 
     StyleBox["PD1",
      FontVariations->{"Underline"->False}]],
    FontVariations->{"Underline"->True}], " ", "=", " ", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["2", 
      RowBox[{"1", "/", "2"}]]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"P", "[", 
        FractionBox["\[Pi]", "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         StyleBox["A",
          FontVariations->{"Underline"->True}], " ", "+", " ", 
         StyleBox[
          OverscriptBox["a", "^"],
          FontVariations->{"Underline"->True}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["r", "1"], "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["t", "1"], "2"], 
          RowBox[{"P", "[", 
           FractionBox["\[Pi]", "2"], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Id", "-", 
             RowBox[{
              SubscriptBox["r", "1"], 
              RowBox[{"P", "[", 
               FractionBox["\[Psi]", "2"], "]"}], 
              RowBox[{
               SubscriptBox["S", "sqz"], "[", 
               RowBox[{"r", ",", "\[Phi]"}], "]"}], 
              RowBox[{"P", "[", "\[Psi]", "]"}], 
              RowBox[{
               SubscriptBox["S", "sqz"], "[", 
               RowBox[{"r", ",", "\[Phi]"}], "]"}], 
              RowBox[{"P", "[", 
               FractionBox["\[Psi]", "2"], "]"}]}]}], " ", ")"}], 
           RowBox[{"-", "1"}]], 
          RowBox[{"P", "[", 
           FractionBox["\[Psi]", "2"], "]"}], 
          RowBox[{
           SubscriptBox["S", "sqz"], "[", 
           RowBox[{"r", ",", "\[Phi]"}], "]"}], 
          RowBox[{"P", "[", "\[Psi]", "]"}], 
          RowBox[{
           SubscriptBox["S", "sqz"], "[", 
           RowBox[{"r", ",", "\[Phi]"}], "]"}], 
          RowBox[{"P", "[", 
           FractionBox[
            RowBox[{"\[Psi]", "+", "\[Pi]"}], "2"], "]"}]}]}], ")"}], 
       StyleBox[
        OverscriptBox["n", "^"],
        FontVariations->{"Underline"->True}]}]}], ")"}]}]}]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"adf7fc60-97e4-42c8-a180-b10793b2dbe7"],
 "\n",
 Cell[BoxData[
  RowBox[{
   StyleBox[
    SubscriptBox[
     OverscriptBox["a", "^"], 
     StyleBox["PD2",
      FontVariations->{"Underline"->False}]],
    FontVariations->{"Underline"->True}], " ", "=", " ", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["2", 
      RowBox[{"1", "/", "2"}]]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"P", "[", 
        FractionBox["\[Pi]", "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["r", "1"], "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["t", "1"], "2"], 
          RowBox[{"P", "[", 
           FractionBox["\[Pi]", "2"], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Id", "-", 
             RowBox[{
              SubscriptBox["r", "1"], 
              RowBox[{"P", "[", 
               FractionBox["\[Psi]", "2"], "]"}], 
              RowBox[{
               SubscriptBox["S", "sqz"], "[", 
               RowBox[{"r", ",", "\[Phi]"}], "]"}], 
              RowBox[{"P", "[", "\[Psi]", "]"}], 
              RowBox[{
               SubscriptBox["S", "sqz"], "[", 
               RowBox[{"r", ",", "\[Phi]"}], "]"}], 
              RowBox[{"P", "[", 
               FractionBox["\[Psi]", "2"], "]"}]}]}], " ", ")"}], 
           RowBox[{"-", "1"}]], 
          RowBox[{"P", "[", 
           FractionBox["\[Psi]", "2"], "]"}], 
          RowBox[{
           SubscriptBox["S", "sqz"], "[", 
           RowBox[{"r", ",", "\[Phi]"}], "]"}], 
          RowBox[{"P", "[", "\[Psi]", "]"}], 
          RowBox[{
           SubscriptBox["S", "sqz"], "[", 
           RowBox[{"r", ",", "\[Phi]"}], "]"}], 
          RowBox[{"P", "[", 
           FractionBox[
            RowBox[{"\[Psi]", "+", "\[Pi]"}], "2"], "]"}]}]}], ")"}], 
       StyleBox[
        OverscriptBox["n", "^"],
        FontVariations->{"Underline"->True}]}], "-", 
      RowBox[{"(", 
       RowBox[{
        StyleBox["A",
         FontVariations->{"Underline"->True}], " ", "+", " ", 
        StyleBox[
         OverscriptBox["a", "^"],
         FontVariations->{"Underline"->True}]}], ")"}]}], ")"}]}]}]], "Input",
  
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"3a9beac0-808d-44e6-bdd2-826aaae5f78c"],
 "\n",
 StyleBox["[equation a3]",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.8048912960776176`*^9, 3.8048913457827272`*^9}, 
   3.804891495418591*^9, {3.8048931460377502`*^9, 3.8048931472716093`*^9}, {
   3.805061135868678*^9, 
   3.805061137804186*^9}},ExpressionUUID->"519e97e0-41db-48d1-8d85-\
2d4e3db59a5c"]
},
WindowSize->{601, 320},
WindowMargins->{{7, Automatic}, {Automatic, 36}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5013, 154, 431, "Input",ExpressionUUID->"60b81c7e-a887-44a9-b376-43b41f52008d"],
Cell[5574, 176, 4394, 109, 370, "Input",ExpressionUUID->"119ecdc3-6fa1-4c2a-afc0-afebfd72aaf8"],
Cell[9971, 287, 1181, 28, 75, "Input",ExpressionUUID->"2c2c02e4-da7e-4d1a-afcc-29cc0ae90914"],
Cell[11155, 317, 26673, 784, 1414, "Text",ExpressionUUID->"400161cc-835d-4015-8163-4d30c1a0797b"],
Cell[CellGroupData[{
Cell[37853, 1105, 939, 21, 53, "Input",ExpressionUUID->"538a57be-ccd9-4342-af09-0d8258f20fce"],
Cell[38795, 1128, 17172, 439, 614, "Output",ExpressionUUID->"80eb186d-6b28-463a-bc0b-f4cd5834b7bb"]
}, Open  ]],
Cell[55982, 1570, 3908, 119, 150, "Input",ExpressionUUID->"a577ebcd-04f6-49b8-b579-2c11c0442b23"],
Cell[CellGroupData[{
Cell[59915, 1693, 2650, 71, 140, "Input",ExpressionUUID->"c6ef84fd-f5e0-4a24-aceb-de1d43bea371"],
Cell[62568, 1766, 8764, 222, 279, "Output",ExpressionUUID->"6e312a55-a550-4717-9a10-581e461223f1"]
}, Open  ]],
Cell[71347, 1991, 8134, 223, 388, "Input",ExpressionUUID->"eb69f030-4f96-4769-94b8-3d3310292795"],
Cell[79484, 2216, 16437, 455, 817, "Text",ExpressionUUID->"8d1e2bf2-1502-48c5-bdca-c43e07e3d292"],
Cell[CellGroupData[{
Cell[95946, 2675, 2365, 57, 172, "Input",ExpressionUUID->"3214cef3-b260-49f1-8a81-1f09bf82b900"],
Cell[98314, 2734, 16197, 425, 571, "Output",ExpressionUUID->"2e3ae144-c508-466f-9be4-c07032c8650c"]
}, Open  ]],
Cell[114526, 3162, 232, 5, 75, "Input",ExpressionUUID->"74ba13db-35a6-44fd-9c49-6139bae4e1d7"],
Cell[114761, 3169, 5439, 157, 407, "Input",ExpressionUUID->"8b9915ce-6217-49bf-b8f8-0018d531014b"],
Cell[120203, 3328, 455, 9, 85, "Input",ExpressionUUID->"9147f3c4-413a-4fee-a951-99260bb89c5b"],
Cell[120661, 3339, 10369, 292, 301, "Text",ExpressionUUID->"1f7002e5-0233-4495-9936-3c530f1e918d"],
Cell[131033, 3633, 331, 8, 32, "Input",ExpressionUUID->"0a4f665c-38af-4293-9be3-ec46336b299e"],
Cell[131367, 3643, 1098, 26, 97, "Input",ExpressionUUID->"3ad244e4-4d22-41dd-8ee8-d4ad44515f0f"],
Cell[132468, 3671, 913, 29, 90, "Input",ExpressionUUID->"cb2f7384-a0fc-431b-a3c6-4082243c4b47"],
Cell[133384, 3702, 2440, 73, 114, "Text",ExpressionUUID->"2cfa5f72-a603-4771-916e-b92160375c7d"],
Cell[135827, 3777, 6663, 199, 295, "Text",ExpressionUUID->"7897e3d3-efca-4dd5-b929-b091e7b733b3"],
Cell[142493, 3978, 4978, 145, 275, "Text",ExpressionUUID->"519e97e0-41db-48d1-8d85-2d4e3db59a5c"]
}
]
*)

