(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     54908,       1589]
NotebookOptionsPosition[     52204,       1549]
NotebookOutlinePosition[     52536,       1564]
CellTagsIndexPosition[     52493,       1561]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Id", " ", "=", " ", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.805059682875463*^9, 3.805059695083764*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"e750f619-bab7-4975-a712-0525a363b361"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "switching", " ", "mirror", " ", "convention", " ", "to", " ", "nothing", 
     " ", "on", " ", "transmission", " ", "and"}], " ", "-", 
    RowBox[{"1", " ", "on", " ", "\"\<antireflection\>\""}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "R1", ",", " ", "aR1", ",", " ", "T1", ",", " ", "R2", ",", "aR2", ",", 
      "T2", ",", " ", "RBS", ",", " ", "aRBS", ",", " ", "TBS"}], "}"}], " ", 
    "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r1", " ", "Id"}], ",", " ", 
      RowBox[{
       RowBox[{"-", "r1"}], " ", "Id"}], ",", " ", 
      RowBox[{"t1", " ", "Id"}], ",", " ", "Id", ",", 
      RowBox[{"-", "Id"}], ",", 
      RowBox[{"0", " ", "Id"}], ",", " ", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "2"}]]], "Id"}], ",", " ", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", 
         SuperscriptBox["2", 
          RowBox[{"1", "/", "2"}]]]}], "Id"}], ",", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "2"}]]], "Id"}]}], " ", "}"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.805059665014617*^9, 3.805059898858186*^9}, {
  3.8050609173876333`*^9, 3.805060917987812*^9}, {3.805061089308898*^9, 
  3.8050610931540813`*^9}, {3.805420259019217*^9, 3.805420259801017*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"5b7f4ab0-a467-47df-a5b7-c5ef785fe4a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "rotation", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"P", "[", "\[Phi]_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", "\[Phi]", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]},
      {
       RowBox[{"Sin", "[", "\[Phi]", "]"}], 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}
     }], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.805058961514761*^9, 3.805058985040908*^9}, {
  3.8054202988990297`*^9, 3.8054203001570168`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"52698886-efb2-4c81-b71a-d0c29ac8721b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "propagation", " ", "across", " ", "a", " ", "space", " ", "of", " ", 
     "length", " ", "D"}], " ", "=", " ", 
    RowBox[{"L", " ", "+", " ", "\[Delta]l"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SpacePropa", "[", 
    RowBox[{"L_", ",", "\[Delta]l_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"\[ImaginaryI]", " ", 
      FractionBox["\[CapitalOmega]", "c"], 
      RowBox[{"(", 
       RowBox[{"L", "+", "\[Delta]l"}], ")"}]}], "]"}], 
    RowBox[{"P", "[", 
     FractionBox[
      RowBox[{
       SubscriptBox["\[Omega]", "0"], " ", "\[Delta]l"}], "c"], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.80505833297589*^9, 3.805058424492385*^9}, {
  3.8050586175338163`*^9, 3.805058735341866*^9}, {3.8050589913543453`*^9, 
  3.8050590564442453`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"8c4da768-0ed9-4397-b783-34a496e02a75"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "squeezer", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SSqz", "[", 
    RowBox[{"r_", ",", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Phi]"}], "]"}], 
         RowBox[{"Sinh", "[", "r", "]"}]}], "+", 
        RowBox[{"Cosh", "[", "r", "]"}]}], 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}], 
        RowBox[{"Sinh", "[", "r", "]"}]}]},
      {
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}], 
        RowBox[{"Sinh", "[", "r", "]"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Phi]"}], "]"}]}], 
         RowBox[{"Sinh", "[", "r", "]"}]}], "+", 
        RowBox[{"Cosh", "[", "r", "]"}]}]}
     }], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.805058795544437*^9, 3.80505890650616*^9}, {
  3.8050590910126467`*^9, 3.805059095606839*^9}, {3.805420321443022*^9, 
  3.8054203228969584`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"2bc0b8d1-7691-4bb6-8931-d1656dfce9a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nvec", ",", " ", "avec", ",", " ", "Avec"}], "}"}], " ", "=", 
   " ", 
   RowBox[{"{", 
    RowBox[{GridBox[{
       {
        SubscriptBox["n", "1"]},
       {
        SubscriptBox["n", "2"]}
      }], ",", GridBox[{
       {
        SubscriptBox["a", "1"]},
       {
        SubscriptBox["a", "2"]}
      }], ",", GridBox[{
       {
        RowBox[{"A", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "0"], "]"}]}]},
       {
        RowBox[{"A", " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "0"], "]"}]}]}
      }]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.805059198503738*^9, 3.805059260352283*^9}, 
   3.805060930284761*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"4e16faba-bf94-4212-91ba-5506853a184a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "squeezing", " ", "midway", " ", "through", " ", "the", " ", "cavity"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"cavP", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"SpacePropa", "[", 
      RowBox[{
       FractionBox["L", "2"], ",", 
       FractionBox["\[Delta]l", "2"]}], "]"}], ".", 
     RowBox[{"SSqz", "[", 
      RowBox[{"r", ",", "\[Phi]"}], "]"}], ".", 
     RowBox[{"SpacePropa", "[", 
      RowBox[{
       FractionBox["L", "2"], ",", 
       FractionBox["\[Delta]l", "2"]}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.805060128891158*^9, 3.805060298691812*^9}, {
  3.805060331943843*^9, 3.80506034683337*^9}, {3.805060422252404*^9, 
  3.80506042292859*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"d7c506a0-f76f-4dda-b9d6-949ecafb9d65"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"L", "+", "\[Delta]l"}], ")"}], " ", "\[CapitalOmega]"}], 
        "c"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"\[Delta]l", " ", 
            SubscriptBox["\[Omega]", "0"]}], "c"], "]"}], " ", 
         RowBox[{"Cosh", "[", "r", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
         RowBox[{"Sinh", "[", "r", "]"}]}]}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"L", "+", "\[Delta]l"}], ")"}], " ", "\[CapitalOmega]"}], 
        "c"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}], "-", 
        RowBox[{
         RowBox[{"Coth", "[", "r", "]"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"\[Delta]l", " ", 
            SubscriptBox["\[Omega]", "0"]}], "c"], "]"}]}]}], ")"}], " ", 
      RowBox[{"Sinh", "[", "r", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"L", "+", "\[Delta]l"}], ")"}], " ", "\[CapitalOmega]"}], 
        "c"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"Coth", "[", "r", "]"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"\[Delta]l", " ", 
            SubscriptBox["\[Omega]", "0"]}], "c"], "]"}]}]}], ")"}], " ", 
      RowBox[{"Sinh", "[", "r", "]"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"L", "+", "\[Delta]l"}], ")"}], " ", "\[CapitalOmega]"}], 
        "c"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"\[Delta]l", " ", 
            SubscriptBox["\[Omega]", "0"]}], "c"], "]"}], " ", 
         RowBox[{"Cosh", "[", "r", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
         RowBox[{"Sinh", "[", "r", "]"}]}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.805060300200761*^9, 3.8050603363961363`*^9, 
  3.8050604289505587`*^9, 3.805060933800065*^9, 3.8050615015006866`*^9, 
  3.805420717863348*^9, 3.805422995411441*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"c6230770-a880-475e-a111-ca8e32bfe261"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "calculating", " ", "the", " ", "reflected", " ", "field", " ", "by", " ",
      "borrowing", " ", "the", " ", "empty", " ", "cavity", " ", 
     RowBox[{"solution", ":", "\[IndentingNewLine]", 
      SubscriptBox["a", "5"]}]}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["R", "1"], "+", 
       RowBox[{
        SubscriptBox["T", "1"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Id", "-", 
           RowBox[{"P", " ", 
            SubscriptBox["R", "2"], " ", "P", " ", 
            SubscriptBox["R", "1"]}]}], ")"}], 
         RowBox[{"-", "1"}]], "P", " ", 
        SubscriptBox["R", "2"], " ", "P", " ", 
        SubscriptBox["T", "1"]}]}], ")"}], 
     SubscriptBox["a", "0"]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"cavMatrix", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"aR1", "+", 
        RowBox[{"T1", ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{"Id", " ", "-", " ", 
           RowBox[{"cavP", ".", "R2", ".", "cavP", ".", "R1"}]}], "]"}], ".", 
         "cavP", ".", "R2", ".", "cavP", ".", "T1"}]}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"\[Delta]l", " ", 
           SubscriptBox["\[Omega]", "0"]}], "c"], "\[Rule]", " ", "\[Psi]"}], 
        ",", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "+", "\[Delta]l"}], ")"}], " ", "\[CapitalOmega]"}], 
          "c"], "->", 
         FractionBox[
          RowBox[{" ", 
           RowBox[{"L", " ", "\[CapitalOmega]"}]}], "c"]}]}], "}"}]}], 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.805060349494413*^9, 3.8050604603106318`*^9}, {
   3.80506057597893*^9, 3.805060626419115*^9}, 3.8050608741998*^9, {
   3.8050609680671453`*^9, 3.805060968605934*^9}, 3.8054227568794937`*^9, {
   3.8054228642531557`*^9, 3.805422873497765*^9}, {3.805422941389436*^9, 
   3.8054229428453293`*^9}, {3.8054229997411547`*^9, 3.805423014434753*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"119ecdc3-6fa1-4c2a-afc0-afebfd72aaf8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"areflvec", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"cavMatrix", ".", "nvec"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"d6d10b05-82f8-4ce2-9f74-65e8d8e83dd1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"at", " ", "beam", " ", "splitter"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"aPD1vec", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"TBS", ".", 
        RowBox[{"(", 
         RowBox[{"Avec", "+", "avec"}], ")"}]}], "+", 
       RowBox[{"RBS", ".", "areflvec"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"aPD2vec", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"aRBS", ".", 
        RowBox[{"(", 
         RowBox[{"Avec", "+", "avec"}], ")"}]}], "+", 
       RowBox[{"TBS", ".", "areflvec"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.805059943525661*^9, 3.805060036266486*^9}, {
  3.80506008958035*^9, 3.805060106855197*^9}, {3.805060673065486*^9, 
  3.8050606846041193`*^9}, {3.8050608553255873`*^9, 3.8050608564043827`*^9}, {
  3.805422772773703*^9, 3.8054227731621943`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"2c2c02e4-da7e-4d1a-afcc-29cc0ae90914"],

Cell[TextData[{
 "homodyne readout takes the difference between the two photo-currents, each \
of which is proportional to the time average of the intensity of the field, \
due to the slow response of the PD\[CloseCurlyQuote]s\n",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["i", "hom"], "=", 
   RowBox[{
    SubscriptBox["i", "1"], "-", 
    SubscriptBox["i", "2"]}]}]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"7ad8db3c-e813-4a29-8ef8-8713d066ba4e"],
 "\n",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["i", "1"], "\[Proportional]", "<", 
   SuperscriptBox[
    RowBox[{"\[LeftBracketingBar]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["E", "^"], "PD1"], "[", "t", "]"}], 
     "\[RightBracketingBar]"}], "2"], ">"}]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"09c05eab-8541-4590-abbf-814ad2e80a1b"],
 "\nto find the intensity, we need the time domain signal, so let  ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox[
      StyleBox[
       OverscriptBox[
        StyleBox["a",
         FontVariations->{"Underline"->False}], "~"],
       FontVariations->{"Underline"->False}], "^"], 
     StyleBox[
      RowBox[{"PD1", ",", "c"}],
      FontVariations->{"Underline"->False}]], "[", "t", "]"}], " ", "=", " ", 
   
   RowBox[{"InverseFourierTransform", "[", 
    RowBox[{
     StyleBox[
      SubscriptBox[
       OverscriptBox[
        StyleBox["a",
         FontVariations->{"Underline"->False}], "^"], 
       StyleBox[
        RowBox[{"PD1", ",", "c"}],
        FontVariations->{"Underline"->False}]],
      FontVariations->{"Underline"->True}], 
     StyleBox["[",
      FontVariations->{"Underline"->True}], 
     StyleBox["\[CapitalOmega]",
      FontVariations->{"Underline"->False}], 
     StyleBox["]",
      FontVariations->{"Underline"->True}]}], "]"}]}]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"83743228-b5a6-441e-8f6e-073df6edb75c"],
 "\n",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["E", "^"], "PD1"], "[", "t", "]"}], "=", " ", 
   RowBox[{
    SubscriptBox["C", "0"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox[
          StyleBox[
           OverscriptBox[
            StyleBox["a",
             FontVariations->{"Underline"->False}], "~"],
           FontVariations->{"Underline"->False}], "^"], 
         StyleBox[
          RowBox[{"PD1", ",", "c"}],
          FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox[
          StyleBox[
           OverscriptBox[
            StyleBox["a",
             FontVariations->{"Underline"->False}], "~"],
           FontVariations->{"Underline"->False}], "^"], 
         StyleBox[
          RowBox[{"PD1", ",", "s"}],
          FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], ")"}]}]}]], "Input",
  
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"2112da42-27f5-40ef-b50d-26318dab3b88"],
 "\n",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["i", "1"], "\[Proportional]", 
   SuperscriptBox[
    SubscriptBox["C", "0"], "2"], "<", 
   SuperscriptBox[
    RowBox[{"\[LeftBracketingBar]", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox[
          StyleBox[
           OverscriptBox[
            StyleBox["a",
             FontVariations->{"Underline"->False}], "~"],
           FontVariations->{"Underline"->False}], "^"], 
         StyleBox[
          RowBox[{"PD1", ",", "c"}],
          FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox[
          StyleBox[
           OverscriptBox[
            StyleBox["a",
             FontVariations->{"Underline"->False}], "~"],
           FontVariations->{"Underline"->False}], "^"], 
         StyleBox[
          RowBox[{"PD1", ",", "s"}],
          FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], 
     "\[RightBracketingBar]"}], "2"], ">"}]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"e45792b5-c717-424b-8661-56f31483acc3"],
 "\nand similarly for ",
 Cell[BoxData[
  SubscriptBox["i", "2"]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"4aae7d26-ef44-43d1-ba1b-cbdaefd04729"],
 "\n",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["i", "2"], "\[Proportional]", 
   SuperscriptBox[
    SubscriptBox["C", "0"], "2"], "<", 
   SuperscriptBox[
    RowBox[{"\[LeftBracketingBar]", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox[
          StyleBox[
           OverscriptBox[
            StyleBox["a",
             FontVariations->{"Underline"->False}], "~"],
           FontVariations->{"Underline"->False}], "^"], 
         StyleBox[
          RowBox[{"PD2", ",", "c"}],
          FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox[
          StyleBox[
           OverscriptBox[
            StyleBox["a",
             FontVariations->{"Underline"->False}], "~"],
           FontVariations->{"Underline"->False}], "^"], 
         StyleBox[
          RowBox[{"PD2", ",", "s"}],
          FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], 
     "\[RightBracketingBar]"}], "2"], ">"}]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"1f59970c-42a4-42b3-9427-2bf4db009bb6"],
 "\n",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["i", "hom"], "\[Proportional]", 
   SuperscriptBox[
    SubscriptBox["C", "0"], "2"], "<", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[LeftBracketingBar]", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           StyleBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "~"],
            FontVariations->{"Underline"->False}], "^"], 
          StyleBox[
           RowBox[{"PD1", ",", "c"}],
           FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           StyleBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "~"],
            FontVariations->{"Underline"->False}], "^"], 
          StyleBox[
           RowBox[{"PD1", ",", "s"}],
           FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], 
      "\[RightBracketingBar]"}], "2"], "-", 
    SuperscriptBox[
     RowBox[{"\[LeftBracketingBar]", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           StyleBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "~"],
            FontVariations->{"Underline"->False}], "^"], 
          StyleBox[
           RowBox[{"PD2", ",", "c"}],
           FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           StyleBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "~"],
            FontVariations->{"Underline"->False}], "^"], 
          StyleBox[
           RowBox[{"PD2", ",", "s"}],
           FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], 
      "\[RightBracketingBar]"}], "2"]}], ">"}]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"ec90f493-a521-4545-ad51-da215ff7eeb0"],
 "\n",
 StyleBox["[equation b1]",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.804891498835876*^9, 3.804891570660561*^9}, {
  3.8048916576833487`*^9, 3.8048916600553293`*^9}, {3.8048919160022583`*^9, 
  3.804892179379951*^9}, {3.804892224471863*^9, 3.8048922491941433`*^9}, {
  3.8048924473379602`*^9, 3.804892615018312*^9}, {3.8048926461851273`*^9, 
  3.804892724455352*^9}, {3.804892764003929*^9, 3.8048927745626307`*^9}, {
  3.8048928643459177`*^9, 3.804892994196513*^9}, {3.804893155906494*^9, 
  3.804893157126227*^9}, {3.804893309870536*^9, 3.804893355910508*^9}, {
  3.805061037061695*^9, 3.8050610571331053`*^9}, {3.805061125395212*^9, 
  3.805061127335663*^9}},ExpressionUUID->"9ea16179-5577-47fa-90fc-\
875f0ff5a8d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "we", " ", "need", " ", "to", " ", "take", " ", "Fourier", " ", 
     "transform", " ", "of", " ", "the", " ", "above", " ", "expressions"}], 
    ",", " ", 
    RowBox[{"but", " ", "Mathematica", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "know", " ", "that", " ", "the", " ", 
     "quadratures", " ", "depend", " ", "on", " ", "frequency"}], ",", " ", 
    RowBox[{"i", ".", "e", ".", " ", 
     RowBox[{
      SubscriptBox["a", "1"], "[", "\[CapitalOmega]", "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TimeaPD1vec", " ", "=", " ", 
    RowBox[{"InverseFourierTransform", "[", 
     RowBox[{"aPD1vec", ",", " ", "\[CapitalOmega]", ",", " ", "t"}], "]"}]}],
    "\[IndentingNewLine]", 
   RowBox[{"TimeaPD2vec", " ", "=", " ", 
    RowBox[{"InverseFourierTransform", "[", 
     RowBox[{"aPD2vec", ",", " ", "\[CapitalOmega]", ",", " ", "t"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.805061234865275*^9, 
  3.8050614576552877`*^9}},ExpressionUUID->"3ad244e4-4d22-41dd-8ee8-\
d4ad44515f0f"],

Cell[BoxData[{
 RowBox[{"E1", " ", "=", " ", 
  RowBox[{"C0", " ", 
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}], "0"},
       {"0", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}
      }], ")"}], ".", "TimeaPD1vec"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"E2", " ", "=", " ", 
  RowBox[{"C0", " ", 
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}], "0"},
       {"0", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}
      }], ")"}], ".", "TimeaPD2vec"}]}]}]}], "Input",
 CellChangeTimes->{{3.805061524932918*^9, 
  3.8050616165157633`*^9}},ExpressionUUID->"cb2f7384-a0fc-431b-a3c6-\
4082243c4b47"],

Cell[BoxData[
 RowBox[{"iHomIsPropTo", " ", "=", " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Abs", "[", "E1", "]"}], "2"], "-", 
   SuperscriptBox[
    RowBox[{"Abs", "[", "E2", "]"}], "2"]}]}]], "Input",
 CellChangeTimes->{{3.805061627660615*^9, 
  3.8050616596074*^9}},ExpressionUUID->"0a4f665c-38af-4293-9be3-ec46336b299e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "assume", " ", "time", " ", "domain", " ", "quadratures", " ", "are", " ", 
    "Hermitian"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SuperscriptBox[
    SubscriptBox["C", "0"], "2"], 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{
        SubscriptBox[
         OverscriptBox[
          StyleBox[
           OverscriptBox[
            StyleBox["a",
             FontVariations->{"Underline"->False}], "~"],
           FontVariations->{"Underline"->False}], "^"], 
         StyleBox[
          RowBox[{"PD1", ",", "c"}],
          FontVariations->{"Underline"->False}]], "[", "t", "]"}], "2"], 
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Omega]", "0"], "t"}], "]"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{
        SubscriptBox[
         OverscriptBox[
          StyleBox[
           OverscriptBox[
            StyleBox["a",
             FontVariations->{"Underline"->False}], "~"],
           FontVariations->{"Underline"->False}], "^"], 
         StyleBox[
          RowBox[{"PD1", ",", "s"}],
          FontVariations->{"Underline"->False}]], "[", "t", "]"}], "2"], 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["\[Omega]", "0"], "t"}], "]"}], 
       RowBox[{"2", " "}]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox[
           OverscriptBox[
            StyleBox[
             OverscriptBox[
              StyleBox["a",
               FontVariations->{"Underline"->False}], "~"],
             FontVariations->{"Underline"->False}], "^"], 
           StyleBox[
            RowBox[{"PD1", ",", "c"}],
            FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
         RowBox[{
          SubscriptBox[
           OverscriptBox[
            StyleBox[
             OverscriptBox[
              StyleBox["a",
               FontVariations->{"Underline"->False}], "~"],
             FontVariations->{"Underline"->False}], "^"], 
           StyleBox[
            RowBox[{"PD1", ",", "s"}],
            FontVariations->{"Underline"->False}]], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{
          SubscriptBox[
           OverscriptBox[
            StyleBox[
             OverscriptBox[
              StyleBox["a",
               FontVariations->{"Underline"->False}], "~"],
             FontVariations->{"Underline"->False}], "^"], 
           StyleBox[
            RowBox[{"PD1", ",", "s"}],
            FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
         RowBox[{
          SubscriptBox[
           OverscriptBox[
            StyleBox[
             OverscriptBox[
              StyleBox["a",
               FontVariations->{"Underline"->False}], "~"],
             FontVariations->{"Underline"->False}], "^"], 
           StyleBox[
            RowBox[{"PD1", ",", "c"}],
            FontVariations->{"Underline"->False}]], "[", "t", "]"}]}]}], 
       ")"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Omega]", "0"], "t"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], 
    "\[RightAngleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.8054239756967916`*^9, 3.805424026077997*^9}, {
  3.8054243258665133`*^9, 
  3.8054243358613253`*^9}},ExpressionUUID->"8fed679d-b33b-4614-a098-\
702ef742e981"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"applying", " ", "time", " ", "averaging"}], ",", " ", 
    RowBox[{
    "assume", " ", "quadratures", " ", "are", " ", "slowly", " ", 
     "changing"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   FractionBox[
    SuperscriptBox[
     SubscriptBox["C", "0"], "2"], "2"], 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{
       SubscriptBox[
        OverscriptBox[
         StyleBox[
          OverscriptBox[
           StyleBox["a",
            FontVariations->{"Underline"->False}], "~"],
          FontVariations->{"Underline"->False}], "^"], 
        StyleBox[
         RowBox[{"PD1", ",", "c"}],
         FontVariations->{"Underline"->False}]], "[", "t", "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{
       SubscriptBox[
        OverscriptBox[
         StyleBox[
          OverscriptBox[
           StyleBox["a",
            FontVariations->{"Underline"->False}], "~"],
          FontVariations->{"Underline"->False}], "^"], 
        StyleBox[
         RowBox[{"PD1", ",", "s"}],
         FontVariations->{"Underline"->False}]], "[", "t", "]"}], "2"]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.805424134938807*^9, 3.8054241595559597`*^9}, {
  3.805424338357675*^9, 
  3.805424360049065*^9}},ExpressionUUID->"6f92440e-abd9-4b33-9e46-\
3fb945db3c47"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "apply", " ", "forwards", " ", "Fourier", " ", "transform", " ", "and", " ",
    "compute", " ", "PSD", " ", "of", " ", "intensity"}], "*)"}]], "Input",
 CellChangeTimes->{{3.805424562119994*^9, 
  3.805424577296548*^9}},ExpressionUUID->"538a5b15-5f97-4805-83c3-\
5fd4c507139d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "split", " ", "time", " ", "signal", " ", "into", " ", "average", " ", 
    "and", " ", "time", " ", "varying", " ", "part"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "ends", " ", "up", " ", "being", " ", "that", " ", "we", " ", "just", " ", 
    "use", " ", "the", " ", "same", " ", "splitting", " ", "as", " ", 
    "before"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.805425327335909*^9, 3.805425353277169*^9}, {
  3.80542606670446*^9, 
  3.805426077824092*^9}},ExpressionUUID->"eedcabdb-77d3-4faf-9193-\
b954071d299c"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.805060842492217*^9, 3.805060846918736*^9}, {
   3.805061006440815*^9, 3.805061019188298*^9}, 3.80542278942456*^9, {
   3.8054246143657017`*^9, 3.8054246148115387`*^9}, 3.805424839823762*^9, 
   3.805424997017599*^9},ExpressionUUID->"1768d3fd-7163-4acc-8273-\
90750e5af89c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["S", "I"], "[", "\[CapitalOmega]", "]"}], " ", "2", "\[Pi]",
     " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"\[CapitalOmega]", "-", 
      RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], " ", "=", " ", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"0", "|", 
      RowBox[{
       RowBox[{
        RowBox[{
         OverscriptBox["I", "^"], "[", "\[CapitalOmega]", "]"}], 
        RowBox[{
         RowBox[{
          OverscriptBox["I", "^"], "\[ConjugateTranspose]"}], "[", 
         RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{
          OverscriptBox["I", "^"], "\[ConjugateTranspose]"}], "[", 
         RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
        RowBox[{
         OverscriptBox["I", "^"], "[", "\[CapitalOmega]", "]"}]}]}], "|", 
      "0"}], "\[RightAngleBracket]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.8054234795198927`*^9, 
  3.805423480739937*^9}},ExpressionUUID->"695ca54b-7af7-4c31-8beb-\
113539016b51"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"sanity", " ", "checks"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"areflvec", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"\[Delta]l", " ", 
             SubscriptBox["\[Omega]", "0"]}], "c"], "\[Rule]", " ", 
           "\[Psi]"}], ",", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "+", "\[Delta]l"}], ")"}], " ", 
             "\[CapitalOmega]"}], "c"], "->", 
           FractionBox[
            RowBox[{" ", 
             RowBox[{"L", " ", "\[CapitalOmega]"}]}], "c"]}], ",", 
          RowBox[{"r1", "\[Rule]", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["t1", "2"]}], ")"}], 
            RowBox[{"1", "/", "2"}]]}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "\[Rule]", "0"}], ",", 
         RowBox[{"\[CapitalOmega]", "\[Rule]", "0"}]}], "}"}]}], "]"}], "/.", 
     
     RowBox[{"{", 
      RowBox[{"\[Psi]", "\[Rule]", "0"}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r1", "\[Rule]", 
       SuperscriptBox["0.84", 
        RowBox[{"1", "/", "2"}]]}], ",", 
      RowBox[{"t1", "\[Rule]", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "0.84"}], ")"}], 
        RowBox[{"1", "/", "2"}]]}]}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"areflvec", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"\[Delta]l", " ", 
             SubscriptBox["\[Omega]", "0"]}], "c"], "\[Rule]", " ", 
           "\[Psi]"}], ",", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "+", "\[Delta]l"}], ")"}], " ", 
             "\[CapitalOmega]"}], "c"], "->", 
           FractionBox[
            RowBox[{" ", 
             RowBox[{"L", " ", "\[CapitalOmega]"}]}], "c"]}], ",", 
          RowBox[{"r1", "\[Rule]", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["t1", "2"]}], ")"}], 
            RowBox[{"1", "/", "2"}]]}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "\[Rule]", "0"}], ",", 
         RowBox[{"\[CapitalOmega]", "\[Rule]", "0"}]}], "}"}]}], "]"}], "/.", 
     
     RowBox[{"{", 
      RowBox[{"\[Psi]", "\[Rule]", 
       FractionBox["\[Pi]", "2"]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r1", "\[Rule]", 
       SuperscriptBox["0.84", 
        RowBox[{"1", "/", "2"}]]}], ",", 
      RowBox[{"t1", "\[Rule]", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "0.84"}], ")"}], 
        RowBox[{"1", "/", "2"}]]}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"cavMatrixB", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"cavMatrix", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"\[Delta]l", " ", 
            SubscriptBox["\[Omega]", "0"]}], "c"], "\[Rule]", " ", "\[Psi]"}],
          ",", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"L", "+", "\[Delta]l"}], ")"}], " ", "\[CapitalOmega]"}],
            "c"], "->", 
          FractionBox[
           RowBox[{" ", 
            RowBox[{"L", " ", "\[CapitalOmega]"}]}], "c"]}], ",", 
         RowBox[{"r1", "\[Rule]", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["t1", "2"]}], ")"}], 
           RowBox[{"1", "/", "2"}]]}], ",", 
         RowBox[{"\[Phi]", "\[Rule]", " ", "0"}]}], " ", "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "\[Rule]", "0"}], ",", 
        RowBox[{"r1", "\[Rule]", 
         SuperscriptBox["0.84", 
          RowBox[{"1", "/", "2"}]]}], ",", 
        RowBox[{"t1", "\[Rule]", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "0.84"}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ",", 
        RowBox[{"\[Psi]", "\[Rule]", "0"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"cavMatrixB", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"cavMatrixB", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "0", ",", "0.1"}], "}"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.805422838605166*^9, 
  3.8054228469011917`*^9}},ExpressionUUID->"8b9915ce-6217-49bf-b8f8-\
0018d531014b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"old", " ", "working", " ", "below"}], "*)"}]], "Input",ExpressionUU\
ID->"9147f3c4-413a-4fee-a951-99260bb89c5b"],

Cell[TextData[{
 "working with quadratures in frequency domain, ignoring all propagation \
outside of the cavity \n",
 Cell[BoxData[
  RowBox[{
   StyleBox[
    SubscriptBox[
     OverscriptBox["a", "^"], 
     StyleBox["PD1",
      FontVariations->{"Underline"->False}]],
    FontVariations->{"Underline"->True}], " ", "=", " ", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["2", 
      RowBox[{"1", "/", "2"}]]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"P", "[", 
        FractionBox["\[Pi]", "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         StyleBox["A",
          FontVariations->{"Underline"->True}], " ", "+", " ", 
         StyleBox[
          OverscriptBox["a", "^"],
          FontVariations->{"Underline"->True}]}], ")"}]}], "+", 
      SubscriptBox[
       StyleBox[
        OverscriptBox["a", "^"],
        FontVariations->{"Underline"->True}], "refl"]}], ")"}]}]}]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"bc762a23-f884-40ab-bf82-9206952e3794"],
 "\n",
 Cell[BoxData[
  RowBox[{
   StyleBox[
    SubscriptBox[
     OverscriptBox["a", "^"], 
     StyleBox["PD2",
      FontVariations->{"Underline"->False}]],
    FontVariations->{"Underline"->True}], " ", "=", " ", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["2", 
      RowBox[{"1", "/", "2"}]]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"P", "[", 
        FractionBox["\[Pi]", "2"], "]"}], 
       SubscriptBox[
        StyleBox[
         OverscriptBox["a", "^"],
         FontVariations->{"Underline"->True}], "refl"]}], "-", 
      RowBox[{"(", 
       RowBox[{
        StyleBox["A",
         FontVariations->{"Underline"->True}], " ", "+", " ", 
        StyleBox[
         OverscriptBox["a", "^"],
         FontVariations->{"Underline"->True}]}], ")"}]}], ")"}]}]}]], "Input",
  
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"0635ba3f-c6c9-4943-bb5d-279227a96b45"],
 "\n",
 StyleBox["[equation a1]",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.804889603781643*^9, 3.8048896153457823`*^9}, {
   3.8048896684110613`*^9, 3.8048896693274803`*^9}, {3.804889715613905*^9, 
   3.8048899212189903`*^9}, {3.804891129312146*^9, 3.804891129975185*^9}, {
   3.80489311838515*^9, 3.804893121951481*^9}, 3.805061132867296*^9},
 FontSize->16,ExpressionUUID->"2cfa5f72-a603-4771-916e-b92160375c7d"],

Cell[TextData[{
 "to find ",
 Cell[BoxData[
  SubscriptBox[
   StyleBox[
    OverscriptBox["a", "^"],
    FontVariations->{"Underline"->True}], "refl"]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"3902b714-470d-4895-90a6-e7f9aef21c45"],
 " use solution for lossless mirrors cavity (ex2_3.nb), but add in squeezing \
midway through the cavity propagation (I assume that this placement doesn\
\[CloseCurlyQuote]t matter else it would have been given?)\n",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["a", "5"], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["R", "1"], "+", 
      RowBox[{
       SubscriptBox["T", "1"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Id", "-", 
          RowBox[{"P", " ", 
           SubscriptBox["R", "2"], " ", "P", " ", 
           SubscriptBox["R", "1"]}]}], ")"}], 
        RowBox[{"-", "1"}]], "P", " ", 
       SubscriptBox["R", "2"], " ", "P", " ", 
       SubscriptBox["T", "1"]}]}], ")"}], 
    SubscriptBox["a", "0"]}]}]], "Input",ExpressionUUID->
  "7961fdd4-7619-4aa7-9c39-66d4f256618f"],
 " \n",
 Cell[BoxData[
  RowBox[{
   StyleBox["\[Psi]",
    FontVariations->{"Underline"->False}], 
   StyleBox["=",
    FontVariations->{"Underline"->False}], 
   FractionBox[
    RowBox[{
     SubscriptBox["\[Omega]", "0"], " ", "\[Delta]l"}], "c"], " "}]], "Input",
  
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"b3848182-6b28-4538-8cc6-ad9705428f9b"],
 "\n",
 Cell[BoxData[
  RowBox[{"P", "\[LeftArrow]", " ", 
   RowBox[{
    RowBox[{"P", "[", 
     FractionBox["\[Psi]", "2"], "]"}], 
    RowBox[{
     SubscriptBox["S", "sqz"], "[", 
     RowBox[{"r", ",", "\[Phi]"}], "]"}], 
    RowBox[{"P", "[", 
     FractionBox["\[Psi]", "2"], "]"}]}]}]], "Input",ExpressionUUID->
  "1ef304cc-f1af-40f6-b5d8-c322919ca09f"],
 "\n",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["P", "2"], "\[LeftArrow]", " ", 
   RowBox[{
    RowBox[{"P", "[", 
     FractionBox["\[Psi]", "2"], "]"}], 
    RowBox[{
     SubscriptBox["S", "sqz"], "[", 
     RowBox[{"r", ",", "\[Phi]"}], "]"}], 
    RowBox[{"P", "[", "\[Psi]", "]"}], 
    RowBox[{
     SubscriptBox["S", "sqz"], "[", 
     RowBox[{"r", ",", "\[Phi]"}], "]"}], 
    RowBox[{"P", "[", 
     FractionBox["\[Psi]", "2"], "]"}]}]}]], "Input",ExpressionUUID->
  "b58745af-811e-45b4-9ecf-1d3c9cb2b3be"],
 "\n",
 Cell[BoxData[
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["T", "1"], ",", 
     SubscriptBox["R", "1"], ",", 
     SubscriptBox["T", "2"], ",", 
     SubscriptBox["R", "2"]}], "}"}], "\[LeftArrow]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["t", "1"], 
      RowBox[{"P", "[", 
       FractionBox["\[Pi]", "2"], "]"}]}], ",", " ", 
     SubscriptBox["r", "1"], ",", "0", ",", "1"}], "}"}]}]], "Input",
  ExpressionUUID->"9458b15d-3fe4-4d96-bb06-fbf610e43e16"],
 "\n",
 Cell[BoxData[{
  RowBox[{
   StyleBox[
    SubscriptBox[
     StyleBox[
      OverscriptBox["a", "^"],
      FontVariations->{"Underline"->True}], 
     StyleBox["refl",
      FontVariations->{"Underline"->False}]],
    FontVariations->{"Underline"->True}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["r", "1"], "+", 
      RowBox[{
       SubscriptBox["t", "1"], 
       RowBox[{"P", "[", 
        FractionBox["\[Pi]", "2"], "]"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Id", "-", 
          RowBox[{
           RowBox[{"P", "[", 
            FractionBox["\[Psi]", "2"], "]"}], 
           RowBox[{
            SubscriptBox["S", "sqz"], "[", 
            RowBox[{"r", ",", "\[Phi]"}], "]"}], 
           RowBox[{"P", "[", "\[Psi]", "]"}], 
           RowBox[{
            SubscriptBox["S", "sqz"], "[", 
            RowBox[{"r", ",", "\[Phi]"}], "]"}], 
           RowBox[{"P", "[", 
            FractionBox["\[Psi]", "2"], "]"}], " ", 
           SubscriptBox["r", "1"]}]}], ")"}], 
        RowBox[{"-", "1"}]], 
       RowBox[{"P", "[", 
        FractionBox["\[Psi]", "2"], "]"}], 
       RowBox[{
        SubscriptBox["S", "sqz"], "[", 
        RowBox[{"r", ",", "\[Phi]"}], "]"}], 
       RowBox[{"P", "[", "\[Psi]", "]"}], 
       RowBox[{
        SubscriptBox["S", "sqz"], "[", 
        RowBox[{"r", ",", "\[Phi]"}], "]"}], 
       RowBox[{"P", "[", 
        FractionBox["\[Psi]", "2"], "]"}], " ", 
       SubscriptBox["t", "1"], 
       RowBox[{"P", "[", 
        FractionBox["\[Pi]", "2"], "]"}]}]}], ")"}], 
    StyleBox[
     OverscriptBox["n", "^"],
     FontVariations->{"Underline"->True}]}]}], "\[IndentingNewLine]", 
  RowBox[{"=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["r", "1"], "+", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["t", "1"], "2"], 
       RowBox[{"P", "[", 
        FractionBox["\[Pi]", "2"], "]"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Id", "-", 
          RowBox[{
           SubscriptBox["r", "1"], 
           RowBox[{"P", "[", 
            FractionBox["\[Psi]", "2"], "]"}], 
           RowBox[{
            SubscriptBox["S", "sqz"], "[", 
            RowBox[{"r", ",", "\[Phi]"}], "]"}], 
           RowBox[{"P", "[", "\[Psi]", "]"}], 
           RowBox[{
            SubscriptBox["S", "sqz"], "[", 
            RowBox[{"r", ",", "\[Phi]"}], "]"}], 
           RowBox[{"P", "[", 
            FractionBox["\[Psi]", "2"], "]"}]}]}], " ", ")"}], 
        RowBox[{"-", "1"}]], 
       RowBox[{"P", "[", 
        FractionBox["\[Psi]", "2"], "]"}], 
       RowBox[{
        SubscriptBox["S", "sqz"], "[", 
        RowBox[{"r", ",", "\[Phi]"}], "]"}], 
       RowBox[{"P", "[", "\[Psi]", "]"}], 
       RowBox[{
        SubscriptBox["S", "sqz"], "[", 
        RowBox[{"r", ",", "\[Phi]"}], "]"}], 
       RowBox[{"P", "[", 
        FractionBox[
         RowBox[{"\[Psi]", "+", "\[Pi]"}], "2"], "]"}]}]}], ")"}], 
    StyleBox[
     OverscriptBox["n", "^"],
     FontVariations->{"Underline"->True}]}]}]}], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"6097050b-fcf0-42a3-b198-306dd1bc8f80"],
 "\n",
 StyleBox["[equation a2]",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.8048905953363447`*^9, 3.804890858998645*^9}, {
   3.804890889525486*^9, 3.8048910857531*^9}, {3.804891135053113*^9, 
   3.8048911562858477`*^9}, {3.80489118719943*^9, 3.804891257784699*^9}, {
   3.8048913671892157`*^9, 3.804891454809136*^9}, {3.8048916071216497`*^9, 
   3.8048916351675*^9}, {3.804893139168474*^9, 3.8048931404863377`*^9}, 
   3.804893394513235*^9, 
   3.8050611344376373`*^9},ExpressionUUID->"7897e3d3-efca-4dd5-b929-\
b091e7b733b3"],

Cell[TextData[{
 "now putting it all together, this will get rather messy \n",
 Cell[BoxData[
  RowBox[{
   StyleBox[
    SubscriptBox[
     OverscriptBox["a", "^"], 
     StyleBox["PD1",
      FontVariations->{"Underline"->False}]],
    FontVariations->{"Underline"->True}], " ", "=", " ", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["2", 
      RowBox[{"1", "/", "2"}]]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"P", "[", 
        FractionBox["\[Pi]", "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         StyleBox["A",
          FontVariations->{"Underline"->True}], " ", "+", " ", 
         StyleBox[
          OverscriptBox["a", "^"],
          FontVariations->{"Underline"->True}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["r", "1"], "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["t", "1"], "2"], 
          RowBox[{"P", "[", 
           FractionBox["\[Pi]", "2"], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Id", "-", 
             RowBox[{
              SubscriptBox["r", "1"], 
              RowBox[{"P", "[", 
               FractionBox["\[Psi]", "2"], "]"}], 
              RowBox[{
               SubscriptBox["S", "sqz"], "[", 
               RowBox[{"r", ",", "\[Phi]"}], "]"}], 
              RowBox[{"P", "[", "\[Psi]", "]"}], 
              RowBox[{
               SubscriptBox["S", "sqz"], "[", 
               RowBox[{"r", ",", "\[Phi]"}], "]"}], 
              RowBox[{"P", "[", 
               FractionBox["\[Psi]", "2"], "]"}]}]}], " ", ")"}], 
           RowBox[{"-", "1"}]], 
          RowBox[{"P", "[", 
           FractionBox["\[Psi]", "2"], "]"}], 
          RowBox[{
           SubscriptBox["S", "sqz"], "[", 
           RowBox[{"r", ",", "\[Phi]"}], "]"}], 
          RowBox[{"P", "[", "\[Psi]", "]"}], 
          RowBox[{
           SubscriptBox["S", "sqz"], "[", 
           RowBox[{"r", ",", "\[Phi]"}], "]"}], 
          RowBox[{"P", "[", 
           FractionBox[
            RowBox[{"\[Psi]", "+", "\[Pi]"}], "2"], "]"}]}]}], ")"}], 
       StyleBox[
        OverscriptBox["n", "^"],
        FontVariations->{"Underline"->True}]}]}], ")"}]}]}]], "Input",
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"adf7fc60-97e4-42c8-a180-b10793b2dbe7"],
 "\n",
 Cell[BoxData[
  RowBox[{
   StyleBox[
    SubscriptBox[
     OverscriptBox["a", "^"], 
     StyleBox["PD2",
      FontVariations->{"Underline"->False}]],
    FontVariations->{"Underline"->True}], " ", "=", " ", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["2", 
      RowBox[{"1", "/", "2"}]]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"P", "[", 
        FractionBox["\[Pi]", "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["r", "1"], "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["t", "1"], "2"], 
          RowBox[{"P", "[", 
           FractionBox["\[Pi]", "2"], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Id", "-", 
             RowBox[{
              SubscriptBox["r", "1"], 
              RowBox[{"P", "[", 
               FractionBox["\[Psi]", "2"], "]"}], 
              RowBox[{
               SubscriptBox["S", "sqz"], "[", 
               RowBox[{"r", ",", "\[Phi]"}], "]"}], 
              RowBox[{"P", "[", "\[Psi]", "]"}], 
              RowBox[{
               SubscriptBox["S", "sqz"], "[", 
               RowBox[{"r", ",", "\[Phi]"}], "]"}], 
              RowBox[{"P", "[", 
               FractionBox["\[Psi]", "2"], "]"}]}]}], " ", ")"}], 
           RowBox[{"-", "1"}]], 
          RowBox[{"P", "[", 
           FractionBox["\[Psi]", "2"], "]"}], 
          RowBox[{
           SubscriptBox["S", "sqz"], "[", 
           RowBox[{"r", ",", "\[Phi]"}], "]"}], 
          RowBox[{"P", "[", "\[Psi]", "]"}], 
          RowBox[{
           SubscriptBox["S", "sqz"], "[", 
           RowBox[{"r", ",", "\[Phi]"}], "]"}], 
          RowBox[{"P", "[", 
           FractionBox[
            RowBox[{"\[Psi]", "+", "\[Pi]"}], "2"], "]"}]}]}], ")"}], 
       StyleBox[
        OverscriptBox["n", "^"],
        FontVariations->{"Underline"->True}]}], "-", 
      RowBox[{"(", 
       RowBox[{
        StyleBox["A",
         FontVariations->{"Underline"->True}], " ", "+", " ", 
        StyleBox[
         OverscriptBox["a", "^"],
         FontVariations->{"Underline"->True}]}], ")"}]}], ")"}]}]}]], "Input",
  
  CellChangeTimes->{{3.8048894485046463`*^9, 3.804889521973521*^9}},
  ExpressionUUID->"3a9beac0-808d-44e6-bdd2-826aaae5f78c"],
 "\n",
 StyleBox["[equation a3]",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.8048912960776176`*^9, 3.8048913457827272`*^9}, 
   3.804891495418591*^9, {3.8048931460377502`*^9, 3.8048931472716093`*^9}, {
   3.805061135868678*^9, 
   3.805061137804186*^9}},ExpressionUUID->"519e97e0-41db-48d1-8d85-\
2d4e3db59a5c"]
},
WindowSize->{867, 571},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 264, 5, 31, "Input",ExpressionUUID->"e750f619-bab7-4975-a712-0525a363b361"],
Cell[825, 27, 1516, 41, 102, "Input",ExpressionUUID->"5b7f4ab0-a467-47df-a5b7-c5ef785fe4a1"],
Cell[2344, 70, 612, 16, 72, "Input",ExpressionUUID->"52698886-efb2-4c81-b71a-d0c29ac8721b"],
Cell[2959, 88, 952, 26, 81, "Input",ExpressionUUID->"8c4da768-0ed9-4397-b783-34a496e02a75"],
Cell[3914, 116, 1194, 34, 72, "Input",ExpressionUUID->"2bc0b8d1-7691-4bb6-8931-d1656dfce9a7"],
Cell[5111, 152, 832, 29, 49, "Input",ExpressionUUID->"4e16faba-bf94-4212-91ba-5506853a184a"],
Cell[CellGroupData[{
Cell[5968, 185, 851, 22, 79, "Input",ExpressionUUID->"d7c506a0-f76f-4dda-b9d6-949ecafb9d65"],
Cell[6822, 209, 2966, 85, 216, "Output",ExpressionUUID->"c6230770-a880-475e-a111-ca8e32bfe261"]
}, Open  ]],
Cell[9803, 297, 2224, 58, 160, "Input",ExpressionUUID->"119ecdc3-6fa1-4c2a-afc0-afebfd72aaf8"],
Cell[12030, 357, 238, 5, 31, "Input",ExpressionUUID->"d6d10b05-82f8-4ce2-9f74-65e8d8e83dd1"],
Cell[12271, 364, 1024, 26, 78, "Input",ExpressionUUID->"2c2c02e4-da7e-4d1a-afcc-29cc0ae90914"],
Cell[13298, 392, 9664, 280, 319, "Text",ExpressionUUID->"9ea16179-5577-47fa-90fc-875f0ff5a8d7"],
Cell[22965, 674, 1098, 26, 101, "Input",ExpressionUUID->"3ad244e4-4d22-41dd-8ee8-d4ad44515f0f"],
Cell[24066, 702, 913, 29, 92, "Input",ExpressionUUID->"cb2f7384-a0fc-431b-a3c6-4082243c4b47"],
Cell[24982, 733, 331, 8, 31, "Input",ExpressionUUID->"0a4f665c-38af-4293-9be3-ec46336b299e"],
Cell[25316, 743, 3531, 106, 134, "Input",ExpressionUUID->"8fed679d-b33b-4614-a098-702ef742e981"],
Cell[28850, 851, 1359, 42, 83, "Input",ExpressionUUID->"6f92440e-abd9-4b33-9e46-3fb945db3c47"],
Cell[30212, 895, 321, 7, 31, "Input",ExpressionUUID->"538a5b15-5f97-4805-83c3-5fd4c507139d"],
Cell[30536, 904, 606, 15, 55, "Input",ExpressionUUID->"eedcabdb-77d3-4faf-9193-b954071d299c"],
Cell[31145, 921, 497, 8, 193, "Input",ExpressionUUID->"1768d3fd-7163-4acc-8273-90750e5af89c"],
Cell[31645, 931, 1116, 32, 42, "Input",ExpressionUUID->"695ca54b-7af7-4c31-8beb-113539016b51"],
Cell[32764, 965, 5190, 154, 360, "Input",ExpressionUUID->"8b9915ce-6217-49bf-b8f8-0018d531014b"],
Cell[37957, 1121, 153, 3, 31, "Input",ExpressionUUID->"9147f3c4-413a-4fee-a951-99260bb89c5b"],
Cell[38113, 1126, 2440, 73, 118, "Text",ExpressionUUID->"2cfa5f72-a603-4771-916e-b92160375c7d"],
Cell[40556, 1201, 6663, 199, 363, "Text",ExpressionUUID->"7897e3d3-efca-4dd5-b929-b091e7b733b3"],
Cell[47222, 1402, 4978, 145, 322, "Text",ExpressionUUID->"519e97e0-41db-48d1-8d85-2d4e3db59a5c"]
}
]
*)

