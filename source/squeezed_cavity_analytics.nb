(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    214795,       5608]
NotebookOptionsPosition[    209130,       5539]
NotebookOutlinePosition[    209462,       5554]
CellTagsIndexPosition[    209419,       5551]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["squeezed_cavity_analytics.nb\n",
  FontVariations->{"Underline"->True}],
 "James Gardner 2020",
 StyleBox["\n",
  FontVariations->{"Underline"->True}],
 "Analytics for the non-linear element in an over-coupled, linear, \
Fabry-Perot cavity.\nGenerates the figures used and values quoted in the \
report.\nThis satisfies Aim 1 - (ii) of the ASC goals."
}], "Text",
 CellChangeTimes->{{3.812654702168459*^9, 3.812654777864696*^9}, 
   3.812655321369796*^9, {3.812656746017045*^9, 
   3.812656746584639*^9}},ExpressionUUID->"39c62208-fd8d-4f47-b3ae-\
f8e054b8e8fb"],

Cell["\<\
See Appendix A of the report for a more readable walkthrough of this \
derivation.
We start by borrowing the solution for the fields for an empty cavity. \
Working in the sideband picture.\
\>", "Text",
 CellChangeTimes->{{3.812654799838687*^9, 3.812654839005529*^9}, {
  3.812654872561474*^9, 
  3.8126548781169777`*^9}},ExpressionUUID->"a7a48fbc-bd42-463c-98e0-\
5837de31a7ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.806375255357369*^9, {3.806376026563768*^9, 3.8063760848111467`*^9}, {
   3.8063763623354692`*^9, 3.8063763626935587`*^9}, {3.806376871192869*^9, 
   3.806376938723217*^9}, {3.806377471341908*^9, 3.806377471685624*^9}, {
   3.812654981868496*^9, 3.812654982249424*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"ae39354c-bd1f-4add-bb22-1cac54566556"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c", " ", "=", " ", 
   RowBox[{"3", " ", 
    SuperscriptBox["10", "8"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Id", " ", "=", " ", 
    RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "using", " ", "the", " ", "mirror", " ", "convention", " ", "that", " ", 
     "no", " ", "change", " ", "occurs", " ", "on", " ", "transmission", " ", 
     "and", " ", "a", " ", "sign", " ", "change", " ", "on", " ", "one", " ", 
     "face", " ", "of", " ", "a", " ", "mirror", " ", "and", " ", "nothing", 
     " ", "on", " ", "the", " ", "other"}], ",", " ", 
    RowBox[{
     RowBox[{
     "let", " ", "the", " ", "reflection", " ", "matrix", " ", "off", " ", 
      "the", " ", "side", " ", "which", " ", "recieves", " ", "a"}], " ", "-", 
     RowBox[{
     "1", " ", "sign", " ", "change", " ", "be", " ", "called", " ", "aR", 
      " ", "for", " ", "anti"}], "-", "reflection"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Refl", "[", "r_", "]"}], ":=", 
  RowBox[{"r", " ", "Id"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AntiRefl", "[", "r_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"-", "r"}], " ", "Id"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Trans", "[", "t_", "]"}], ":=", 
   RowBox[{"t", " ", "Id"}]}], "\n", 
  RowBox[{"(*", "rotation", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rota", "[", "\[Theta]_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", "\[Theta]", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]},
      {
       RowBox[{"Sin", "[", "\[Theta]", "]"}], 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}
     }], ")"}]}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "propagation", " ", "across", " ", "a", " ", "space", " ", "of", " ", 
     "length", " ", "D"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"L", " ", "+", " ", 
      RowBox[{"\[Delta]l", "\[IndentingNewLine]", 
       RowBox[{"SpacePropa", "[", 
        RowBox[{"L_", ",", "\[Delta]l_"}], "]"}]}]}], ":=", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"\[ImaginaryI]", " ", 
        FractionBox["\[CapitalOmega]", "c"], 
        RowBox[{"(", 
         RowBox[{"L", "+", "\[Delta]l"}], ")"}]}], "]"}], 
      RowBox[{"P", "[", 
       FractionBox[
        RowBox[{
         SubscriptBox["\[Omega]", "0"], " ", "\[Delta]l"}], "c"], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"\[Delta]l", " ", 
           SubscriptBox["\[Omega]", "0"]}], "c"], "\[Rule]", " ", "\[Psi]"}], 
        ",", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "+", "\[Delta]l"}], ")"}], " ", "\[CapitalOmega]"}], 
          "c"], "->", 
         FractionBox[
          RowBox[{" ", 
           RowBox[{"L", " ", "\[CapitalOmega]"}]}], "c"]}]}], "}"}]}]}]}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SpacePropa", "[", 
    RowBox[{"\[CapitalOmega]_", ",", "L_", ",", "\[Psi]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], 
      FractionBox[
       RowBox[{"\[CapitalOmega]", " ", "L"}], "c"]}], "]"}], 
    RowBox[{"Rota", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", "squeezer", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSqz", "[", 
    RowBox[{"r_", ",", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        RowBox[{"Cosh", "[", "r", "]"}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Phi]"}], "]"}], 
         RowBox[{"Sinh", "[", "r", "]"}]}]}], 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}], 
        RowBox[{"Sinh", "[", "r", "]"}]}]},
      {
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}], 
        RowBox[{"Sinh", "[", "r", "]"}]}], 
       RowBox[{
        RowBox[{"Cosh", "[", "r", "]"}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Phi]"}], "]"}], 
         RowBox[{"Sinh", "[", "r", "]"}]}]}]}
     }], ")"}]}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "input", " ", "field", " ", "quadratures", " ", "in", " ", "frequency", 
     " ", "domain"}], ",", " ", 
    RowBox[{
     RowBox[{"caret", "/", "hat"}], " ", 
     RowBox[{"(", "^", ")"}], " ", "means", " ", "frequency", " ", 
     "dependant"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoherLO", "[", 
   RowBox[{"A_", ",", "\[Theta]_"}], "]"}], ":=", 
  RowBox[{"(", GridBox[{
     {
      RowBox[{"A", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}]},
     {
      RowBox[{"A", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}
    }], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nvec", ",", " ", "avec", ",", " ", "Avec"}], "}"}], " ", "=", 
   " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubscriptBox[
          OverscriptBox["n", "^"], "1"]},
        {
         SubscriptBox[
          OverscriptBox["n", "^"], "2"]}
       }], ")"}], ",", 
     RowBox[{"(", GridBox[{
        {
         SubscriptBox[
          OverscriptBox["a", "^"], "1"]},
        {
         SubscriptBox[
          OverscriptBox["a", "^"], "2"]}
       }], ")"}], ",", 
     RowBox[{"CoherLO", "[", 
      RowBox[{"A", ",", "\[Theta]"}], "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.805518009488543*^9, 3.805518036923307*^9}, {
   3.812654849156475*^9, 3.8126548684678164`*^9}, {3.816563093805778*^9, 
   3.816563099636797*^9}, {3.816642356891089*^9, 3.816642399198283*^9}, {
   3.8166424367523203`*^9, 3.8166425113139553`*^9}, {3.816642550260607*^9, 
   3.816642561872278*^9}, {3.8166427487284184`*^9, 3.8166427980729094`*^9}, {
   3.8166428412718487`*^9, 3.81664285131601*^9}, {3.81664294728627*^9, 
   3.8166429952359543`*^9}, {3.8166431410449457`*^9, 3.8166432683268557`*^9}, 
   3.816914582661438*^9, 3.81708519557962*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"60b81c7e-a887-44a9-b376-43b41f52008d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "squeezing", " ", "midway", " ", "through", " ", "the", " ", "cavity"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"cavPropa", "[", 
      RowBox[{
      "\[CapitalOmega]_", ",", "L_", ",", "\[Psi]_", ",", "r_", ",", 
       "\[Phi]_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"SpacePropa", "[", 
       RowBox[{"\[CapitalOmega]", ",", 
        FractionBox["L", "2"], ",", 
        FractionBox["\[Psi]", "2"]}], "]"}], ".", 
      RowBox[{"SSqz", "[", 
       RowBox[{"r", ",", "\[Phi]"}], "]"}], ".", 
      RowBox[{"SpacePropa", "[", 
       RowBox[{"\[CapitalOmega]", ",", 
        FractionBox["L", "2"], ",", 
        FractionBox["\[Psi]", "2"]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"todo", " ", 
      RowBox[{"NB", ":", " ", 
       RowBox[{
        RowBox[{"should", " ", "alter", " ", "the", " ", "set"}], "-", 
        RowBox[{"up", " ", 
         RowBox[{"s", ".", "t", ".", " ", "the"}], " ", "beam", " ", "is", 
         " ", "only", " ", "squeezed", " ", "from", " ", "one", " ", 
         "direction"}]}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "from"}], " ", "M1", " ", "to", " ", 
      "M2", " ", "but", " ", "not", " ", "back", " ", "from", " ", "M2", " ", 
      "to", " ", 
      RowBox[{"M1", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "calculating", " ", "the", " ", "cavity", " ", "reflection", " ", 
      "matrix", " ", "by", " ", "borrowing", " ", "the", " ", "empty", " ", 
      "cavity", " ", "solution", " ", "and", " ", "substituting", " ", "in", 
      " ", "the", " ", "above", " ", "propagation", " ", "matrix", 
      "\[IndentingNewLine]", 
      SubscriptBox["a", "5"]}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["R", "1"], "+", 
        RowBox[{
         SubscriptBox["T", "1"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Id", "-", 
            RowBox[{"P", " ", 
             SubscriptBox["R", "2"], " ", "P", " ", 
             SubscriptBox["R", "1"]}]}], ")"}], 
          RowBox[{"-", "1"}]], "P", " ", 
         SubscriptBox["R", "2"], " ", "P", " ", 
         SubscriptBox["T", "1"]}]}], ")"}], 
      SubscriptBox["a", "0"], "\[IndentingNewLine]", "simplifying", " ", 
      "result", " ", "using", " ", "that", " ", 
      FractionBox[
       RowBox[{"\[Delta]l", " ", "\[CapitalOmega]"}], "c"], " ", 
      RowBox[{"<<", " ", "1"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cavMatrix", "[", 
     RowBox[{
     "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",", 
      "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Prop", " ", "=", 
        RowBox[{"cavPropa", "[", 
         RowBox[{
         "\[CapitalOmega]", ",", "L", ",", "\[Psi]", ",", "r", ",", 
          "\[Phi]"}], "]"}]}], " ", "}"}], ",", 
      RowBox[{
       RowBox[{"AntiRefl", "[", "r1", "]"}], "+", 
       RowBox[{
        RowBox[{"Trans", "[", "t1", "]"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"Id", " ", "-", 
          RowBox[{"Prop", ".", 
           RowBox[{"Refl", "[", "r2", "]"}], ".", "Prop", ".", 
           RowBox[{"Refl", "[", "r1", "]"}]}]}], "]"}], ".", "Prop", ".", 
        RowBox[{"Refl", "[", "r2", "]"}], ".", "Prop", ".", 
        RowBox[{"Trans", "[", "t1", "]"}]}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"alternatively", ",", " ", 
     RowBox[{
     "consider", " ", "the", " ", "roundtrip", " ", "propagation", " ", 
      "matrix"}], ",", " ", 
     RowBox[{"RoundTrip", "=", 
      RowBox[{
       RowBox[{
       "SpacePropa", ".", "Refl2", ".", "SpacePropa", ".", 
        "\[IndentingNewLine]", 
        RowBox[{"-", 
         RowBox[{"Refl", "[", "r1", "]"}]}]}], "+", 
       RowBox[{
        RowBox[{"Trans", "[", "t1", "]"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"Id", " ", "-", " ", 
          RowBox[{"SSqz", ".", "RoundTrip", ".", "SSqz", ".", 
           RowBox[{"Refl", "[", "r1", "]"}]}]}], "]"}], ".", "SSqz", ".", 
        "RoundTrip", ".", "SSqz", ".", 
        RowBox[{"Trans", "[", "t1", "]"}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "field", " ", "reflected", " ", "off", " ", "the", " ", 
     "cavity"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"areflvec", "[", 
      RowBox[{
      "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",",
        "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"cavMatrix", "[", 
        RowBox[{
        "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",", 
         "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}], ".", "nvec"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.805060349494413*^9, 3.8050604603106318`*^9}, {
   3.80506057597893*^9, 3.805060626419115*^9}, 3.8050608741998*^9, {
   3.8050609680671453`*^9, 3.805060968605934*^9}, 3.8054227568794937`*^9, {
   3.8054228642531557`*^9, 3.805422873497765*^9}, {3.805422941389436*^9, 
   3.8054229428453293`*^9}, {3.8054229997411547`*^9, 3.805423014434753*^9}, {
   3.805513382945775*^9, 3.805513431950033*^9}, {3.805516314433888*^9, 
   3.805516345236754*^9}, {3.8055180513308067`*^9, 3.805518058377935*^9}, 
   3.8055180908796587`*^9, 3.805518153350175*^9, {3.807578922991132*^9, 
   3.807578923383491*^9}, {3.81664199866438*^9, 3.816642002324481*^9}, {
   3.816642741457452*^9, 3.816642744908489*^9}, {3.81664280913319*^9, 
   3.816642821336466*^9}, {3.816642918840827*^9, 3.816642936442752*^9}, {
   3.8166430071725492`*^9, 3.816643044917523*^9}, {3.816643103691928*^9, 
   3.8166431264888268`*^9}, {3.8166433162510777`*^9, 
   3.8166433779812326`*^9}, {3.816643602672441*^9, 3.816643621655599*^9}, {
   3.816643662944483*^9, 3.816643730948311*^9}, {3.8166437611114807`*^9, 
   3.8166437972826*^9}, {3.816646591252471*^9, 3.816646593324086*^9}, {
   3.8170835595422497`*^9, 3.8170835609003687`*^9}, {3.817153247974875*^9, 
   3.81715337037578*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"119ecdc3-6fa1-4c2a-afc0-afebfd72aaf8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"sanity", " ", 
    RowBox[{"check", ":", " ", 
     RowBox[{
     "overcoupled", " ", "cavity", " ", "on", " ", "resonance", " ", "shows", 
      " ", "no", " ", "phase", " ", "shift", " ", "in", " ", "this", " ", 
      "convention", " ", "as", " ", "the", " ", "promptly", " ", "reflected", 
      " ", "field", " ", "is", " ", "cancelled", " ", "out"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"areflvec", "[", 
     RowBox[{"0", ",", "r1", ",", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["r1", "2"]}], ")"}], 
       RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", "L", ",", "0", ",", 
      "0", ",", "0"}], "]"}], "]"}], "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.8166417654016314`*^9, 3.816641867711865*^9}, {
  3.816641955110878*^9, 3.816641962786852*^9}, {3.816642068513987*^9, 
  3.816642069160809*^9}, {3.8166421309890833`*^9, 3.816642185196351*^9}, {
  3.816642610244808*^9, 3.816642652117511*^9}, {3.816646610265003*^9, 
  3.8166466443697367`*^9}, {3.816647564465507*^9, 3.8166475863412943`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"622c0bd9-623a-435d-b949-9131fb694933"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Mcav", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"cavMatrix", "[", 
     RowBox[{
     "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",", "L", 
      ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.817083463111174*^9, 3.817083527287775*^9}, {
  3.8170837686633177`*^9, 3.8170837692199373`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"775950c5-51ea-4403-9d3d-6e85ec0dfd4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"assume", " ", "that", " ", "\[Theta]"}], " ", "=", " ", "0"}], 
    ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "that"}], " ", "the", " ", "LO", " ", 
     "is", " ", "selecting", " ", "the", " ", "first", " ", "quadrature", 
     "\[IndentingNewLine]", "using", " ", "the", " ", "arguments", " ", 
     "below"}], ",", " ", 
    RowBox[{
     RowBox[{
     "we", " ", "use", " ", "the", " ", "following", " ", "expression", " ", 
      "for", " ", "the", " ", "homodyne", " ", "intensity", 
      "\[IndentingNewLine]", 
      OverscriptBox["HomI", "^"]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"1", ",", "c"}]], "\[ConjugateTranspose]"}], 
       SubscriptBox[
        OverscriptBox["b", "^"], 
        RowBox[{"1", ",", "c"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", 
        RowBox[{"1", ",", "c"}]], 
       RowBox[{
        SubscriptBox[
         OverscriptBox["b", "^"], 
         RowBox[{"1", ",", "c"}]], "\[ConjugateTranspose]"}]}], "+", 
      RowBox[{
       SubscriptBox["B", 
        RowBox[{"1", ",", "s"}]], 
       SubscriptBox[
        OverscriptBox[
         RowBox[{"\[ConjugateTranspose]", "b"}], "^"], 
        RowBox[{"1", ",", "s"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", 
        RowBox[{"1", ",", "s"}]], 
       RowBox[{
        SubscriptBox[
         OverscriptBox["b", "^"], 
         RowBox[{"1", ",", "s"}]], "\[ConjugateTranspose]"}]}], "-", 
      RowBox[{
       SubscriptBox["B", 
        RowBox[{"2", ",", "c"}]], 
       SubscriptBox[
        OverscriptBox[
         RowBox[{"\[ConjugateTranspose]", "b"}], "^"], 
        RowBox[{"2", ",", "c"}]]}], "-", 
      RowBox[{
       SubscriptBox["B", 
        RowBox[{"2", ",", "c"}]], 
       RowBox[{
        SubscriptBox[
         OverscriptBox["b", "^"], 
         RowBox[{"2", ",", "c"}]], "\[ConjugateTranspose]"}]}], "-", 
      RowBox[{
       SubscriptBox["B", 
        RowBox[{"2", ",", "s"}]], 
       SubscriptBox[
        OverscriptBox[
         RowBox[{"\[ConjugateTranspose]", "b"}], "^"], 
        RowBox[{"2", ",", "s"}]]}], "-", 
      RowBox[{
       SubscriptBox["B", 
        RowBox[{"2", ",", "s"}]], 
       RowBox[{
        SubscriptBox[
         OverscriptBox["b", "^"], 
         RowBox[{"2", ",", "s"}]], "\[ConjugateTranspose]"}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "C", " ", "is", " ", "the", " ", "coherent", " ", "field", " ", "at", " ",
      "PD1"}], ",", " ", 
    RowBox[{"D", " ", "sim", " ", "for", " ", "PD2"}], ",", " ", 
    RowBox[{"c", " ", "is", " ", "the", " ", "noise", " ", "at", " ", "PD1"}],
     ",", " ", 
    RowBox[{"d", " ", "for", " ", 
     RowBox[{"PD2", ".", " ", "Numbers"}], " ", "1", " ", "and", " ", "2", 
     " ", "indicate", " ", "the", " ", "cosine", " ", "or", " ", "sine", " ", 
     "quadrature", " ", "respectively"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"C1", "[", "A_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Trans", "[", 
          FractionBox["1", 
           SqrtBox["2"]], "]"}], ".", 
         RowBox[{"CoherLO", "[", 
          RowBox[{"A", ",", "0"}], "]"}]}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"D1", "[", "A_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AntiRefl", "[", 
          FractionBox["1", 
           SqrtBox["2"]], "]"}], ".", 
         RowBox[{"CoherLO", "[", 
          RowBox[{"A", ",", "0"}], "]"}]}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"bvec", " ", "=", " ", 
     RowBox[{"areflvec", "[", 
      RowBox[{
      "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",", "L",
        ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bvec", " ", "=", " ", 
     RowBox[{"(", GridBox[{
        {
         SubscriptBox[
          OverscriptBox["b", "^"], "1"]},
        {
         SubscriptBox[
          OverscriptBox["b", "^"], "2"]}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"c1", "[", 
      RowBox[{
      "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",",
        "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Trans", "[", 
           FractionBox["1", 
            SqrtBox["2"]], "]"}], ".", "avec"}], "+", 
         RowBox[{
          RowBox[{"Refl", "[", 
           FractionBox["1", 
            SqrtBox["2"]], "]"}], ".", "bvec"}]}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d1", "[", 
      RowBox[{
      "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",",
        "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"AntiRefl", "[", 
           FractionBox["1", 
            SqrtBox["2"]], "]"}], ".", "avec"}], "+", 
         RowBox[{
          RowBox[{"Trans", "[", 
           FractionBox["1", 
            SqrtBox["2"]], "]"}], ".", "bvec"}]}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Assumps1", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", ">", "0"}], ",", 
       RowBox[{"r1", "\[GreaterEqual]", "0"}], ",", " ", 
       RowBox[{"t1", "\[GreaterEqual]", "0"}], ",", " ", 
       RowBox[{"r2", "\[GreaterEqual]", "0"}], ",", " ", 
       RowBox[{"t2", "\[GreaterEqual]", "0"}], ",", " ", 
       RowBox[{"L", "\[GreaterEqual]", "0"}], ",", " ", 
       RowBox[{"\[CapitalOmega]", "\[GreaterEqual]", "0"}], ",", " ", 
       RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"\[Psi]", "\[Element]", "Reals"}], ",", 
       RowBox[{"c", ">", "0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HomI", "[", 
     RowBox[{
     "A_", ",", "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", 
      "t2_", ",", "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_"}], "]"}], 
    " ", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c1Loc", "=", 
         RowBox[{"c1", "[", 
          RowBox[{
          "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",", 
           "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}]}], ",", 
        RowBox[{"d1Loc", "=", 
         RowBox[{"d1", "[", 
          RowBox[{
          "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",", 
           "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}]}]}], "}"}], 
      ",", " ", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"C1", "[", "A", "]"}], "\[ConjugateTranspose]"}], 
          "c1Loc"}], "+", 
         RowBox[{
          RowBox[{"C1", "[", "A", "]"}], " ", 
          RowBox[{"c1Loc", "\[ConjugateTranspose]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"D1", "[", "A", "]"}], "\[ConjugateTranspose]"}], " ", 
          "d1Loc"}], "-", 
         RowBox[{
          RowBox[{"D1", "[", "A", "]"}], " ", 
          RowBox[{"d1Loc", "\[ConjugateTranspose]"}]}]}], ",", 
        RowBox[{"Assumptions", "\[Rule]", "Assumps1"}]}], "]"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8165487432148247`*^9, 3.8165488579460297`*^9}, {
   3.816548913495275*^9, 3.816548926933721*^9}, {3.8165491431847258`*^9, 
   3.81654915730155*^9}, {3.816563175471202*^9, 3.816563274721859*^9}, {
   3.8165633170645514`*^9, 3.816563373391101*^9}, {3.8165634986893377`*^9, 
   3.816563528466881*^9}, {3.816563583558667*^9, 3.816563647832386*^9}, {
   3.816563701081979*^9, 3.816563764998871*^9}, {3.8165637993208857`*^9, 
   3.816563832758932*^9}, {3.8165641695021467`*^9, 3.816564376335062*^9}, 
   3.816564426588419*^9, {3.816564468374893*^9, 3.816564482323048*^9}, {
   3.816564523292562*^9, 3.816564555082543*^9}, {3.816564882972797*^9, 
   3.816564883652418*^9}, {3.816565413557695*^9, 3.816565417297141*^9}, {
   3.816565462225884*^9, 3.816565523814477*^9}, {3.816565584727192*^9, 
   3.816565598789974*^9}, 3.816565711498417*^9, {3.81656575822935*^9, 
   3.816565759396987*^9}, {3.816644105826624*^9, 3.816644120321539*^9}, {
   3.816646721091865*^9, 3.816646759385221*^9}, {3.816646843020117*^9, 
   3.8166469364682083`*^9}, {3.8166469806033373`*^9, 3.816647120156719*^9}, {
   3.817083963170638*^9, 3.817084047868593*^9}, {3.8170840780766172`*^9, 
   3.817084089790744*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"e4b643f5-1735-4f96-a362-d800e1c20e5e"],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"HomI", "[", 
    RowBox[{
    "A", ",", " ", "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", 
     "t2", ",", "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", 
       FractionBox["A", 
        SqrtBox["2"]], "]"}], "\[Rule]", 
      FractionBox["A", 
       SqrtBox["2"]]}], ",", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", 
       FractionBox[
        RowBox[{"-", "A"}], 
        SqrtBox["2"]], "]"}], "\[Rule]", 
      FractionBox[
       RowBox[{"-", "A"}], 
       SqrtBox["2"]]}], " ", ",", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          OverscriptBox["a", "^"], "1"], "+", 
         SubscriptBox[
          OverscriptBox["b", "^"], "1"]}], 
        SqrtBox["2"]], "]"}], "->", 
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox[
          OverscriptBox["a", "^"], "1"], "\[ConjugateTranspose]"}], "+", 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], "1"], "\[ConjugateTranspose]"}]}], 
       SqrtBox["2"]]}], ",", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"-", 
          SubscriptBox[
           OverscriptBox["a", "^"], "1"]}], "+", 
         SubscriptBox[
          OverscriptBox["b", "^"], "1"]}], 
        SqrtBox["2"]], "]"}], "->", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox[
           OverscriptBox["a", "^"], "1"], "\[ConjugateTranspose]"}]}], "+", 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], "1"], "\[ConjugateTranspose]"}]}], 
       SqrtBox["2"]]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.817084069064439*^9, 3.817084113955914*^9}, 
   3.817084154327298*^9, {3.817084193388384*^9, 3.817084196912311*^9}, {
   3.817084294287327*^9, 3.817084398923153*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"aa30cffb-fd8b-44b5-8b90-97912c89ed63"],

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"HomI", "[", 
     RowBox[{
     "A", ",", "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2", 
      ",", "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"ConjugateTranspose", "[", 
        FractionBox["A", 
         SqrtBox["2"]], "]"}], "\[Rule]", 
       FractionBox["A", 
        SqrtBox["2"]]}], ",", 
      RowBox[{
       RowBox[{"ConjugateTranspose", "[", 
        FractionBox[
         RowBox[{"-", "A"}], 
         SqrtBox["2"]], "]"}], "\[Rule]", 
       FractionBox[
        RowBox[{"-", "A"}], 
        SqrtBox["2"]]}]}], " ", "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["n", "^"], "1"], ",", 
     SubscriptBox[
      OverscriptBox["n", "^"], "2"], ",", 
     SubscriptBox[
      OverscriptBox["a", "^"], "1"], ",", 
     SubscriptBox[
      OverscriptBox["a", "^"], "2"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8165659006426907`*^9, 3.816565947389296*^9}, 
   3.816637159822719*^9, {3.816647182709922*^9, 3.8166471846557093`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"cb644b8b-19df-4ee8-b6ef-c20f51269f4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "manual", " ", "manipulation", " ", "of", " ", "the", " ", "above"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"A", " ", 
         FractionBox["1", 
          SqrtBox["2"]], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "r1"}], " ", 
             RowBox[{
              SubscriptBox[
               OverscriptBox["n", "^"], "1"], "\[ConjugateTranspose]"}]}], 
            "-", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", "L", " ", 
                "\[CapitalOmega]"}], "c"]], " ", "r1", " ", 
             SuperscriptBox["r2", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r1", "2"], "+", 
               SuperscriptBox["t1", "2"]}], ")"}], " ", 
             RowBox[{
              SubscriptBox[
               OverscriptBox["n", "^"], "1"], "\[ConjugateTranspose]"}]}], 
            "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "L", " ", 
                "\[CapitalOmega]"}], "c"]], " ", "r2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    SuperscriptBox["r1", "2"]}], "+", 
                    SuperscriptBox["t1", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
                    SuperscriptBox[
                    RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["t1", "2"], " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                   RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
                   RowBox[{"Sinh", "[", 
                    RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}], " ", 
                RowBox[{
                 SubscriptBox[
                  OverscriptBox["n", "^"], "1"], "\[ConjugateTranspose]"}]}], 
               "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["t1", "2"], " ", 
                RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
                RowBox[{"Cosh", "[", "r", "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"Cosh", "[", "r", "]"}]}], " ", 
                   RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                   RowBox[{"Sinh", "[", "r", "]"}]}]}], ")"}], " ", 
                RowBox[{
                 SubscriptBox[
                  OverscriptBox["n", "^"], "2"], 
                 "\[ConjugateTranspose]"}]}]}], ")"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", "L", " ", 
                "\[CapitalOmega]"}], "c"]], " ", 
             SuperscriptBox["r1", "2"], " ", 
             SuperscriptBox["r2", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "L", " ", 
                "\[CapitalOmega]"}], "c"]], " ", "r1", " ", "r2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
               SuperscriptBox[
                RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}]}],
         "+", 
        RowBox[{"A", " ", 
         FractionBox["1", 
          SqrtBox["2"]], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "r1"}], " ", 
             RowBox[{
              SubscriptBox[
               OverscriptBox["n", "^"], "1"], "\[ConjugateTranspose]"}]}], 
            "-", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", "L", " ", 
                "\[CapitalOmega]"}], "c"]], " ", "r1", " ", 
             SuperscriptBox["r2", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r1", "2"], "+", 
               SuperscriptBox["t1", "2"]}], ")"}], " ", 
             RowBox[{
              SubscriptBox[
               OverscriptBox["n", "^"], "1"], "\[ConjugateTranspose]"}]}], 
            "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "L", " ", 
                "\[CapitalOmega]"}], "c"]], " ", "r2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    SuperscriptBox["r1", "2"]}], "+", 
                    SuperscriptBox["t1", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
                    SuperscriptBox[
                    RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["t1", "2"], " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                   RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
                   RowBox[{"Sinh", "[", 
                    RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}], " ", 
                RowBox[{
                 SubscriptBox[
                  OverscriptBox["n", "^"], "1"], "\[ConjugateTranspose]"}]}], 
               "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["t1", "2"], " ", 
                RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
                RowBox[{"Cosh", "[", "r", "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"Cosh", "[", "r", "]"}]}], " ", 
                   RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                   RowBox[{"Sinh", "[", "r", "]"}]}]}], ")"}], " ", 
                RowBox[{
                 SubscriptBox[
                  OverscriptBox["n", "^"], "2"], 
                 "\[ConjugateTranspose]"}]}]}], ")"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", "L", " ", 
                "\[CapitalOmega]"}], "c"]], " ", 
             SuperscriptBox["r1", "2"], " ", 
             SuperscriptBox["r2", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "L", " ", 
                "\[CapitalOmega]"}], "c"]], " ", "r1", " ", "r2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
               SuperscriptBox[
                RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], 
           ")"}]}]}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r1", " ", 
           RowBox[{"(", 
            RowBox[{"-", 
             FractionBox["A", 
              SqrtBox["2"]]}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox["r1", "2"], " ", 
            SuperscriptBox["r2", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", "r1", " ", "r2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
              SuperscriptBox[
               RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
        "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{
             "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
             "c"]], " ", "r1", " ", 
           SuperscriptBox["r2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r1", "2"], "+", 
             SuperscriptBox["t1", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"-", 
             FractionBox["A", 
              SqrtBox["2"]]}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox["r1", "2"], " ", 
            SuperscriptBox["r2", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", "r1", " ", "r2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
              SuperscriptBox[
               RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
        "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r1", " ", 
           FractionBox["A", 
            SqrtBox["2"]]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox["r1", "2"], " ", 
            SuperscriptBox["r2", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", "r1", " ", "r2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
              SuperscriptBox[
               RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
        "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{
             "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
             "c"]], " ", "r1", " ", 
           SuperscriptBox["r2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r1", "2"], "+", 
             SuperscriptBox["t1", "2"]}], ")"}], " ", 
           FractionBox["A", 
            SqrtBox["2"]]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox["r1", "2"], " ", 
            SuperscriptBox["r2", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", "r1", " ", "r2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
              SuperscriptBox[
               RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
        "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{
             "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
             "c"]], " ", "r2", " ", 
           RowBox[{"(", 
            RowBox[{"-", 
             FractionBox["A", 
              SqrtBox["2"]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["r1", "2"]}], "+", 
                SuperscriptBox["t1", "2"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                 SuperscriptBox[
                  RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
                SuperscriptBox[
                 RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["t1", "2"], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
              RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
              RowBox[{"Sinh", "[", 
               RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox["r1", "2"], " ", 
            SuperscriptBox["r2", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", "r1", " ", "r2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
              SuperscriptBox[
               RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
        "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{
             "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
             "c"]], " ", "r2", " ", 
           FractionBox["A", 
            SqrtBox["2"]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["r1", "2"]}], "+", 
                SuperscriptBox["t1", "2"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                 SuperscriptBox[
                  RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
                SuperscriptBox[
                 RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["t1", "2"], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
              RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
              RowBox[{"Sinh", "[", 
               RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox["r1", "2"], " ", 
            SuperscriptBox["r2", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", "r1", " ", "r2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
              SuperscriptBox[
               RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}]}], 
       ")"}], " ", 
      SubscriptBox[
       OverscriptBox["n", "^"], "1"]}], "+", 
     RowBox[{
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
               "c"]], " ", "r2", " ", 
             SuperscriptBox["t1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"-", 
               FractionBox["A", 
                SqrtBox["2"]]}], ")"}], " ", 
             RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
             RowBox[{"Cosh", "[", "r", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Cosh", "[", "r", "]"}]}], " ", 
                RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "+", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                RowBox[{"Sinh", "[", "r", "]"}]}]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{
                "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}],
                 "c"]], " ", 
              SuperscriptBox["r1", "2"], " ", 
              SuperscriptBox["r2", "2"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{
                "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}],
                 "c"]], " ", "r1", " ", "r2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                 SuperscriptBox[
                  RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
                SuperscriptBox[
                 RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
          ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{
             "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
             "c"]], " ", "r2", " ", 
           SuperscriptBox["t1", "2"], " ", 
           FractionBox["A", 
            SqrtBox["2"]], " ", 
           RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
           RowBox[{"Cosh", "[", "r", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Cosh", "[", "r", "]"}]}], " ", 
              RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "+", 
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
              RowBox[{"Sinh", "[", "r", "]"}]}]}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox["r1", "2"], " ", 
            SuperscriptBox["r2", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", "r1", " ", "r2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
              SuperscriptBox[
               RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}]}], 
       ")"}], " ", 
      SubscriptBox[
       OverscriptBox["n", "^"], "2"]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["n", "^"], "1"], ",", 
      SubscriptBox[
       OverscriptBox["n", "^"], "2"], ",", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "1"], "\[ConjugateTranspose]"}], ",", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "2"], "\[ConjugateTranspose]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.816566058372077*^9, 3.81656607224701*^9}, {
  3.8165661046559277`*^9, 3.816566143623317*^9}, {3.816566181967535*^9, 
  3.816566316539776*^9}, {3.8165664073213882`*^9, 3.816566456325416*^9}, {
  3.816566598054826*^9, 3.816566609091715*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"45d4cb00-1792-4b47-87b5-c1477abefbff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"h1", "\[Conjugate]"}], " ", "=", " ", "h3"}], ",", " ", 
    RowBox[{
     RowBox[{"h2", "\[Conjugate]"}], " ", "=", " ", "h4"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"h1", "[", 
      RowBox[{
      "A_", ",", "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", 
       "t2_", ",", "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_"}], "]"}], 
     " ", ":=", " ", 
     RowBox[{
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SqrtBox["2"], " ", "A", " ", "r1"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{
                "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}],
                 "c"]], " ", 
              SuperscriptBox["r1", "2"], " ", 
              SuperscriptBox["r2", "2"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{
                "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}],
                 "c"]], " ", "r1", " ", "r2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                 SuperscriptBox[
                  RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
                SuperscriptBox[
                 RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
          ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SqrtBox["2"], " ", "A", " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{
             "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
             "c"]], " ", "r1", " ", 
           SuperscriptBox["r2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r1", "2"], "+", 
             SuperscriptBox["t1", "2"]}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox["r1", "2"], " ", 
            SuperscriptBox["r2", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", "r1", " ", "r2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
              SuperscriptBox[
               RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
        "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SqrtBox["2"], " ", "A", " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{
             "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
             "c"]], " ", "r2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["r1", "2"]}], "+", 
                SuperscriptBox["t1", "2"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                 SuperscriptBox[
                  RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
                SuperscriptBox[
                 RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["t1", "2"], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
              RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
              RowBox[{"Sinh", "[", 
               RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox["r1", "2"], " ", 
            SuperscriptBox["r2", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", "r1", " ", "r2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
              SuperscriptBox[
               RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"h2", "[", 
      RowBox[{
      "A_", ",", "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", 
       "t2_", ",", "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_"}], "]"}], 
     " ", ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", "A", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{
          "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
          "c"]], " ", "r2", " ", 
        SuperscriptBox["t1", "2"], " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Cosh", "[", "r", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cosh", "[", "r", "]"}]}], " ", 
           RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
           RowBox[{"Sinh", "[", "r", "]"}]}]}], ")"}]}], " ", ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{
           "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
           "c"]], " ", 
         SuperscriptBox["r1", "2"], " ", 
         SuperscriptBox["r2", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{
           "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
           "c"]], " ", "r1", " ", "r2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"h3", "[", 
      RowBox[{
      "A_", ",", "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", 
       "t2_", ",", "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_"}], "]"}], 
     " ", ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"A", " ", "r1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{
                "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}],
                 "c"]}]], " ", 
             SuperscriptBox["r1", "2"], " ", 
             SuperscriptBox["r2", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{
                "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}],
                 "c"]}]], " ", "r1", " ", "r2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
               SuperscriptBox[
                RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
         ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"A", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{
             "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
             "c"]}]], " ", "r1", " ", 
          SuperscriptBox["r2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r1", "2"], "+", 
            SuperscriptBox["t1", "2"]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{
              "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]}]], " ", 
           SuperscriptBox["r1", "2"], " ", 
           SuperscriptBox["r2", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]}]], " ", "r1", " ", "r2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
              SuperscriptBox[
               RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
             SuperscriptBox[
              RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"A", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{
             "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
             "c"]}]], " ", "r2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               SuperscriptBox["t1", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
               SuperscriptBox[
                RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["t1", "2"], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
             RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
             RowBox[{"Sinh", "[", 
              RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{
              "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]}]], " ", 
           SuperscriptBox["r1", "2"], " ", 
           SuperscriptBox["r2", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]}]], " ", "r1", " ", "r2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
              SuperscriptBox[
               RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
             SuperscriptBox[
              RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}]}], 
      ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"h4", "[", 
      RowBox[{
      "A_", ",", "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", 
       "t2_", ",", "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_"}], "]"}], 
     " ", ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", "A", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
           "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
           "c"]}]], " ", "r2", " ", 
        SuperscriptBox["t1", "2"], "  ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Cosh", "[", "r", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cosh", "[", "r", "]"}]}], " ", 
           RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
           RowBox[{"Sinh", "[", "r", "]"}]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
            "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]}]], " ", 
         SuperscriptBox["r1", "2"], " ", 
         SuperscriptBox["r2", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]}]], " ", "r1", " ", "r2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "r", "]"}], "2"]}], ")"}]}]}], ")"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.816566515991489*^9, 3.81656658555836*^9}, {
   3.816647196507629*^9, 3.81664722218342*^9}, {3.816650054179798*^9, 
   3.8166500676139603`*^9}, 3.8166505791208887`*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"8a60897b-b3af-4748-a9bd-44350b15c9e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"checking", " ", "assignment", " ", "of", " ", "h1"}], ",", " ", "...",
     ",", " ", "h4"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"%%%%%", " ", "\[Equal]", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"h1", "[", 
      RowBox[{
      "A", ",", "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2",
        ",", "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}], "  ", 
     SubscriptBox[
      OverscriptBox["n", "^"], "1"]}], "+", 
    RowBox[{
     RowBox[{"h2", "[", 
      RowBox[{
      "A", ",", "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2",
        ",", "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}], "  ", 
     SubscriptBox[
      OverscriptBox["n", "^"], "2"]}], "+", 
    RowBox[{
     RowBox[{"h3", "[", 
      RowBox[{
      "A", ",", "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2",
        ",", "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}], "  ", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["n", "^"], "1"], "\[ConjugateTranspose]"}]}], "+", 
    RowBox[{
     RowBox[{"h4", "[", 
      RowBox[{
      "A", ",", "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2",
        ",", "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}], "  ", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["n", "^"], "2"], 
      "\[ConjugateTranspose]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.816566636760758*^9, 3.816566677605197*^9}, {
  3.816566717132101*^9, 3.816566717695352*^9}, {3.816647243086588*^9, 
  3.816647280360346*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"14cbc816-a21e-47a2-8125-4b3bce994c9c"],

Cell[TextData[Cell[BoxData[{
 RowBox[{
  RowBox[{
  "Now", " ", "we", " ", "wish", " ", "to", " ", "find", " ", "the", " ", "*",
    "Power", "*", " ", "spectral", " ", "density", " ", 
   RowBox[{"(", "PSD", ")"}]}], ",", " ", "S", ",", " ", 
  RowBox[{"of", " ", "the", " ", "homodyne", " ", 
   RowBox[{"intensity", ".", "\[IndentingNewLine]", "However"}]}], ",", " ", 
  RowBox[{
  "be", " ", "warned", " ", "that", " ", "Finesse", " ", "uses", " ", "*", 
   "Amplitude", "*", " ", "spectral", " ", "density", " ", 
   RowBox[{"(", "ASD", ")"}]}], ",", " ", 
  "meaning"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"that", " ", 
   SuperscriptBox["PSD", 
    RowBox[{"1", "/", "2"}]], " ", "is", " ", "taken", " ", "for", " ", "all",
    " ", 
   RowBox[{"plots", ".", "\[IndentingNewLine]", 
    OverscriptBox["HomI", "^"]}]}], "=", 
  RowBox[{
   RowBox[{"h1", 
    SubscriptBox[
     OverscriptBox["n", "^"], "1"]}], "+", 
   RowBox[{"h2", 
    SubscriptBox[
     OverscriptBox["n", "^"], "2"]}], "+", 
   RowBox[{"h3", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["n", "^"], "1"], "\[ConjugateTranspose]"}]}], "+", 
   RowBox[{"h4", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["n", "^"], "2"], "\[ConjugateTranspose]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["S", "HomI"], "[", "\[CapitalOmega]", "]"}], "2", "\[Pi]", 
   RowBox[{"\[Delta]", "[", 
    RowBox[{"\[CapitalOmega]", "-", 
     RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], "=", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"0", "|", 
    RowBox[{
     RowBox[{
      OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], 
     "\[EmptyCircle]", 
     RowBox[{
      RowBox[{
       OverscriptBox["HomI", "^"], "\[ConjugateTranspose]"}], "[", 
      RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "|", "0"}], 
   "\[RightAngleBracket]"}]}], "\n", 
 RowBox[{"=", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"0", "|", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"h1", 
         SubscriptBox[
          OverscriptBox["n", "^"], "1"]}], "+", 
        RowBox[{"h2", 
         SubscriptBox[
          OverscriptBox["n", "^"], "2"]}], "+", 
        RowBox[{"h3", 
         RowBox[{
          SubscriptBox[
           OverscriptBox["n", "^"], "1"], "\[ConjugateTranspose]"}]}], "+", 
        RowBox[{"h4", 
         RowBox[{
          SubscriptBox[
           OverscriptBox["n", "^"], "2"], "\[ConjugateTranspose]"}]}]}], 
       ")"}], "[", "\[CapitalOmega]", "]"}], "\[EmptyCircle]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"h1", 
          SubscriptBox[
           OverscriptBox["n", "^"], "1"]}], "+", 
         RowBox[{"h2", 
          SubscriptBox[
           OverscriptBox["n", "^"], "2"]}], "+", 
         RowBox[{"h3", 
          RowBox[{
           SubscriptBox[
            OverscriptBox["n", "^"], "1"], "\[ConjugateTranspose]"}]}], "+", 
         RowBox[{"h4", 
          RowBox[{
           SubscriptBox[
            OverscriptBox["n", "^"], "2"], "\[ConjugateTranspose]"}]}]}], 
        ")"}], "\[ConjugateTranspose]"}], "[", 
      RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "|", "0"}], 
   "\[RightAngleBracket]"}]}], "\n", 
 RowBox[{"=", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"0", "|", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"h1", "[", "\[CapitalOmega]", "]"}], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"h2", "[", "\[CapitalOmega]", "]"}], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"h3", "[", "\[CapitalOmega]", "]"}], 
        RowBox[{
         RowBox[{
          SubscriptBox[
           OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
         "\[ConjugateTranspose]"}]}], "+", 
       RowBox[{
        RowBox[{"h4", "[", "\[CapitalOmega]", "]"}], 
        RowBox[{
         RowBox[{
          SubscriptBox[
           OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
         "\[ConjugateTranspose]"}]}]}], ")"}], "\[EmptyCircle]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"h1", "\[Conjugate]"}], "[", 
         RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
        RowBox[{
         RowBox[{
          SubscriptBox[
           OverscriptBox["n", "^"], "1"], "[", 
          RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
         "\[ConjugateTranspose]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"h2", "\[Conjugate]"}], "[", 
         RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
        RowBox[{
         RowBox[{
          SubscriptBox[
           OverscriptBox["n", "^"], "2"], "[", 
          RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
         "\[ConjugateTranspose]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"h3", "\[Conjugate]"}], "[", 
         RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["n", "^"], "1"], "[", 
         RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "\[IndentingNewLine]", 
       "+", 
       RowBox[{
        RowBox[{
         RowBox[{"h4", "\[Conjugate]"}], "[", 
         RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["n", "^"], "2"], "[", 
         RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]}], ")"}]}], "|", "0"}], 
   "\[RightAngleBracket]"}]}], "\n", 
 RowBox[{"=", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"0", "|", 
    RowBox[{
     RowBox[{
      RowBox[{"h1", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{
       RowBox[{"h1", "\[Conjugate]"}], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
      "\[EmptyCircle]", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "1"], "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}], "\[ConjugateTranspose]"}]}], 
     "+", 
     RowBox[{
      RowBox[{"h1", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{
       RowBox[{"h3", "\[Conjugate]"}], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
      "\[EmptyCircle]", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "1"], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"h3", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{
       RowBox[{"h1", "\[Conjugate]"}], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
       "\[ConjugateTranspose]"}], "\[EmptyCircle]", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "1"], "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}], "\[ConjugateTranspose]"}]}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{
      RowBox[{"h3", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{
       RowBox[{"h3", "\[Conjugate]"}], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
       "\[ConjugateTranspose]"}], "\[EmptyCircle]", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "1"], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"h2", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{
       RowBox[{"h2", "\[Conjugate]"}], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
      "\[EmptyCircle]", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "2"], "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}], "\[ConjugateTranspose]"}]}], 
     "+", 
     RowBox[{
      RowBox[{"h2", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{
       RowBox[{"h4", "\[Conjugate]"}], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
      "\[EmptyCircle]", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "2"], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "\[IndentingNewLine]", "+", 
     
     RowBox[{
      RowBox[{"h4", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{
       RowBox[{"h2", "\[Conjugate]"}], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
       "\[ConjugateTranspose]"}], "\[EmptyCircle]", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "2"], "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}], "\[ConjugateTranspose]"}]}], 
     "+", 
     RowBox[{
      RowBox[{"h4", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{
       RowBox[{"h4", "\[Conjugate]"}], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
       "\[ConjugateTranspose]"}], "\[EmptyCircle]", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "2"], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]}], "|", "0"}], 
   "\[RightAngleBracket]"}]}], "\n", 
 RowBox[{"=", 
  RowBox[{
   FractionBox["1", "2"], "2", "\[Pi]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"h1", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{
       RowBox[{"h1", "\[Conjugate]"}], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"\[CapitalOmega]", "-", 
        RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"h3", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{
       RowBox[{"h3", "\[Conjugate]"}], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"\[CapitalOmega]", "-", 
        RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"h2", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{
       RowBox[{"h2", "\[Conjugate]"}], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"\[CapitalOmega]", "-", 
        RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"h4", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{
       RowBox[{"h4", "\[Conjugate]"}], "[", 
       RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"\[CapitalOmega]", "-", 
        RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}]}], ")"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   SubscriptBox["S", "HomI"], "[", "\[CapitalOmega]", "]"}], "=", 
  RowBox[{
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"|", 
     RowBox[{"h1", "[", "\[CapitalOmega]", "]"}], 
     SuperscriptBox["|", "2"], 
     RowBox[{"+", 
      RowBox[{"|", 
       RowBox[{"h2", "[", "\[CapitalOmega]", "]"}], 
       SuperscriptBox["|", "2"], 
       RowBox[{"+", 
        RowBox[{"|", 
         RowBox[{"h3", "[", "\[CapitalOmega]", "]"}], 
         SuperscriptBox["|", "2"], 
         RowBox[{"+", 
          RowBox[{"|", 
           RowBox[{"h4", "[", "\[CapitalOmega]", "]"}], 
           SuperscriptBox["|", "2"]}]}]}]}]}]}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.816567702978876*^9, 3.816568072731267*^9}, {
  3.816637200255508*^9, 3.816637238783148*^9}, {3.8166372874244432`*^9, 
  3.816637396980949*^9}, {3.816637433560628*^9, 3.816637510950754*^9}, {
  3.816637542844198*^9, 3.8166376180422497`*^9}, {3.816637662582572*^9, 
  3.816637846119231*^9}, {3.816645878220375*^9, 3.816646006737432*^9}, {
  3.816646106526799*^9, 3.816646117649178*^9}},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"b82e81b7-3936-4804-9754-2ec8426406b2"]], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.816567702978876*^9, 3.816568072731267*^9}, {
  3.816637200255508*^9, 3.816637238783148*^9}, {3.8166372874244432`*^9, 
  3.816637396980949*^9}, {3.816637433560628*^9, 3.816637510950754*^9}, {
  3.816637542844198*^9, 3.8166376180422497`*^9}, {3.816637662582572*^9, 
  3.816637846119231*^9}, {3.816645878220375*^9, 3.816646006737432*^9}, {
  3.816646106526799*^9, 3.816646222487796*^9}, {3.816646342523877*^9, 
  3.816646387882852*^9}, {3.8166489766796207`*^9, 3.8166489837979803`*^9}, {
  3.81708477567971*^9, 3.8170847770698013`*^9}, {3.817149204119978*^9, 
  3.817149255044565*^9}, {3.817149428230565*^9, 
  3.817149431685445*^9}},ExpressionUUID->"9ba97b64-8b39-45f8-aeb4-\
8ba8eee20cae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"on", " ", "resonance", " ", "is", " ", "simply"}], " ", "|", 
     RowBox[{"h1", "[", "\[CapitalOmega]", "]"}], 
     SuperscriptBox["|", "2"], " ", 
     RowBox[{"for", " ", "\[Theta]"}]}], "=", 
    RowBox[{"0", "?"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PSDHomI", "[", 
     RowBox[{
     "A_", ",", "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", 
      "t2_", ",", "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_", ",", 
      "\[Theta]_"}], "]"}], ":=", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"h1", "[", 
          RowBox[{
          "A", ",", "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", 
           "t2", ",", "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}], 
         "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"h2", "[", 
          RowBox[{
          "A", ",", "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", 
           "t2", ",", "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}], 
         "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"h3", "[", 
          RowBox[{
          "A", ",", "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", 
           "t2", ",", "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}], 
         "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"h4", "[", 
          RowBox[{
          "A", ",", "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", 
           "t2", ",", "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}], 
         "]"}], "2"]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ASDHomI", "[", 
     RowBox[{
     "A_", ",", "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", 
      "t2_", ",", "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_", ",", 
      "\[Theta]_"}], "]"}], ":=", 
    SuperscriptBox[
     RowBox[{"PSDHomI", "[", 
      RowBox[{
      "A", ",", "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2",
        ",", "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]", ",", "\[Theta]"}], 
      "]"}], 
     RowBox[{"1", "/", "2"}]]}]}]}]], "Input",
 CellChangeTimes->{{3.816647412853466*^9, 3.816647470633463*^9}, {
  3.8166483032321053`*^9, 3.816648306238543*^9}, {3.816650585030899*^9, 
  3.816650606674087*^9}, {3.81714919875598*^9, 3.817149200112627*^9}, {
  3.817149411682311*^9, 3.817149467113765*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"eb064e5b-8881-446f-8bab-9809d006209a"],

Cell["\<\
Now we have the formula, we make some plots to compare the Finesse model to.\
\>", "Text",
 CellFrame->{{0, 0}, {0, 2}},
 CellChangeTimes->{{3.812654970050468*^9, 3.812654989841116*^9}, 
   3.817085783011344*^9},ExpressionUUID->"e31d93cb-0d55-40e6-ace0-\
da1274d8f67a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "plotting", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cavityLength", " ", "=", " ", "1"}], 
    RowBox[{"(*", "m", "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "inA", ",", "in\[CapitalOmega]", ",", "inr1", ",", "int1", ",", "inr2", 
       ",", "int2", ",", "inL", ",", "in\[Psi]", ",", " ", "inr", ",", " ", 
       "in\[Phi]", ",", "in\[Theta]"}], "}"}], "=", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", 
       SuperscriptBox["0.9", 
        RowBox[{"1", "/", "2"}]], ",", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["inr1", "2"]}], ")"}], 
        RowBox[{"1", "/", "2"}]], ",", "1", ",", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["inr2", "2"]}], ")"}], 
        RowBox[{"1", "/", "2"}]], ",", "cavityLength", ",", "0", ",", "0", 
       ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"ASDHomI", "[", 
     RowBox[{
     "inA", ",", "in\[CapitalOmega]", ",", "inr1", ",", "int1", ",", "inr2", 
      ",", "int2", ",", "inL", ",", "in\[Psi]", ",", " ", "r", ",", " ", 
      "in\[Phi]", ",", "in\[Theta]"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.8171494804355507`*^9, {3.817149743139358*^9, 3.8171499404614687`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"575cbf03-1a99-43b7-8ac1-d1ca33242a9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "threshold", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"rThresh", " ", "=", " ", 
    RowBox[{"ArgMax", "[", 
     RowBox[{
      RowBox[{"ASDHomI", "[", 
       RowBox[{"1", ",", "0", ",", 
        SuperscriptBox["0.9", 
         RowBox[{"1", "/", "2"}]], ",", 
        SuperscriptBox["0.1", 
         RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", "1", ",", "0", 
        ",", "r", ",", "0", ",", "0"}], "]"}], ",", "r"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"ArgMin", "[", 
    RowBox[{
     RowBox[{"ASDHomI", "[", 
      RowBox[{"1", ",", "0", ",", 
       SuperscriptBox["0.9", 
        RowBox[{"1", "/", "2"}]], ",", 
       SuperscriptBox["0.1", 
        RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", "1", ",", "0", ",",
        "r", ",", "0", ",", "0"}], "]"}], ",", "r"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8118118061397543`*^9, 3.811811813598988*^9}, {
  3.8118118591760406`*^9, 3.811811887622908*^9}, {3.811811997451922*^9, 
  3.811812000506147*^9}, {3.811812188692753*^9, 3.811812206195826*^9}, {
  3.811816312413888*^9, 3.811816315701519*^9}, {3.8165647123256283`*^9, 
  3.816564721212694*^9}, {3.8170851818966503`*^9, 3.817085184147587*^9}, {
  3.817085248217803*^9, 3.817085248876066*^9}, {3.817149484592409*^9, 
  3.817149485660955*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"33bca83c-f7af-4665-b875-5dde70dbe811"],

Cell[BoxData[
 RowBox[{"zeroReference", " ", "=", " ", 
  RowBox[{"ASDHomI", "[", 
   RowBox[{
   "inA", ",", "in\[CapitalOmega]", ",", "inr1", ",", "int1", ",", "inr2", 
    ",", "int2", ",", "inL", ",", "in\[Psi]", ",", " ", "0", ",", " ", 
    "in\[Phi]", ",", "in\[Theta]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.812237688451689*^9, 3.812237693833028*^9}, 
   3.8165647197921658`*^9, 3.817085720588335*^9, 3.817149486434153*^9, {
   3.817149976030574*^9, 3.8171499783625174`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"ab79bd3e-b9f5-4e12-aac2-64b2944632a1"],

Cell[BoxData[
 RowBox[{"unityRange", " ", "=", " ", 
  RowBox[{"N", "[", 
   RowBox[{"Log", "[", 
    SuperscriptBox["10", 
     FractionBox["1", "10"]], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.812237816894322*^9, 3.812237845352437*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"eae8476d-62aa-4b67-b90a-73e6b1a92cd0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"LabelStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", "Red", ",", 
      RowBox[{"FontSize", "\[Rule]", "20"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"Plot", ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"FontSize", "\[Rule]", "16"}]}]}], "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8120503341905203`*^9, 3.8120503605581007`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"24285e97-6cf3-48d2-97e8-db58344385a0"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "A_", ",", "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", 
   "t2_", ",", "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_", ",", 
   "\[Theta]_"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8170863113290253`*^9, 3.817086312415701*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"01849c82-87b7-42e6-a416-2eb8c774c565"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "ASD", " ", "vs", " ", "squeezer", " ", "parameter", " ", "r", " ", "for",
      " ", "cavity", " ", "on", " ", "resonance"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "L", " ", "value", " ", "not", " ", "important", " ", "given", " ", 
      "\[CapitalOmega]"}], " ", "=", " ", "0"}], "\[IndentingNewLine]", ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"StringForm", "[", 
      RowBox[{"\"\<threshold at r = ``\>\"", ",", 
       RowBox[{"NumberForm", "[", 
        RowBox[{"rThresh", ",", "3"}], "]"}]}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plot", " ", "=", " ", 
    RowBox[{"Labeled", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"ASDHomI", "[", 
           RowBox[{
           "inA", ",", "in\[CapitalOmega]", ",", "inr1", ",", "int1", ",", 
            "inr2", ",", "int2", ",", "inL", ",", "in\[Psi]", ",", " ", "r", 
            ",", " ", "in\[Phi]", ",", "in\[Theta]"}], "]"}], "/", 
          "zeroReference"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", 
          RowBox[{"-", "unityRange"}], ",", "unityRange"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "None", ",", "\"\<relative abs(ASD of homodyne intensity)\>\""}], 
          "}"}]}], ",", 
        RowBox[{"GridLines", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "rThresh", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "400"}], ",", " ", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"All", ",", "5"}], "}"}]}]}], "]"}], ",", 
      "\"\<squeezer parameter, r\>\""}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<not_main_rel_ASD_vs_r.pdf\>\"", ",", "plot"}], "]"}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"https", ":"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{"gist", ".", "github", ".", "com"}], "/", "padde"}], "/", 
      "2953741"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sqzCavityData", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"plot", ",", 
         RowBox[{
          RowBox[{"Line", "[", "x__", "]"}], "\[Rule]", "x"}], ",", " ", 
         "Infinity"}], "]"}], ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<squeezed_cavity_analytics_homodyne_intensity_vs_sqz_param.csv\>\"", 
      ",", "sqzCavityData"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.8063752577291803`*^9, {3.8063769446460247`*^9, 3.806377201181114*^9}, {
   3.8063772727205544`*^9, 3.806377317398085*^9}, {3.806377474848839*^9, 
   3.806377542079898*^9}, {3.8063775978164387`*^9, 3.806377603553165*^9}, {
   3.8063776339697533`*^9, 3.806377634483274*^9}, {3.8063782457761583`*^9, 
   3.8063782580116997`*^9}, {3.806379761482675*^9, 3.806379765813789*^9}, {
   3.806380325416225*^9, 3.806380407017331*^9}, {3.8063804993468323`*^9, 
   3.806380710838578*^9}, {3.806380829189618*^9, 3.80638084823018*^9}, {
   3.8063811830892153`*^9, 3.8063811832292852`*^9}, 3.8063818423048697`*^9, {
   3.806383341507389*^9, 3.806383364620449*^9}, {3.811812221253193*^9, 
   3.811812221655208*^9}, {3.81181240950137*^9, 3.8118124127188168`*^9}, {
   3.812050316138547*^9, 3.8120503304304657`*^9}, {3.812050375063161*^9, 
   3.812050386255156*^9}, {3.812050834453583*^9, 3.8120508456129713`*^9}, {
   3.812237387822418*^9, 3.812237440901626*^9}, {3.812237518250348*^9, 
   3.8122375583682632`*^9}, {3.812237600065217*^9, 3.8122377091956472`*^9}, {
   3.812237849717722*^9, 3.8122378794005404`*^9}, {3.816309208668706*^9, 
   3.816309210567977*^9}, {3.8163093506907578`*^9, 3.816309365255445*^9}, {
   3.816309441080982*^9, 3.816309441432458*^9}, 3.816564725791791*^9, {
   3.8166499685219316`*^9, 3.8166499720021343`*^9}, {3.816650087456354*^9, 
   3.81665008796109*^9}, 3.817085722026329*^9, {3.8170866129424477`*^9, 
   3.817086613642552*^9}, {3.81708682041039*^9, 3.8170868206075172`*^9}, {
   3.81714950322395*^9, 3.817149536197405*^9}, {3.8171499693749447`*^9, 
   3.817149970649621*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"de8753ae-2adb-4c03-8ba6-a95d2ec0166b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"observe", " ", "if", " ", "limits", " ", "equal"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ASDHomI", "[", 
     RowBox[{"1", ",", "0", ",", 
      SuperscriptBox["0.9", 
       RowBox[{"1", "/", "2"}]], ",", 
      SuperscriptBox["0.1", 
       RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", "1", ",", "0", ",", 
      
      RowBox[{"-", "1"}], ",", "0", ",", "0"}], "]"}], ",", 
    RowBox[{"ASDHomI", "[", 
     RowBox[{"1", ",", "0", ",", 
      SuperscriptBox["0.9", 
       RowBox[{"1", "/", "2"}]], ",", 
      SuperscriptBox["0.1", 
       RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", "1", ",", "0", ",", 
      "1", ",", "0", ",", "0"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8068822193986683`*^9, 3.80688224783069*^9}, {
  3.8068823543670053`*^9, 3.806882362149839*^9}, {3.816564728543611*^9, 
  3.816564729933182*^9}, {3.8171495510113583`*^9, 3.817149553582889*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"1f39fe68-cf08-466b-9d32-55c239f50d2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ASD", " ", "vs", " ", "squeezer", " ", "parameter", " ", "r"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
    "zoomed", " ", "to", " ", "show", " ", "threshold", " ", "spike"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plot", " ", "=", " ", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"ASDHomI", "[", 
       RowBox[{"1", ",", "0", ",", 
        SuperscriptBox["0.9", 
         RowBox[{"1", "/", "2"}]], ",", 
        SuperscriptBox["0.1", 
         RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", "1", ",", "0", 
        ",", "r", ",", "0", ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "0", ",", "0.1"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<squeezer parameter, r\>\"", ",", 
         "\"\<ASD of homodyne intensity\>\""}], "}"}]}], ",", 
      RowBox[{"GridLines", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "rThresh", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "500"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"2", " ", 
          SuperscriptBox["10", "6"]}]}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<threshold (spike in ASD) at (approximately) r = ``\>\"", ",", 
         "rThresh"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{"\"\<not_main_ASD_vs_r_spike.pdf\>\"", ",", "plot"}], "]"}], 
     ";"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.806377329627956*^9, 3.8063773934858713`*^9}, {
   3.8063806965534678`*^9, 3.8063808148679943`*^9}, {3.8063811772475557`*^9, 
   3.806381179542403*^9}, {3.8063813014536467`*^9, 3.806381304568919*^9}, {
   3.811811629763093*^9, 3.811811637425508*^9}, {3.812682893553172*^9, 
   3.812682896133071*^9}, 3.816564733888775*^9, {3.817086831763864*^9, 
   3.8170868323905563`*^9}, {3.8171495579089746`*^9, 
   3.8171495856246843`*^9}, {3.8171496992030363`*^9, 3.81714973727276*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"166c5ca7-33e2-4c50-ad19-4bf3b5289b63"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "ASD", " ", "vs", " ", "frequency", " ", "offset", " ", 
     "\[CapitalOmega]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "exponents", " ", "are", " ", "of", " ", "the", " ", "form", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"\[ImaginaryI]", " ", 
       FractionBox[
        RowBox[{"L", " ", "\[CapitalOmega]"}], "c"]}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NB", ":", " ", 
    RowBox[{
     RowBox[{"1", "/", "20"}], " ", "remains", " ", "the", " ", "factor", " ",
      "even", " ", "after", " ", "conversion", " ", "to", " ", "or", " ", 
     "from", " ", "dB", " ", "by", " ", "properties", " ", "of", " ", 
     "logarithms"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rplt1", ",", "rplt2", ",", "rplt3", ",", "rplt4"}], "}"}], " ",
      "=", " ", 
     RowBox[{"{", 
      RowBox[{"rThresh", ",", 
       RowBox[{"rThresh", "/", "20"}], ",", 
       RowBox[{
        RowBox[{"-", "rThresh"}], "/", "20"}], ",", 
       RowBox[{"-", "rThresh"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"plot", " ", "=", " ", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "ASDOmegaAsVar", "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ASDReducedArgs", "[", 
           RowBox[{"\[CapitalOmega]_", ",", "r_"}], "]"}], ":=", 
          RowBox[{"ASDHomI", "[", 
           RowBox[{
           "inA", ",", "\[CapitalOmega]", ",", "inr1", ",", "int1", ",", 
            "inr2", ",", "int2", ",", "inL", ",", "in\[Psi]", ",", " ", "r", 
            ",", " ", "in\[Phi]", ",", "in\[Theta]"}], "]"}]}], ";", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"ASDReducedArgs", "[", 
                RowBox[{"\[CapitalOmega]", ",", "rplt1"}], "]"}], "/", 
               RowBox[{"ASDReducedArgs", "[", 
                RowBox[{"\[CapitalOmega]", ",", "0"}], "]"}]}], "]"}], ",", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"ASDReducedArgs", "[", 
                RowBox[{"\[CapitalOmega]", ",", "rplt2"}], "]"}], "/", 
               RowBox[{"ASDReducedArgs", "[", 
                RowBox[{"\[CapitalOmega]", ",", "0"}], "]"}]}], "]"}], ",", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"ASDReducedArgs", "[", 
                RowBox[{"\[CapitalOmega]", ",", "0"}], "]"}], "/", 
               RowBox[{"ASDReducedArgs", "[", 
                RowBox[{"\[CapitalOmega]", ",", "0"}], "]"}]}], "]"}], ",", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"ASDReducedArgs", "[", 
                RowBox[{"\[CapitalOmega]", ",", "rplt3"}], "]"}], "/", 
               RowBox[{"ASDReducedArgs", "[", 
                RowBox[{"\[CapitalOmega]", ",", "0"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"ASDReducedArgs", "[", 
                RowBox[{"\[CapitalOmega]", ",", "rplt4"}], "]"}], "/", 
               RowBox[{"ASDReducedArgs", "[", 
                RowBox[{"\[CapitalOmega]", ",", "0"}], "]"}]}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalOmega]", ",", "0", ",", 
             RowBox[{"5", " ", 
              SuperscriptBox["10", "9"]}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotLegends", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<r=``\>\"", ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{"rplt1", ",", "3"}], "]"}]}], "]"}], ",", 
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<r=``\>\"", ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{"rplt2", ",", "3"}], "]"}]}], "]"}], ",", 
              "\"\<r=0\>\"", ",", 
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<r=``\>\"", ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{"rplt3", ",", "3"}], "]"}]}], "]"}], ",", 
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<r=``\>\"", ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{"rplt4", ",", "3"}], "]"}]}], "]"}]}], "}"}]}], ",", 
           
           RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<angular frequency, \[CapitalOmega] / Hz\>\"", ",", 
        "\"\<Abs of relative ASD of\\nhomodyne intensity\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", " ", "Left"}], "}"}], ",", 
      RowBox[{"RotateLabel", "\[Rule]", "True"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"StringForm", "[", 
      RowBox[{"\"\<threshold at r = ``, cavity length L = `` m\>\"", ",", 
       RowBox[{"NumberForm", "[", 
        RowBox[{"rThresh", ",", "3"}], "]"}], ",", "cavityLength"}], "]"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<not_main_rel_ASD_vs_freq.pdf\>\"", ",", "plot"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzVtI02EABfD1R7qgpE3zUhZaSqlZQReTkJiYRQ2bs3wwrbEyDSPNls5b
eUG8zGg1YrrNDFempDRdWnNDbdpw6aKUFO+iKGKzodikMuo738Ph93AOHF9h
Kj+RYbFYx0ig4yvdiHu8leMg3jUKXWI9JqHU/m8JPju0ZIfszveMB3E8bosj
bNro5QQj5GdcYDZvyhV2+PTsgWEKiz9s6Jo7AmfmtSeggjd7Cp694nUehicl
X4CT3OM8+DKTdQlKck5fpj8t24RwyPbrOqyMZlJg49eJXKjOfFMMkz+o1FBX
4d0IeY/KmuDFSHMzzJf3t8JA3cl2OBqnMMDI773ddGdyH4QOA9U+nkS9KWgv
7M1YuwmTtTEZUMN1LYRmPbcUJt2JeAjdZB3U3ZbAp9Bor6Kmr6dUQXZYiZL2
IcJhOJ4vpgrWjNOQt2GOmj7o/NaLuFqb0AmDLMJuWFGQ9xHmty2aoX7Z0gcN
t+SLMuKU5LUVrlzVrsCB/XZqqDLYsDXByvGzplH57ySauzfIf0i1Fk6O+YpE
xPXP3VS3HKMYVsrrsmDfSHse3MH5ST061KCEuft6qOxmM/8e0eTpFEPVljyA
NmdZERTPCGIyiM/VX2Jh/Wr4pwWiqEtggb8jYr9Btz/GYbg5cWIKeh6Omoal
Uv95GMi0LcCQ+y5LML5/uw2WVTK2A6lWzrnWGmr0aCY7mDgze80b6gLK/aHf
amgAVGnUrGJiFjeegS2DtxOK0qycH+UF1GxjmQ3K6l8sw6zHeU9qiTUHA5Rw
LKXwL1QJmZ1qYpxAw9QRpaLlTfA/rLKm5g==
  "],
 CellLabel->"In[97]:=",ExpressionUUID->"ed2f248c-3756-498a-a711-24626c76117f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sqzCavityFreqData", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "ASDOmegaAsVar", "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"ASDReducedArgs", "[", 
          RowBox[{"\[CapitalOmega]_", ",", "r_"}], "]"}], ":=", 
         RowBox[{"ASDHomI", "[", 
          RowBox[{
          "inA", ",", "\[CapitalOmega]", ",", "inr1", ",", "int1", ",", 
           "inr2", ",", "int2", ",", "inL", ",", "in\[Psi]", ",", " ", "r", 
           ",", " ", "in\[Phi]", ",", "in\[Theta]"}], "]"}]}], ";", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]", ",", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"ASDReducedArgs", "[", 
             RowBox[{"\[CapitalOmega]", ",", "rplt1"}], "]"}], "/", 
            RowBox[{"ASDReducedArgs", "[", 
             RowBox[{"\[CapitalOmega]", ",", "0"}], "]"}]}], "]"}], ",", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"ASDReducedArgs", "[", 
             RowBox[{"\[CapitalOmega]", ",", "rplt2"}], "]"}], "/", 
            RowBox[{"ASDReducedArgs", "[", 
             RowBox[{"\[CapitalOmega]", ",", "0"}], "]"}]}], "]"}], ",", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"ASDReducedArgs", "[", 
             RowBox[{"\[CapitalOmega]", ",", "0"}], "]"}], "/", 
            RowBox[{"ASDReducedArgs", "[", 
             RowBox[{"\[CapitalOmega]", ",", "0"}], "]"}]}], "]"}], ",", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"ASDReducedArgs", "[", 
             RowBox[{"\[CapitalOmega]", ",", "rplt3"}], "]"}], "/", 
            RowBox[{"ASDReducedArgs", "[", 
             RowBox[{"\[CapitalOmega]", ",", "0"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"ASDReducedArgs", "[", 
             RowBox[{"\[CapitalOmega]", ",", "rplt4"}], "]"}], "/", 
            RowBox[{"ASDReducedArgs", "[", 
             RowBox[{"\[CapitalOmega]", ",", "0"}], "]"}]}], "]"}]}], 
         "}"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[CapitalOmega]", ",", 
       SuperscriptBox["10", "7"], ",", 
       RowBox[{"5", " ", 
        SuperscriptBox["10", "9"]}], ",", 
       SuperscriptBox["10", "7"]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<squeezed_cavity_analytics_homodyne_intensity_vs_freq.csv\>\"", ",", 
    "sqzCavityFreqData"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.816384358214197*^9, 3.816384452143763*^9}, 
   3.816384522021028*^9, {3.8165647589532557`*^9, 3.816564765520176*^9}, {
   3.817086870431662*^9, 3.81708688882355*^9}, {3.81714961121774*^9, 
   3.817149614135893*^9}, {3.817150725603024*^9, 3.8171507566704483`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"82d7234b-914e-4365-b123-5f64181a4e0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "investigating", " ", "the", " ", "analytics", " ", "with", " ", 
    "squeezing", " ", "turned", " ", "off"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"ASDHomI", "[", 
      RowBox[{"1", ",", "\[CapitalOmega]", ",", 
       SuperscriptBox["0.9", 
        RowBox[{"1", "/", "2"}]], ",", 
       SuperscriptBox["0.1", 
        RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", "cavityLength", 
       ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[CapitalOmega]", ",", 
      SuperscriptBox["10", "7"], ",", 
      RowBox[{"5", " ", 
       SuperscriptBox["10", "9"]}]}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.5", "-", 
        SuperscriptBox["10", 
         RowBox[{"-", "13"}]]}], ",", 
       RowBox[{"0.5", "+", 
        SuperscriptBox["10", 
         RowBox[{"-", "13"}]]}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.816388139958441*^9, 3.816388149371015*^9}, {
   3.816388372189062*^9, 3.816388400908605*^9}, {3.816388510145032*^9, 
   3.816388519877063*^9}, {3.816390770163966*^9, 3.816390794107956*^9}, {
   3.816390855919786*^9, 3.816390867901886*^9}, 3.816564770328477*^9, {
   3.817086893338678*^9, 3.817086920258191*^9}, 3.817149615345457*^9},
 CellLabel->"In[54]:=",ExpressionUUID->"7e156740-9178-432c-be9e-546b2f0ce584"],

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{"ASDHomI", "[", 
   RowBox[{"1", ",", "\[CapitalOmega]", ",", 
    SuperscriptBox["0.9", 
     RowBox[{"1", "/", "2"}]], ",", 
    SuperscriptBox["0.1", 
     RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", "cavityLength", ",", 
    "0", ",", "0", ",", "0", ",", "0"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8163884690645323`*^9, 3.816388492916876*^9}, 
   3.816388534431218*^9, 3.8165647713505487`*^9, 3.8171496179111357`*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"e896be03-7a35-48dd-befe-77ac387bcbf5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"noSqzCavityFreqData", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalOmega]", ",", 
       RowBox[{"Abs", "[", 
        RowBox[{"ASDHomI", "[", 
         RowBox[{"1", ",", "\[CapitalOmega]", ",", 
          SuperscriptBox["0.9", 
           RowBox[{"1", "/", "2"}]], ",", 
          SuperscriptBox["0.1", 
           RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", "cavityLength", 
          ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\[CapitalOmega]", ",", 
       SuperscriptBox["10", "7"], ",", 
       RowBox[{"5", " ", 
        SuperscriptBox["10", "9"]}], ",", 
       SuperscriptBox["10", "7"]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<empty_cavity_analytics_homodyne_intensity_vs_freq.csv\>\"", ",", 
    "noSqzCavityFreqData"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.816388089222328*^9, 3.816388128844454*^9}, 
   3.816564773383239*^9, 3.817149618648995*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"22d83244-2ff3-4a99-bf67-3d8e77f9e007"],

Cell[BoxData[
 RowBox[{"ArgMax", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"ASDHomI", "[", 
       RowBox[{"1", ",", "\[CapitalOmega]", ",", 
        SuperscriptBox["0.9", 
         RowBox[{"1", "/", "2"}]], ",", 
        SuperscriptBox["0.1", 
         RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", "cavityLength", 
        ",", "0", ",", "rplt1", ",", "0", ",", "0"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"0.5", " ", 
       SuperscriptBox["10", "9"]}], "<", "\[CapitalOmega]", "<", 
      RowBox[{"1.5", " ", 
       SuperscriptBox["10", "9"]}]}]}], "}"}], ",", "\[CapitalOmega]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.811820004447857*^9, 3.811820041051374*^9}, {
   3.811820082180189*^9, 3.811820083817409*^9}, {3.811820147950119*^9, 
   3.811820241054851*^9}, 3.816564775152843*^9, 3.817149619452973*^9},
 CellLabel->"In[58]:=",ExpressionUUID->"dff21c90-5ecd-40da-82a4-2ba589148ed4"],

Cell[BoxData[
 RowBox[{"ArgMin", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"ASDHomI", "[", 
       RowBox[{"1", ",", "\[CapitalOmega]", ",", 
        SuperscriptBox["0.9", 
         RowBox[{"1", "/", "2"}]], ",", 
        SuperscriptBox["0.1", 
         RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", "cavityLength", 
        ",", "0", ",", "rplt4", ",", "0", ",", "0"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"0.5", " ", 
       SuperscriptBox["10", "9"]}], "<", "\[CapitalOmega]", "<", 
      RowBox[{"1.5", " ", 
       SuperscriptBox["10", "9"]}]}]}], "}"}], ",", "\[CapitalOmega]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.812506581409718*^9, 3.8125065949962883`*^9}, 
   3.816564776183435*^9, 3.817149619900421*^9},
 CellLabel->"In[59]:=",ExpressionUUID->"2303c239-ddb2-4e0a-8f33-c8cf1586c141"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"todo", " ", 
   RowBox[{"NB", ":", " ", 
    RowBox[{
     RowBox[{"figure", " ", "out", " ", "why", " ", "at", " ", "anti"}], "-", 
     
     RowBox[{
     "resonance", " ", "the", " ", "values", " ", "do", " ", "not", " ", 
      "attain", " ", "0.5", "\[IndentingNewLine]", 
      RowBox[{"hasn", "'"}], "t", " ", "this", " ", "been", " ", "fixed", " ",
       "by", " ", "the", " ", 
      RowBox[{"above", "?"}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.806633727547895*^9, 3.806633753745229*^9}, {
  3.807578142432323*^9, 3.807578150204835*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"ced4c42b-09cb-4e6d-86b7-21fb079e422c"],

Cell[BoxData[
 RowBox[{"  ", 
  RowBox[{"(*", 
   RowBox[{"relative", " ", "noise", " ", 
    FractionBox[
     RowBox[{"S", "[", 
      RowBox[{"r", "=", "rThresh"}], "]"}], 
     RowBox[{"S", "[", 
      RowBox[{"r", "=", "0"}], "]"}]], " ", "vs", " ", "frequency", " ", 
    "\[CapitalOmega]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plot", " ", "=", " ", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"ASDHomI", "[", 
           RowBox[{"1", ",", "\[CapitalOmega]", ",", 
            SuperscriptBox["0.9", 
             RowBox[{"1", "/", "2"}]], ",", 
            SuperscriptBox["0.1", 
             RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", 
            "cavityLength", ",", "0", ",", "rThresh", ",", 
            FractionBox["\[Pi]", "2"], ",", "0"}], "]"}], "/", 
          RowBox[{"ASDHomI", "[", 
           RowBox[{"1", ",", "\[CapitalOmega]", ",", 
            SuperscriptBox["0.9", 
             RowBox[{"1", "/", "2"}]], ",", 
            SuperscriptBox["0.1", 
             RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", 
            "cavityLength", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}],
          "]"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"ASDHomI", "[", 
           RowBox[{"1", ",", "\[CapitalOmega]", ",", 
            SuperscriptBox["0.9", 
             RowBox[{"1", "/", "2"}]], ",", 
            SuperscriptBox["0.1", 
             RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", 
            "cavityLength", ",", "0", ",", "rThresh", ",", "0", ",", "0"}], 
           "]"}], "/", 
          RowBox[{"ASDHomI", "[", 
           RowBox[{"1", ",", "\[CapitalOmega]", ",", 
            SuperscriptBox["0.9", 
             RowBox[{"1", "/", "2"}]], ",", 
            SuperscriptBox["0.1", 
             RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", 
            "cavityLength", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}],
          "]"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"ASDHomI", "[", 
           RowBox[{"1", ",", "\[CapitalOmega]", ",", 
            SuperscriptBox["0.9", 
             RowBox[{"1", "/", "2"}]], ",", 
            SuperscriptBox["0.1", 
             RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", 
            "cavityLength", ",", "0", ",", 
            RowBox[{"-", "rThresh"}], ",", "0", ",", "0"}], "]"}], "/", 
          RowBox[{"ASDHomI", "[", 
           RowBox[{"1", ",", "\[CapitalOmega]", ",", 
            SuperscriptBox["0.9", 
             RowBox[{"1", "/", "2"}]], ",", 
            SuperscriptBox["0.1", 
             RowBox[{"1", "/", "2"}]], ",", "1", ",", "0", ",", 
            "cavityLength", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}],
          "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[CapitalOmega]", ",", "0", ",", 
        RowBox[{"5", " ", 
         SuperscriptBox["10", "9"]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<angular frequency, \[CapitalOmega] / Hz\>\"", ",", 
         "\"\<Abs of relative noise in homodyne intensity\>\""}], "}"}]}], 
      ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<threshold at r = ``, cavity length L = `` m\>\"", ",", "rThresh",
          ",", "cavityLength"}], "]"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "2"}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<+\!\(\*SubscriptBox[\(r\), \(Thresh\)]\), \[Phi] = \
\!\(\*FractionBox[\(\[Pi]\), \(2\)]\)\>\"", ",", 
         "\"\<+\!\(\*SubscriptBox[\(r\), \(Thresh\)]\), \[Phi] = 0\>\"", ",", 
         "\"\<-\!\(\*SubscriptBox[\(r\), \(Thresh\)]\), \[Phi] = 0\>\""}], 
        "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Blue", ",", "Dashed"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{"\"\<not_main_relative_noise_vs_freq.pdf\>\"", ",", "plot"}], 
      "]"}], ";"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{
  3.806378376107194*^9, {3.806381583240574*^9, 3.806381712454879*^9}, {
   3.806381761137333*^9, 3.806381835219141*^9}, {3.806629727472595*^9, 
   3.8066297451372423`*^9}, {3.8066297764090776`*^9, 3.806629828501086*^9}, {
   3.80662986904792*^9, 3.806629971078545*^9}, {3.806630016945763*^9, 
   3.8066300432686787`*^9}, {3.806630085492319*^9, 3.806630162142193*^9}, {
   3.806630198510263*^9, 3.806630199776636*^9}, {3.806630229887113*^9, 
   3.806630230720895*^9}, {3.806630274769596*^9, 3.8066302853938217`*^9}, {
   3.806633379678844*^9, 3.806633382471661*^9}, {3.807237974246765*^9, 
   3.8072380123407803`*^9}, {3.807238097537736*^9, 3.80723811511458*^9}, {
   3.807238846452816*^9, 3.807238847419221*^9}, {3.812655929405755*^9, 
   3.8126559307674932`*^9}, {3.81268292444036*^9, 3.8126829268917313`*^9}, {
   3.816564778894408*^9, 3.816564782284815*^9}, {3.817149620683342*^9, 
   3.817149622786639*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"b4e0a5aa-a2d1-4ea9-a3fb-6a3e1e6cdbd9"],

Cell["\<\
For the report, we also want a plot of the circulating power in an empty \
cavity.\
\>", "Text",
 CellChangeTimes->{{3.812655022608279*^9, 3.8126550388559093`*^9}, {
  3.817085803504723*^9, 
  3.817085813769052*^9}},ExpressionUUID->"61d11c4d-845b-4b66-a54d-\
798e8cde0bdf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "relative", " ", "circulating", " ", "power", " ", "in", " ", 
    "overcoupled", " ", "cavity"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"circRelAmp", " ", "=", 
    RowBox[{
     RowBox[{"(", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "2", " ", "k", " ", "d"}], 
         "]"}], "\[ImaginaryI]", " ", "r2", " ", "t1"}], 
       RowBox[{"1", " ", "-", " ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "2", " ", "k", " ", "d"}], 
          "]"}], "r1", " ", "r2"}]}]], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k", " ", "d"}], " ", "\[Rule]", " ", 
       FractionBox[
        RowBox[{"\[CapitalOmega]", " ", "L", " "}], "c"]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"circRelAmpPlotter", "[", "\[CapitalOmega]_", "]"}], " ", ":=", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
            "c"]}]], " ", "r2", " ", "t1"}], 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{
             "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
             "c"]}]], " ", "r1", " ", "r2"}]}]], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{"t1", "\[Rule]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["r1", "2"]}], ")"}], 
         RowBox[{"1", "/", "2"}]]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L", "\[Rule]", "1"}], ",", " ", 
       RowBox[{"r1", "\[Rule]", 
        SuperscriptBox["0.9", 
         RowBox[{"1", "/", "2"}]]}], ",", 
       RowBox[{"r2", "\[Rule]", "1"}], ",", " ", 
       RowBox[{"c", "\[Rule]", 
        RowBox[{"3", " ", 
         SuperscriptBox["10", "8"]}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"plot", " ", "=", " ", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          RowBox[{"circRelAmpPlotter", "[", "\[CapitalOmega]", "]"}], "]"}], 
         "2"], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]", ",", " ", "0", ",", " ", 
          RowBox[{"2.5", " ", 
           SuperscriptBox["10", "9"]}]}], "}"}], ",", " ", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
        RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<angular frequency, \[CapitalOmega] / Hz\>\"", ",", 
        "\"\<relative power of circulating field\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Bottom", ",", " ", "Left"}], "}"}], ",", 
      RowBox[{"RotateLabel", "\[Rule]", "True"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<not_main_relative_circ_vs_freq.pdf\>\"", ",", "plot"}], 
     "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.807584289131544*^9, 3.807584289790142*^9}, {
   3.812486759872653*^9, 3.81248681365271*^9}, {3.812486844519082*^9, 
   3.812486867504752*^9}, {3.812486900900672*^9, 3.812487233382599*^9}, {
   3.812487263456245*^9, 3.812487354323683*^9}, {3.812487532314536*^9, 
   3.8124876039495153`*^9}, {3.812487656956622*^9, 3.8124876694553127`*^9}, {
   3.812488366575141*^9, 3.812488368317893*^9}, {3.812489170598131*^9, 
   3.8124891713016663`*^9}, {3.812489204146187*^9, 3.812489212814372*^9}, 
   3.81248952644004*^9},
 CellLabel->"In[62]:=",ExpressionUUID->"c3c04aa3-bc0b-44b4-93c8-b520cf69554e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "calculating", " ", "the", " ", "finesse", " ", "of", " ", "the", " ", 
    "cavity"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{"2", " ", "\[Pi]", 
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox["10", "8"]}], 
      RowBox[{"2", "  ", "1"}]]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{"circRelAmpPlotter", "[", "\[CapitalOmega]", "]"}], "]"}], 
      "2"], ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[CapitalOmega]", ",", " ", 
       RowBox[{"9", " ", 
        SuperscriptBox["10", "8"]}], ",", " ", 
       RowBox[{"1", " ", 
        SuperscriptBox["10", "9"]}]}], "}"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
   
   RowBox[{"FSR", " ", "=", " ", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", " ", "\[Pi]"}]], 
     RowBox[{"NArgMax", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           RowBox[{"circRelAmpPlotter", "[", "\[CapitalOmega]", "]"}], "]"}], 
          "2"], ",", " ", 
         RowBox[{
          RowBox[{"9", " ", 
           SuperscriptBox["10", "8"]}], "<", "\[CapitalOmega]", "<", 
          RowBox[{"1", " ", 
           SuperscriptBox["10", "9"]}]}]}], "}"}], ",", " ", 
       "\[CapitalOmega]"}], "]"}]}]}], "\[IndentingNewLine]", 
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     RowBox[{"circRelAmpPlotter", "[", 
      RowBox[{"9.346", " ", 
       SuperscriptBox["10", "8"]}], "]"}], "]"}], "2"], "\[IndentingNewLine]", 
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     RowBox[{"circRelAmpPlotter", "[", 
      RowBox[{"9.5035", " ", 
       SuperscriptBox["10", "8"]}], "]"}], "]"}], "2"], "\[IndentingNewLine]", 
   RowBox[{"FWHM", " ", "=", " ", 
    RowBox[{
     RowBox[{"9.5035", " ", 
      SuperscriptBox["10", "8"]}], " ", "-", " ", 
     RowBox[{"9.346", " ", 
      SuperscriptBox["10", "8"]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"finesse", " ", "=", " ", 
    FractionBox["FSR", "FWHM"]}]}]}]], "Input",
 CellChangeTimes->{{3.8124881303271847`*^9, 3.812488158966647*^9}, {
  3.812489176710105*^9, 3.8124891922447433`*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"cf1ce9ea-fa8b-4399-b4a6-e435eb12d358"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"troubleshooting", " ", "analytics"}], ",", " ", 
    RowBox[{
     RowBox[{
     "comparing", " ", "empty", " ", "cavity", " ", "solution", " ", "to", 
      " ", "Finesse", "\[IndentingNewLine]", "we", " ", "consider", " ", "a", 
      " ", "laser", " ", "input", " ", "P", " ", "to", " ", "the", " ", 
      "cavity", " ", "and", " ", "compute", " ", "the", " ", "reflected", " ",
       "power", " ", "given", " ", "the", " ", "input", " ", "of"}], " ", "|", 
     SubscriptBox["P", "0"], 
     SuperscriptBox["|", "2"]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "switching", " ", "over", " ", "to", " ", "degrees", " ", "to", " ", 
    "compare", " ", "to", " ", "Finesse"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"emptyReflVec", "[", 
     RowBox[{
     "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",", 
      "L_", ",", "deg\[Psi]_", ",", "P_", ",", "deg\[Theta]_"}], "]"}], " ", ":=",
     " ", 
    RowBox[{
     RowBox[{"areflvec", "[", 
      RowBox[{
      "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",", "L",
        ",", 
       RowBox[{"deg\[Psi]", "*", 
        FractionBox["\[Pi]", "180"]}], ",", "0", ",", "0"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "1"], "\[Rule]", 
        RowBox[{
         SuperscriptBox["P", 
          RowBox[{"1", "/", "2"}]], 
         RowBox[{"Cos", "[", 
          RowBox[{"deg\[Theta]", "*", 
           FractionBox["\[Pi]", "180"]}], "]"}]}]}], ",", "  ", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "2"], "\[Rule]", 
        RowBox[{
         SuperscriptBox["P", 
          RowBox[{"1", "/", "2"}]], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"deg\[Theta]", "*", 
           FractionBox["\[Pi]", "180"]}], "]"}]}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"complex", " ", "amplitude"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"NB", ":", " ", 
      RowBox[{
       RowBox[{"used", " ", "quad1"}], " ", "+", " ", 
       RowBox[{"\[ImaginaryI]", " ", "quad2", " ", "here"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"instead", " ", "of", " ", "quad1"}], " ", "-", " ", 
      RowBox[{
      "\[ImaginaryI]", " ", "quad2", " ", "used", " ", "in", " ", 
       "Finesse"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"emptyReflComplexAmp", "[", 
     RowBox[{
     "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",", 
      "L_", ",", "deg\[Psi]_", ",", "P_", ",", "deg\[Theta]_"}], "]"}], " ", ":=", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"emptyReflVec", "[", 
          RowBox[{
          "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",", 
           "L", ",", "deg\[Psi]", ",", "P", ",", "deg\[Theta]"}], "]"}], "[", 
         
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"emptyReflVec", "[", 
           RowBox[{
           "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",",
             "L", ",", "deg\[Psi]", ",", "P", ",", "deg\[Theta]"}], "]"}], 
          "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mod", " ", "sqr", " ", "of", " ", "complex", " ", 
     RowBox[{"amp", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"emptyReflPower", "[", 
     RowBox[{
     "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",", 
      "L_", ",", "deg\[Psi]_", ",", "P_", ",", "deg\[Theta]_"}], "]"}], " ", ":=", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"emptyReflComplexAmp", "[", 
       RowBox[{
       "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",", 
        "L", ",", "deg\[Psi]", ",", "P", ",", "deg\[Theta]"}], "]"}], "]"}], 
     "2"]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"arg", " ", "of", " ", "complex", " ", 
     RowBox[{"amp", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"emptyReflArg", "[", 
     RowBox[{
     "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",", 
      "L_", ",", "deg\[Psi]_", ",", "P_", ",", "deg\[Theta]_"}], "]"}], "  ", 
    ":=", " ", 
    RowBox[{"Arg", "[", 
     RowBox[{"emptyReflComplexAmp", "[", 
      RowBox[{
      "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",", "L",
        ",", "deg\[Psi]", ",", "P", ",", "deg\[Theta]"}], "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.816469604645896*^9, 3.81646971053815*^9}, {
  3.816469742165065*^9, 3.816469898176112*^9}, {3.816473123195179*^9, 
  3.816473166761504*^9}, {3.816474015040942*^9, 3.8164740228819313`*^9}, {
  3.816890795789229*^9, 3.816890825308835*^9}, {3.816890858111442*^9, 
  3.81689087069951*^9}, {3.816890937733367*^9, 3.816890946357593*^9}, {
  3.8168910687618017`*^9, 3.816891083818831*^9}, {3.8168913192293043`*^9, 
  3.816891328417974*^9}, {3.816891389156515*^9, 3.816891463903368*^9}, {
  3.816891589064281*^9, 3.816891606794725*^9}, {3.816892000778088*^9, 
  3.816892008375222*^9}, {3.816892987192397*^9, 3.816893049784449*^9}, {
  3.8168931227401953`*^9, 3.816893135472253*^9}, {3.816893287118176*^9, 
  3.816893297509818*^9}, {3.816894773051602*^9, 3.816894839521957*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"e39c96db-c350-4836-93c5-af1a41425e58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "plotting", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "in\[CapitalOmega]", ",", "inr1", ",", "int1", ",", "inr2", ",", "int2",
        ",", "inL", ",", "indeg\[Psi]", ",", "inP", ",", "indeg\[Theta]"}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "\[Pi]", " ", "123", " ", 
        SuperscriptBox["10", "6"]}], ",", 
       SuperscriptBox["0.81", 
        RowBox[{"1", "/", "2"}]], ",", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["inr1", "2"]}], ")"}], 
        RowBox[{"1", "/", "2"}]], ",", 
       SuperscriptBox["0.9", 
        RowBox[{"1", "/", "2"}]], ",", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["inr2", "2"]}], ")"}], 
        RowBox[{"1", "/", "2"}]], ",", "1", ",", "None", ",", "2.5", ",", 
       "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"imageSize", " ", "=", " ", "300"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot1", " ", "=", " ", 
     RowBox[{"Labeled", "[", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"emptyReflPower", "[", 
          RowBox[{
          "in\[CapitalOmega]", ",", "inr1", ",", "int1", ",", "inr2", ",", 
           "int2", ",", "inL", ",", "deg\[Psi]", ",", "inP", ",", 
           "indeg\[Theta]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"deg\[Psi]", ",", 
           RowBox[{"-", "90"}], ",", "90"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "inP"}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "imageSize"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<tuning, \[Psi] / (deg)\>\"", ",", "\"\<refl. power / W(?)\>\""}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Bottom", ",", "Left"}], "}"}], ",", 
       RowBox[{"RotateLabel", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot2", " ", "=", " ", 
     RowBox[{"Labeled", "[", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"emptyReflComplexAmp", "[", 
           RowBox[{
           "in\[CapitalOmega]", ",", "inr1", ",", "int1", ",", "inr2", ",", 
            "int2", ",", "inL", ",", "deg\[Psi]", ",", "inP", ",", 
            "indeg\[Theta]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"deg\[Psi]", ",", 
           RowBox[{"-", "90"}], ",", "90"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            SuperscriptBox["inP", 
             RowBox[{"1", "/", "2"}]]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "imageSize"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<tuning, \[Psi] / (deg)\>\"", ",", 
         "\"\<refl. amp / \!\(\*SuperscriptBox[\(W\), \(1/2\)]\)(?)\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Bottom", ",", "Left"}], "}"}], ",", 
       RowBox[{"RotateLabel", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot3", " ", "=", 
     RowBox[{"Labeled", "[", " ", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"emptyReflArg", "[", 
          RowBox[{
          "in\[CapitalOmega]", ",", "inr1", ",", "int1", ",", "inr2", ",", 
           "int2", ",", "inL", ",", "deg\[Psi]", ",", "inP", ",", 
           "indeg\[Theta]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"deg\[Psi]", ",", 
           RowBox[{"-", "90"}], ",", "90"}], "}"}], ",", " ", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "\[Pi]"}], ",", " ", "\[Pi]"}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "imageSize"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<tuning, \[Psi] / (deg)\>\"", ",", 
         "\"\<refl. phase / (rad)\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Bottom", ",", "Left"}], "}"}], ",", 
       RowBox[{"RotateLabel", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"combinedPlot", "=", " ", 
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"plot1", ",", "plot2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\>\"", ",", "plot3"}], "}"}]}], "}"}], ",", 
      RowBox[{"Spacings", "\[Rule]", "0"}]}], "]"}]}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<not_main_empty_cavity.pdf\>\"", ",", "combinedPlot"}], 
     "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8164761096870403`*^9, 3.816476116299653*^9}, {
   3.8164761626290627`*^9, 3.816476193725758*^9}, {3.816476298389929*^9, 
   3.8164763148578157`*^9}, 3.8164769082453136`*^9, {3.816477461450184*^9, 
   3.816477461644145*^9}, {3.816565308740861*^9, 3.816565330842079*^9}, {
   3.816891478334331*^9, 3.8168915387408953`*^9}, 3.816891609399633*^9, {
   3.8168917542649097`*^9, 3.8168918569363003`*^9}, {3.8168918887094297`*^9, 
   3.816891925670043*^9}, {3.8168919995829277`*^9, 3.816892208388556*^9}, {
   3.816892245599347*^9, 3.816892329137685*^9}, {3.8168923600479803`*^9, 
   3.816892478742352*^9}, {3.816892720086111*^9, 3.816892748945424*^9}, {
   3.816892818718052*^9, 3.816892861929491*^9}, {3.8168929108151493`*^9, 
   3.816892948825074*^9}, {3.816893051974522*^9, 3.816893104870957*^9}, {
   3.816893334994033*^9, 3.816893344566169*^9}, 3.8168934057625303`*^9, {
   3.816893508419105*^9, 3.816893541561516*^9}, {3.816893674340289*^9, 
   3.816893711656595*^9}, {3.8168937643853703`*^9, 3.816893767695788*^9}, {
   3.816893844679397*^9, 3.816893881151293*^9}, {3.816894097814427*^9, 
   3.816894105715728*^9}, {3.8168941720685043`*^9, 3.816894191364094*^9}, {
   3.816894258250576*^9, 3.816894318509349*^9}, {3.816894373677093*^9, 
   3.816894545939869*^9}, {3.816894613492743*^9, 3.816894614643916*^9}, {
   3.8168946478914633`*^9, 3.816894746419862*^9}, {3.816914460242681*^9, 
   3.816914477788557*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"78729c1e-5946-4135-88b6-34ab9c364da1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"emptyCavTuningData", " ", "=", " ", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"deg\[Psi]", ",", 
       RowBox[{"emptyReflPower", "[", 
        RowBox[{
        "in\[CapitalOmega]", ",", "inr1", ",", "int1", ",", "inr2", ",", 
         "int2", ",", "inL", ",", "deg\[Psi]", ",", "inP", ",", 
         "indeg\[Theta]"}], "]"}], ",", 
       RowBox[{"Abs", "[", 
        RowBox[{"emptyReflComplexAmp", "[", 
         RowBox[{
         "in\[CapitalOmega]", ",", "inr1", ",", "int1", ",", "inr2", ",", 
          "int2", ",", "inL", ",", "deg\[Psi]", ",", "inP", ",", 
          "indeg\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{"emptyReflArg", "[", 
        RowBox[{
        "in\[CapitalOmega]", ",", "inr1", ",", "int1", ",", "inr2", ",", 
         "int2", ",", "inL", ",", "deg\[Psi]", ",", "inP", ",", 
         "indeg\[Theta]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"deg\[Psi]", ",", 
       RowBox[{"-", "90"}], ",", "90", ",", "0.5"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<empty_cavity_analytics_versus_tuning.csv\>\"", ",", 
    "emptyCavTuningData"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8168951309321136`*^9, 3.816895250387891*^9}, {
   3.8168953956063128`*^9, 3.816895395961822*^9}, 3.816914758103249*^9},
 CellLabel->"In[84]:=",ExpressionUUID->"0a219d89-9cb4-4355-aeca-6b1041274c0a"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.816473780797632*^9, 3.816473783988871*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"93379325-621f-43c6-8389-6865e43dabd5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"print", " ", "the", " ", "notebook", " ", "to", " ", 
     RowBox[{"a", " ", ".", "pdf"}]}], ",", " ", 
    RowBox[{
    "the", " ", "notebook", " ", "needs", " ", "to", " ", "be", " ", "saved", 
     " ", "for", " ", "this", " ", "to", " ", "function"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"NotebookPrint", "[", 
   RowBox[{
    RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<not_main_notebook.pdf\>\""}]}], "]"}]}]], "Input",
 CellFrame->{{0, 0}, {0, 2}},
 CellChangeTimes->{
  3.805523565520809*^9, {3.805523735147209*^9, 3.805523744064376*^9}, {
   3.806374661008909*^9, 3.806374664999815*^9}, {3.806374799160515*^9, 
   3.8063748196954403`*^9}, {3.806375070810156*^9, 3.8063750793081217`*^9}, {
   3.80637512994281*^9, 3.80637513092626*^9}, {3.806375166291004*^9, 
   3.806375166343843*^9}, {3.8063752179427834`*^9, 3.806375218873817*^9}, {
   3.806381980006678*^9, 3.806381981787475*^9}, {3.8126550467151003`*^9, 
   3.81265505415224*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"74ba13db-35a6-44fd-9c49-6139bae4e1d7"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.8163875965722*^9},
 CellLabel->"In[88]:=",ExpressionUUID->"fd3ba0db-d54a-4252-8062-c38d284bb0a1"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{
   "old", " ", "method", " ", "of", " ", "calculating", " ", "SHomI"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "frequency", " ", "domain", " ", "quadratures", " ", "at", " ", "the", " ",
     "photodiodes"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"aPD1vec", "[", 
     RowBox[{
     "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",", 
      "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Trans", "[", 
        FractionBox["1", 
         SqrtBox["2"]], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"Avec", "+", "avec"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Refl", "[", 
        FractionBox["1", 
         SqrtBox["2"]], "]"}], ".", 
       RowBox[{"areflvec", "[", 
        RowBox[{
        "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",", 
         "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}]}]}], "]"}]}], 
   ";", "\n", 
   RowBox[{
    RowBox[{"aPD2vec", "[", 
     RowBox[{
     "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",", 
      "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AntiRefl", "[", 
        FractionBox["1", 
         SqrtBox["2"]], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"Avec", "+", "avec"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Trans", "[", 
        FractionBox["1", 
         SqrtBox["2"]], "]"}], ".", 
       RowBox[{"areflvec", "[", 
        RowBox[{
        "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",", 
         "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]"}], "]"}]}]}], "]"}]}], 
   ";"}], "*)"}]], "Input",
 CellFrame->{{0, 0}, {0, 2}},
 CellChangeTimes->{{3.805059943525661*^9, 3.805060036266486*^9}, {
  3.80506008958035*^9, 3.805060106855197*^9}, {3.805060673065486*^9, 
  3.8050606846041193`*^9}, {3.8050608553255873`*^9, 3.8050608564043827`*^9}, {
  3.805422772773703*^9, 3.8054227731621943`*^9}, {3.805513316960659*^9, 
  3.805513319004156*^9}, {3.8055158957113657`*^9, 3.80551592020496*^9}, {
  3.816643982324645*^9, 3.816644012984148*^9}, {3.816646658064775*^9, 
  3.816646663472579*^9}, {3.81664669536767*^9, 3.816646706029585*^9}, {
  3.816647835908504*^9, 3.816647846336728*^9}, {3.816648204750559*^9, 
  3.8166482074354477`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"2c2c02e4-da7e-4d1a-afcc-29cc0ae90914"],

Cell["\<\
Having found the fields at the photodiodes, we now compute the homodyne \
intensity.\
\>", "Text",
 CellChangeTimes->{{3.812654899980891*^9, 3.8126549213227367`*^9}, 
   3.816648212647694*^9},ExpressionUUID->"8fd3e874-42df-42c3-83af-\
95f9bd8625f6"],

Cell[TextData[Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "homodyne", " ", "readout", " ", "takes", " ", "the", " ", "difference", 
      " ", "between", " ", "the", " ", "two", " ", "photo"}], "-", 
     "currents"}], ",", 
    RowBox[{
    "each", " ", "of", " ", "which", " ", "is", " ", "proportional", " ", 
     "to", " ", "the", " ", "time", " ", "average", " ", "of", " ", "the", 
     " ", "intensity", " ", "of", " ", "the", " ", "field"}], ",", 
    RowBox[{
    "due", " ", "to", " ", "the", " ", "slow", " ", "response", " ", "of", 
     " ", "the", " ", 
     RowBox[{"PD", "'"}], "s"}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    SubscriptBox["i", "hom"], "=", 
    RowBox[{
     SubscriptBox["i", "1"], "-", 
     SubscriptBox["i", "2"]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"let", " ", 
      RowBox[{"tilde", "/", "squiggle"}], " ", 
      RowBox[{"(", "~", ")"}], " ", "mean", " ", "time"}], "-", "domain"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["i", "1"], "\[Proportional]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       OverscriptBox["I", "~"], "[", "t", "]"}], "\[RightAngleBracket]"}]}], 
    "=", 
    RowBox[{"\[LeftAngleBracket]", 
     SuperscriptBox[
      RowBox[{"\[LeftBracketingBar]", 
       RowBox[{
        SubscriptBox[
         OverscriptBox[
          OverscriptBox["E", "~"], "^"], "PD1"], "[", "t", "]"}], 
       "\[RightBracketingBar]"}], "2"], "\[RightAngleBracket]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox[
       OverscriptBox["E", "~"], "^"], "PD1"], "[", "t", "]"}], " ", "=", 
    RowBox[{
     SubscriptBox["C", "0"], 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           StyleBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "~"],
            FontVariations->{"Underline"->False}], "^"], 
          StyleBox[
           RowBox[{"PD1", ",", "c"}],
           FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           StyleBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "~"],
            FontVariations->{"Underline"->False}], "^"], 
          StyleBox[
           RowBox[{"PD1", ",", "s"}],
           FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox[
       StyleBox[
        OverscriptBox[
         StyleBox["a",
          FontVariations->{"Underline"->False}], "~"],
        FontVariations->{"Underline"->False}], "^"], 
      StyleBox[
       RowBox[{"PD1", ",", "c"}],
       FontVariations->{"Underline"->False}]], "[", "t", "]"}], " ", "=", " ", 
    RowBox[{"InverseFourierTransform", "[", 
     RowBox[{
      RowBox[{
       StyleBox[
        SubscriptBox[
         OverscriptBox[
          StyleBox["a",
           FontVariations->{"Underline"->False}], "^"], 
         StyleBox[
          RowBox[{"PD1", ",", "c"}],
          FontVariations->{"Underline"->False}]],
        FontVariations->{"Underline"->True}], 
       StyleBox["[",
        FontVariations->{"Underline"->True}], 
       StyleBox["\[CapitalOmega]",
        FontVariations->{"Underline"->False}], 
       StyleBox["]",
        FontVariations->{"Underline"->True}]}], ",", "\[CapitalOmega]", ",", 
      "t"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"time", "-", 
     RowBox[{
     "domain", " ", "intensity", " ", "of", " ", "the", " ", "light", " ", 
      "at", " ", "photo"}], "-", 
     RowBox[{"diode", " ", "1"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["C", "0"], "2"], 
     RowBox[{"\[LeftAngleBracket]", 
      SuperscriptBox[
       RowBox[{"\[LeftBracketingBar]", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             StyleBox[
              OverscriptBox[
               StyleBox["a",
                FontVariations->{"Underline"->False}], "~"],
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD1", ",", "c"}],
             FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             StyleBox[
              OverscriptBox[
               StyleBox["a",
                FontVariations->{"Underline"->False}], "~"],
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD1", ",", "s"}],
             FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], 
        "\[RightBracketingBar]"}], "2"], "\[RightAngleBracket]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "assume", " ", "time", " ", "domain", " ", "quadratures", " ", "are", " ",
      "Hermitian"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["C", "0"], "2"], 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{
          SubscriptBox[
           OverscriptBox[
            StyleBox[
             OverscriptBox[
              StyleBox["a",
               FontVariations->{"Underline"->False}], "~"],
             FontVariations->{"Underline"->False}], "^"], 
           StyleBox[
            RowBox[{"PD1", ",", "c"}],
            FontVariations->{"Underline"->False}]], "[", "t", "]"}], "2"], 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Omega]", "0"], "t"}], "]"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{
          SubscriptBox[
           OverscriptBox[
            StyleBox[
             OverscriptBox[
              StyleBox["a",
               FontVariations->{"Underline"->False}], "~"],
             FontVariations->{"Underline"->False}], "^"], 
           StyleBox[
            RowBox[{"PD1", ",", "s"}],
            FontVariations->{"Underline"->False}]], "[", "t", "]"}], "2"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Omega]", "0"], "t"}], "]"}], 
         RowBox[{"2", " "}]]}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              StyleBox[
               OverscriptBox[
                StyleBox["a",
                 FontVariations->{"Underline"->False}], "~"],
               FontVariations->{"Underline"->False}], "^"], 
             StyleBox[
              RowBox[{"PD1", ",", "c"}],
              FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              StyleBox[
               OverscriptBox[
                StyleBox["a",
                 FontVariations->{"Underline"->False}], "~"],
               FontVariations->{"Underline"->False}], "^"], 
             StyleBox[
              RowBox[{"PD1", ",", "s"}],
              FontVariations->{"Underline"->False}]], "[", "t", "]"}]}], "+", 
          
          RowBox[{
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              StyleBox[
               OverscriptBox[
                StyleBox["a",
                 FontVariations->{"Underline"->False}], "~"],
               FontVariations->{"Underline"->False}], "^"], 
             StyleBox[
              RowBox[{"PD1", ",", "s"}],
              FontVariations->{"Underline"->False}]], "[", "t", "]"}], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              StyleBox[
               OverscriptBox[
                StyleBox["a",
                 FontVariations->{"Underline"->False}], "~"],
               FontVariations->{"Underline"->False}], "^"], 
             StyleBox[
              RowBox[{"PD1", ",", "c"}],
              FontVariations->{"Underline"->False}]], "[", "t", "]"}]}]}], 
         ")"}], 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Omega]", "0"], "t"}], "]"}]}]}], 
      "\[RightAngleBracket]"}]}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"time", " ", "average", " ", "of", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Omega]", "0"], "t"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Omega]", "0"], "t"}], "]"}], " ", "is", " ", "zero"}],
      ",", " ", 
     RowBox[{"time", " ", "average", " ", "of", " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Omega]", "0"], "t"}], "]"}], "2"], " ", "or", " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["\[Omega]", "0"], "t"}], "]"}], "2"], " ", "is", " ", 
      RowBox[{
       FractionBox["1", "2"], ".", "\[IndentingNewLine]", "then"}], " ", 
      "assume", " ", "quadratures", " ", "change", " ", "slowly", " ", "wrt", 
      " ", 
      SubscriptBox["\[Omega]", "0"]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       SubscriptBox["C", "0"], "2"], "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           StyleBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "~"],
            FontVariations->{"Underline"->False}], "^"], 
          StyleBox[
           RowBox[{"PD1", ",", "c"}],
           FontVariations->{"Underline"->False}]], "[", "t", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           StyleBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "~"],
            FontVariations->{"Underline"->False}], "^"], 
          StyleBox[
           RowBox[{"PD1", ",", "s"}],
           FontVariations->{"Underline"->False}]], "[", "t", "]"}], "2"]}], 
      ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "spliting", " ", "time", " ", "signals", " ", "into", " ", "average", " ",
      "and", " ", "time", " ", "varying", " ", "parts"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox[
       StyleBox[
        OverscriptBox[
         StyleBox["a",
          FontVariations->{"Underline"->False}], "~"],
        FontVariations->{"Underline"->False}], "^"], 
      StyleBox[
       RowBox[{"PD1", ",", "c"}],
       FontVariations->{"Underline"->False}]], "[", "t", "]"}], " ", "=", " ", 
    RowBox[{
     SubscriptBox["B", 
      RowBox[{"1", ",", "c"}]], "+", 
     RowBox[{
      SubscriptBox[
       OverscriptBox[
        OverscriptBox["b", "~"], "^"], 
       RowBox[{"1", ",", "c"}]], "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox[
       StyleBox[
        OverscriptBox[
         StyleBox["a",
          FontVariations->{"Underline"->False}], "~"],
        FontVariations->{"Underline"->False}], "^"], 
      StyleBox[
       RowBox[{"PD1", ",", "s"}],
       FontVariations->{"Underline"->False}]], "[", "t", "]"}], " ", "=", " ", 
    RowBox[{
     SubscriptBox["B", 
      RowBox[{"1", ",", "s"}]], "+", 
     RowBox[{
      SubscriptBox[
       OverscriptBox[
        OverscriptBox["b", "~"], "^"], 
       RowBox[{"1", ",", "s"}]], "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       SubscriptBox["C", "0"], "2"], "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["B", 
           RowBox[{"1", ",", "c"}]], "+", 
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             OverscriptBox["b", "~"], "^"], 
            RowBox[{"1", ",", "c"}]], "[", "t", "]"}]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["B", 
           RowBox[{"1", ",", "s"}]], "+", 
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             OverscriptBox["b", "~"], "^"], 
            RowBox[{"1", ",", "s"}]], "[", "t", "]"}]}], ")"}], "2"]}], 
      ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       SubscriptBox["C", "0"], "2"], "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["B", 
         RowBox[{"1", ",", "c"}]], "2"], "+", 
       SuperscriptBox[
        SubscriptBox["B", 
         RowBox[{"1", ",", "s"}]], "2"], "+", 
       SuperscriptBox[
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           OverscriptBox["b", "~"], "^"], 
          RowBox[{"1", ",", "s"}]], "[", "t", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{
         SubscriptBox[
          OverscriptBox[
           OverscriptBox["b", "~"], "^"], 
          RowBox[{"1", ",", "c"}]], "[", "t", "]"}], "2"], "+", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "c"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              OverscriptBox["b", "~"], "^"], 
             RowBox[{"1", ",", "c"}]], "[", "t", "]"}]}], "+", 
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "s"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              OverscriptBox["b", "~"], "^"], 
             RowBox[{"1", ",", "s"}]], "[", "t", "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "assume", " ", "time", " ", "varying", " ", "part", " ", "is", " ", 
     "small", " ", "wrt", " ", "average", " ", 
     RowBox[{"s", ".", "t", ".", " ", "time"}], " ", "varying", " ", "part", 
     " ", "squared", " ", "is", " ", "vanishingly", " ", "small", 
     "\[IndentingNewLine]", "this", " ", "is", " ", "true", " ", "for", " ", 
     "comparing", " ", "quantum", " ", "noise", " ", "to", " ", "the", " ", 
     "local", " ", "oscillator"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["I", "~"], "PD1"], "[", "t", "]"}], 
     "\[RightAngleBracket]"}], " ", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       SubscriptBox["C", "0"], "2"], "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["B", 
         RowBox[{"1", ",", "c"}]], "2"], "+", 
       SuperscriptBox[
        SubscriptBox["B", 
         RowBox[{"1", ",", "s"}]], "2"], "+", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "c"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              OverscriptBox["b", "~"], "^"], 
             RowBox[{"1", ",", "c"}]], "[", "t", "]"}]}], "+", 
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "s"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox[
              OverscriptBox["b", "~"], "^"], 
             RowBox[{"1", ",", "s"}]], "[", "t", "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"apply", " ", "Fourier", " ", "transform"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["I", "PD1"], "[", "\[CapitalOmega]", "]"}], " ", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       SubscriptBox["C", "0"], "2"], "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["B", 
            RowBox[{"1", ",", "c"}]], "2"], "+", 
          SuperscriptBox[
           SubscriptBox["B", 
            RowBox[{"1", ",", "s"}]], "2"]}], ")"}], 
        RowBox[{"\[Delta]", "[", 
         RowBox[{"\[CapitalOmega]", "-", "0"}], "]"}]}], "+", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "c"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox["b", "^"], 
             RowBox[{"1", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]}], "+", 
          RowBox[{
           SubscriptBox["B", 
            RowBox[{"1", ",", "s"}]], 
           RowBox[{
            SubscriptBox[
             OverscriptBox["b", "^"], 
             RowBox[{"1", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}]}], 
         ")"}]}]}], ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "but", " ", "we", " ", "are", " ", "only", " ", "interested", " ", "in", 
      " ", "the", " ", "quantum", " ", "noise"}], ",", " ", 
     RowBox[{"not", " ", "the", " ", "DC", " ", "part"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["I", "PD1"], "[", "\[CapitalOmega]", "]"}], " ", "=", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["C", "0"], "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"1", ",", "c"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"1", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]}], "+", 
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"1", ",", "s"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"1", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}]}], 
      ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "homodyne", " ", "readout", " ", "is", " ", "proportional", " ", "to", 
      " ", "the", " ", "difference", " ", "in", " ", "intensities"}], ",", 
     " ", 
     RowBox[{
     "since", " ", "the", " ", "Fourier", " ", "transform", " ", "is", " ", 
      "linear", " ", "we", " ", "can", " ", "look", " ", "at", " ", "the", 
      " ", "difference", " ", "in", " ", "the", " ", "spectra"}]}], "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["I", "hom"], "[", "\[CapitalOmega]", "]"}], "=", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{
       SubscriptBox["I", "PD1"], "[", "\[CapitalOmega]", "]"}], "-", 
      RowBox[{
       SubscriptBox["I", "PD2"], "[", "\[CapitalOmega]", "]"}]}], 
     "\[RightAngleBracket]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["I", "hom"], "[", "\[CapitalOmega]", "]"}], "=", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["C", "0"], "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"1", ",", "c"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"1", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]}], "+", 
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"1", ",", "s"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"1", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}], "-", 
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"2", ",", "c"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"2", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]}], "-", 
       RowBox[{
        SubscriptBox["B", 
         RowBox[{"2", ",", "s"}]], 
        RowBox[{
         SubscriptBox[
          OverscriptBox["b", "^"], 
          RowBox[{"2", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}]}], 
      ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "identify", " ", "these", " ", "components", " ", "as", " ", "the", " ", 
     "constant", " ", "and", " ", "frequency", " ", "dependant", " ", "parts",
      " ", "of", " ", "the", " ", "original", " ", "quadratures"}], "*)"}], 
   "\n", 
   RowBox[{"aPD1vec", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          StyleBox[
           SubscriptBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD1", ",", "c"}],
             FontVariations->{"Underline"->False}]],
           FontVariations->{"Underline"->True}], 
          StyleBox["[",
           FontVariations->{"Underline"->True}], 
          StyleBox["\[CapitalOmega]",
           FontVariations->{"Underline"->False}], 
          StyleBox["]",
           FontVariations->{"Underline"->True}]}]},
        {
         RowBox[{
          StyleBox[
           SubscriptBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD1", ",", "s"}],
             FontVariations->{"Underline"->False}]],
           FontVariations->{"Underline"->True}], 
          StyleBox["[",
           FontVariations->{"Underline"->True}], 
          StyleBox["\[CapitalOmega]",
           FontVariations->{"Underline"->False}], 
          StyleBox["]",
           FontVariations->{"Underline"->True}]}]}
       }], ")"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubscriptBox["B", 
           RowBox[{"1", ",", "c"}]]},
         {
          SubscriptBox["B", 
           RowBox[{"1", ",", "s"}]]}
        }], ")"}], " ", "+", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           SubscriptBox[
            OverscriptBox["b", "^"], 
            RowBox[{"1", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]},
         {
          RowBox[{
           SubscriptBox[
            OverscriptBox["b", "^"], 
            RowBox[{"1", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}
        }], ")"}]}]}]}], " ", "\[IndentingNewLine]", 
   RowBox[{"aPD2vec", "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          StyleBox[
           SubscriptBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD2", ",", "c"}],
             FontVariations->{"Underline"->False}]],
           FontVariations->{"Underline"->True}], 
          StyleBox["[",
           FontVariations->{"Underline"->True}], 
          StyleBox["\[CapitalOmega]",
           FontVariations->{"Underline"->False}], 
          StyleBox["]",
           FontVariations->{"Underline"->True}]}]},
        {
         RowBox[{
          StyleBox[
           SubscriptBox[
            OverscriptBox[
             StyleBox["a",
              FontVariations->{"Underline"->False}], "^"], 
            StyleBox[
             RowBox[{"PD2", ",", "s"}],
             FontVariations->{"Underline"->False}]],
           FontVariations->{"Underline"->True}], 
          StyleBox["[",
           FontVariations->{"Underline"->True}], 
          StyleBox["\[CapitalOmega]",
           FontVariations->{"Underline"->False}], 
          StyleBox["]",
           FontVariations->{"Underline"->True}]}]}
       }], ")"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubscriptBox["B", 
           RowBox[{"2", ",", "c"}]]},
         {
          SubscriptBox["B", 
           RowBox[{"2", ",", "s"}]]}
        }], ")"}], " ", "+", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           SubscriptBox[
            OverscriptBox["b", "^"], 
            RowBox[{"2", ",", "c"}]], "[", "\[CapitalOmega]", "]"}]},
         {
          RowBox[{
           SubscriptBox[
            OverscriptBox["b", "^"], 
            RowBox[{"2", ",", "s"}]], "[", "\[CapitalOmega]", "]"}]}
        }], ")"}]}]}]}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"NB", ":", " ", 
      RowBox[{"this", " ", 
       RowBox[{"doesn", "'"}], "t", " ", "sound", " ", "true"}]}], ",", " ", 
     RowBox[{
     "the", " ", "added", " ", "constant", " ", "picks", " ", "up", " ", "a", 
      " ", "delta", " ", "function", " ", "when", " ", "transformed", " ", 
      "forwards", " ", "or", " ", 
      RowBox[{"backwards", "?"}]}]}], "*)"}]}]}]], "Input",
 CellFrame->{{0, 0}, {0, 2}},
 CellChangeTimes->{{3.805513868266603*^9, 3.8055139485825787`*^9}, {
  3.805515530528767*^9, 3.805515537024125*^9}, {3.805515575338846*^9, 
  3.8055155966522913`*^9}, {3.805518215856917*^9, 
  3.805518216504794*^9}},ExpressionUUID->"3dfdaf12-f406-496a-80a5-\
119e2bf2e43c"]], "Text",
 CellChangeTimes->{
  3.805518316350728*^9, {3.8055183491365547`*^9, 3.805518371854121*^9}, 
   3.805523936428537*^9},ExpressionUUID->"400161cc-835d-4015-8163-\
4d30c1a0797b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{
   "spotting", " ", "the", " ", "frequency", " ", "dependent", " ", 
    "sections", " ", "by", " ", "eye"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Column", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"aPD1vec", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"aPD1vec", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"aPD2vec", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"aPD2vec", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.805515634410458*^9, 3.805515635276225*^9}, {
   3.805516533463911*^9, 3.8055165374180737`*^9}, {3.8055178499362497`*^9, 
   3.805517869116086*^9}, 3.8055182729122458`*^9, {3.805518392623622*^9, 
   3.8055184755812273`*^9}, {3.805518538320611*^9, 3.805518545513605*^9}, {
   3.8166481055582027`*^9, 3.8166481132402773`*^9}, {3.816648181116131*^9, 
   3.8166481840747128`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"538a57be-ccd9-4342-af09-0d8258f20fce"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     SuperscriptBox["2", 
      RowBox[{"1", "/", "2"}]], " ", "expression", " ", "for", " ", "freq"}], 
    "-", 
    RowBox[{"dependent", " ", "avoids", " ", "using", " ", "Simplify"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["B", 
         RowBox[{"1", ",", "c"}]], 
        SubscriptBox[
         OverscriptBox["b", "^"], 
         RowBox[{"1", ",", "c"}]]},
       {
        SubscriptBox["B", 
         RowBox[{"1", ",", "s"}]], 
        SubscriptBox[
         OverscriptBox["b", "^"], 
         RowBox[{"1", ",", "s"}]]},
       {
        SubscriptBox["B", 
         RowBox[{"2", ",", "c"}]], 
        SubscriptBox[
         OverscriptBox["b", "^"], 
         RowBox[{"2", ",", "c"}]]},
       {
        SubscriptBox["B", 
         RowBox[{"2", ",", "s"}]], 
        SubscriptBox[
         OverscriptBox["b", "^"], 
         RowBox[{"2", ",", "s"}]]}
      }], ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"1", "/", "2"}]]], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"A", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"aPD1vec", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], 
           SubscriptBox["B", 
            RowBox[{"1", ",", "c"}]]}]}]},
        {
         RowBox[{"A", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"aPD1vec", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], 
           SubscriptBox["B", 
            RowBox[{"1", ",", "s"}]]}]}]},
        {
         RowBox[{
          RowBox[{"-", "A"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"aPD2vec", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], 
           SubscriptBox["B", 
            RowBox[{"2", ",", "c"}]]}]}]},
        {
         RowBox[{
          RowBox[{"-", "A"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"aPD2vec", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "2"}]], 
           SubscriptBox["B", 
            RowBox[{"2", ",", "s"}]]}]}]}
       }], ")"}]}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.805517201742526*^9, 3.805517260542101*^9}, {
  3.805517361025305*^9, 3.805517383796362*^9}, {3.805517790800758*^9, 
  3.805517830472193*^9}, {3.8055185899405947`*^9, 3.805518735049914*^9}, {
  3.805518771742667*^9, 3.805518772282138*^9}, {3.805518859751245*^9, 
  3.8055189051710653`*^9}, {3.805519017426511*^9, 3.8055190419226713`*^9}, {
  3.81664410583706*^9, 3.816644105841497*^9}, {3.816648093418901*^9, 
  3.81664809878878*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"a577ebcd-04f6-49b8-b579-2c11c0442b23"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"computing", " ", "the", " ", "homodyne", " ", "intensity", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], "=", " ", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["I", "hom"], "^"], "[", "\[CapitalOmega]", "]"}]}], 
      ")"}], " ", "in", " ", "frequency", " ", "domain", 
     "\[IndentingNewLine]", 
     RowBox[{"NB", ":", " ", 
      RowBox[{
       RowBox[{"I", "'"}], "ve", " ", "dropped", " ", 
       SubscriptBox["C", "0"], " ", "here"}]}]}], ",", " ", 
    RowBox[{"should", " ", "it", " ", "have", " ", "stayed", " ", 
     RowBox[{"it", "?", " ", "and"}], " ", "if", " ", "so"}], ",", " ", 
    RowBox[{"what", " ", "is", " ", 
     RowBox[{"it", "?"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   OverscriptBox["HomI", "^"], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["B", 
       RowBox[{"1", ",", "c"}]], 
      SubscriptBox[
       OverscriptBox["b", "^"], 
       RowBox[{"1", ",", "c"}]]}], "+", 
     RowBox[{
      SubscriptBox["B", 
       RowBox[{"1", ",", "s"}]], 
      SubscriptBox[
       OverscriptBox["b", "^"], 
       RowBox[{"1", ",", "s"}]]}], "-", 
     RowBox[{
      SubscriptBox["B", 
       RowBox[{"2", ",", "c"}]], 
      SubscriptBox[
       OverscriptBox["b", "^"], 
       RowBox[{"2", ",", "c"}]]}], "-", 
     RowBox[{
      SubscriptBox["B", 
       RowBox[{"2", ",", "s"}]], 
      SubscriptBox[
       OverscriptBox["b", "^"], 
       RowBox[{"2", ",", "s"}]]}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "notice", " ", "that", " ", "the", " ", "laser", " ", "noise", " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["a", "^"], "1"], ",", 
       SubscriptBox[
        OverscriptBox["a", "^"], "2"]}], ")"}], " ", "has", " ", "cancelled", 
     " ", "out"}], ",", " ", 
    RowBox[{
    "just", " ", "as", " ", "expected", " ", "for", " ", "homodyne", " ", 
     "readout"}]}], "*)"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.8055178848866787`*^9, {3.8055191075457478`*^9, 3.805519315161327*^9}, {
   3.805519721598878*^9, 3.805519721849345*^9}, {3.805520260364334*^9, 
   3.8055204104913273`*^9}, {3.805520544463285*^9, 3.8055206447047167`*^9}, {
   3.80552071073689*^9, 3.805520752429997*^9}, {3.8055217772502613`*^9, 
   3.805521782349103*^9}, {3.805521933576976*^9, 3.805521935399577*^9}, 
   3.816648090710784*^9},
 CellLabel->"In[92]:=",ExpressionUUID->"c6ef84fd-f5e0-4a24-aceb-de1d43bea371"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"extracting", " ", "the", " ", "co"}], "-", 
     RowBox[{"efficients", " ", "of", " ", 
      SubscriptBox[
       OverscriptBox["n", "^"], "1"]}]}], ",", " ", 
    SubscriptBox[
     OverscriptBox["n", "^"], "2"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"g1", "[", 
    RowBox[{
    "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",", 
     "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_", ",", "\[Theta]_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r1", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{
          "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
          "c"]], " ", 
        SuperscriptBox["r1", "3"], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{
          "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
          "c"]], " ", "r1", " ", 
        SuperscriptBox["t1", "2"], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{
          "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
          "c"]], " ", 
        SuperscriptBox[
         RowBox[{"Cosh", "[", "r", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["r1", "2"]}], "+", 
             SuperscriptBox["t1", "2"]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["t1", "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{
          "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
          "c"]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["r1", "2"]}], "+", 
          SuperscriptBox["t1", "2"]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{
          "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
          "c"]], " ", 
        SuperscriptBox["t1", "2"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sinh", "[", 
         RowBox[{"2", " ", "r"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{
          "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
          "c"]], " ", 
        SuperscriptBox["t1", "2"], " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sinh", "[", 
         RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}], "\[IndentingNewLine]", 
     RowBox[{"g2", "[", 
      RowBox[{
      "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",",
        "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_", ",", "\[Theta]_"}], 
      "]"}]}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{
           "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
           "c"]], " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r", "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["t1", "2"], " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               SuperscriptBox["r1", "2"]}], "+", 
              SuperscriptBox["t1", "2"]}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{
           "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
           "c"]], " ", 
         SuperscriptBox["t1", "2"], " ", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"Cosh", "[", "r", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
         RowBox[{"Sinh", "[", "r", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"r1", "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox["r1", "3"]}], "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", "r1", " ", 
            SuperscriptBox["t1", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               SuperscriptBox["r1", "2"]}], "+", 
              SuperscriptBox["t1", "2"]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
              "c"]], " ", 
            SuperscriptBox["t1", "2"], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
            RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
            RowBox[{"Sinh", "[", 
             RowBox[{"2", " ", "r"}], "]"}]}]}], ")"}]}]}], ")"}], 
      "\[IndentingNewLine]", 
      RowBox[{"g3", "[", 
       RowBox[{
       "\[CapitalOmega]_", ",", "r1_", ",", "t1_", ",", "r2_", ",", "t2_", 
        ",", "L_", ",", "\[Psi]_", ",", "r_", ",", "\[Phi]_", ",", 
        "\[Theta]_"}], "]"}]}], ":=", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{
          "4", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
          "c"]], " ", 
        SuperscriptBox["r1", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{
          "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
          "c"]], " ", "r1", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Cosh", "[", "r", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{
          "2", " ", "\[ImaginaryI]", " ", "L", " ", "\[CapitalOmega]"}], 
          "c"]], " ", "r1", " ", 
        SuperscriptBox[
         RowBox[{"Sinh", "[", "r", "]"}], "2"]}]}], ")"}]}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8055232308581657`*^9, 3.805523272017584*^9}, {
   3.805523304608532*^9, 3.805523517265197*^9}, {3.816564662177672*^9, 
   3.8165646773549757`*^9}, 3.8166480869983797`*^9},
 CellLabel->"In[93]:=",ExpressionUUID->"eb69f030-4f96-4769-94b8-3d3310292795"],

Cell[TextData[Cell[BoxData[{
 RowBox[{
  RowBox[{
   OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], "=", " ", 
  RowBox[{
   FractionBox["A", 
    RowBox[{"g3", "[", 
     RowBox[{
      RowBox[{"\[CapitalOmega]", ";", "r1"}], ",", "t1", ",", "L", ",", 
      "\[Psi]", ",", "r", ",", "\[Phi]", ",", "\[Theta]"}], "]"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"g1", "[", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", ";", "r1"}], ",", "t1", ",", "L", ",", 
        "\[Psi]", ",", "r", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}]}], " ", 
     "\[IndentingNewLine]", "+", " ", 
     RowBox[{
      RowBox[{"g2", "[", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", ";", "r1"}], ",", "t1", ",", "L", ",", 
        "\[Psi]", ",", "r", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], "=", " ", 
  RowBox[{
   FractionBox["A", 
    RowBox[{"g3", "[", "\[CapitalOmega]", "]"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}]}], " ", 
     "+", " ", 
     RowBox[{
      RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}]}]}], 
    ")"}]}]}]}], \
"Input",ExpressionUUID->"46035a55-927c-4f3b-8d69-2c9774037bdb"]], "Text",
 CellChangeTimes->{
  3.812654942877351*^9, 3.816565181118681*^9, {3.8166441058443813`*^9, 
   3.8166441058468037`*^9}},ExpressionUUID->"05608f11-2300-4b1d-af40-\
e150792d2ac5"],

Cell["Having found the homodyne intensity, we now compute its PSD.", "Text",
 CellChangeTimes->{{3.8126549510109787`*^9, 
  3.812654961930221*^9}},ExpressionUUID->"12931b0c-38cc-4731-8972-\
b4b85a689d53"],

Cell[TextData[Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "computing", " ", "the", " ", "power", " ", "spectral", " ", "density",
         " ", 
        RowBox[{"(", "PSD", ")"}], " ", "of", " ", "the", " ", "homodyne", 
        " ", "intensity"}], ",", " ", 
       RowBox[{
        RowBox[{"this", " ", "quantifies", " ", "the", " ", "quantum", " ", 
         RowBox[{"noise", ".", "\[IndentingNewLine]", "Let"}]}], " ", "|", 
        "0"}]}], "\[RightAngleBracket]"}], " ", "represent", " ", "the", " ", 
     "vacuum", " ", 
     RowBox[{"(", "ground", ")"}], " ", "state"}], ",", " ", 
    RowBox[{"for", " ", "reasons", " ", "I", " ", 
     RowBox[{"don", "'"}], "t", " ", "understand"}], ",", " ", 
    RowBox[{
    "we", " ", "take", " ", "expectation", " ", "against", " ", "this", " ", 
     "instead", " ", "of", " ", "the", " ", "actual", " ", 
     RowBox[{"state", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      OverscriptBox[
       SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", 
     "2", "\[Pi]", " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[CapitalOmega]", "-", 
       RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], " ", "=", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"0", "|", 
      RowBox[{
       RowBox[{
        OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], 
       "\[EmptyCircle]", 
       RowBox[{
        RowBox[{
         OverscriptBox["HomI", "^"], "\[ConjugateTranspose]"}], "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "|", "0"}], 
     "\[RightAngleBracket]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"[", "D", "]"}], "pg", ".35"}], ",", " ", 
     RowBox[{
     "from", " ", "assuming", " ", "the", " ", "time", " ", "domain", " ", 
      "is", " ", "Hermitian"}], ",", " ", 
     RowBox[{
      RowBox[{"frequency", " ", "domain", " ", "obeys", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["a", 
          RowBox[{"c", ",", "s"}]], "\[Dagger]"], "[", "\[CapitalOmega]", 
        "]"}]}], " ", "=", " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"c", ",", "s"}]], "[", 
       RowBox[{"-", "\[CapitalOmega]"}], "]"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"NB", ":", " ", 
      RowBox[{"for", " ", "now"}]}], ",", " ", 
     RowBox[{
      RowBox[{"I", "'"}], "ll", " ", "assume", " ", 
      RowBox[{
       OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], " ", "is", 
      " ", "Hermitian"}], ",", " ", 
     RowBox[{
     "although", " ", "I", " ", "think", " ", "that", " ", "this", " ", "is", 
      " ", "wrong"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      OverscriptBox[
       SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", 
     "2", "\[Pi]", " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[CapitalOmega]", "-", 
       RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], " ", "=", " ", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"0", "|", 
       RowBox[{
        RowBox[{
         RowBox[{
          OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}], 
         RowBox[{
          RowBox[{
           OverscriptBox["HomI", "^"], "\[ConjugateTranspose]"}], "[", 
          RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{
           OverscriptBox["HomI", "^"], "\[ConjugateTranspose]"}], "[", 
          RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
         RowBox[{
          OverscriptBox["HomI", "^"], "[", "\[CapitalOmega]", "]"}]}]}], "|", 
       "0"}], "\[RightAngleBracket]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      OverscriptBox[
       SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", 
     "2", "\[Pi]", " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[CapitalOmega]", "-", 
       RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], " ", "=", " ", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"0", "|", 
       RowBox[{
        RowBox[{
         FractionBox["A", 
          RowBox[{"g3", "[", "\[CapitalOmega]", "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
            RowBox[{
             SubscriptBox[
              OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}]}], 
           " ", "+", " ", 
           RowBox[{
            RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
            RowBox[{
             SubscriptBox[
              OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", 
             "]"}]}]}], ")"}], 
         FractionBox["A", 
          RowBox[{"g3", "[", 
           RowBox[{"\[CapitalOmega]", "'"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"g1", "[", 
             RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
            RowBox[{
             SubscriptBox[
              OverscriptBox["n", "^"], "1"], "[", 
             RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"g2", "[", 
             RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
            RowBox[{
             SubscriptBox[
              OverscriptBox["n", "^"], "2"], "[", 
             RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["A", 
          RowBox[{"g3", "[", 
           RowBox[{"\[CapitalOmega]", "'"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"g1", "[", 
             RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
            RowBox[{
             SubscriptBox[
              OverscriptBox["n", "^"], "1"], "[", 
             RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"g2", "[", 
             RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
            RowBox[{
             SubscriptBox[
              OverscriptBox["n", "^"], "2"], "[", 
             RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]}], ")"}], 
         FractionBox["A", 
          RowBox[{"g3", "[", "\[CapitalOmega]", "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
            RowBox[{
             SubscriptBox[
              OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}]}], 
           " ", "+", " ", 
           RowBox[{
            RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
            RowBox[{
             SubscriptBox[
              OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", 
             "]"}]}]}], ")"}]}]}], "|", "0"}], "\[RightAngleBracket]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "expanding", " ", "out", " ", "terms", " ", "and", " ", "spotting", " ", 
     "symmetric", " ", "products"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      OverscriptBox[
       SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", 
     "2", "\[Pi]", " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[CapitalOmega]", "-", 
       RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], " ", "=", " ", 
    RowBox[{
     FractionBox[
      SuperscriptBox["A", "2"], 
      RowBox[{
       RowBox[{"g3", "[", "\[CapitalOmega]", "]"}], 
       RowBox[{"g3", "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]], 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"0", "|", 
       RowBox[{
        RowBox[{
         RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
         RowBox[{"g1", "[", 
          RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
           "\[EmptyCircle]", 
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "1"], "[", 
            RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
         RowBox[{"g2", "[", 
          RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
           "\[EmptyCircle]", 
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "2"], "[", 
            RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], ")"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
         RowBox[{"g2", "[", 
          RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
           "\[EmptyCircle]", 
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "2"], "[", 
            RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
         RowBox[{"g1", "[", 
          RowBox[{"\[CapitalOmega]", "'"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
           "\[EmptyCircle]", 
           RowBox[{
            SubscriptBox[
             OverscriptBox["n", "^"], "1"], "[", 
            RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], ")"}]}]}], "|", "0"}], 
      "\[RightAngleBracket]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"results", " ", "from", " ", "the", " ", "top", " ", 
     RowBox[{"of", " ", "[", "D", "]"}], "pg", ".38"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"the", " ", "factor", " ", "of", " ", 
      FractionBox["1", "2"], " ", "is", " ", "what", " ", "determines", " ", 
      "the", " ", "large", " ", "r", " ", "limit", " ", "of", " ", "PSD", " ", 
      RowBox[{"(", 
       RowBox[{
       "but", " ", "our", " ", "model", " ", "is", " ", "invalid", " ", "in", 
        " ", "this", " ", "limit", " ", "so", " ", 
        RowBox[{"don", "'"}], "t", " ", "worry", " ", "about", " ", "it"}], 
       ")"}], "\[IndentingNewLine]", "it", " ", "comes", " ", "from", " ", 
      "using", " ", "two"}], "-", " ", 
     RowBox[{"or", " ", "one"}], "-", 
     RowBox[{"sided", " ", "PSD"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"0", "|", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
       "\[EmptyCircle]", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "1"], "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "|", "0"}], 
     "\[RightAngleBracket]"}], " ", "=", " ", 
    RowBox[{
     FractionBox["1", "2"], "2", "\[Pi]", " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[CapitalOmega]", "-", 
       RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"0", "|", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
       "\[EmptyCircle]", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "2"], "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "|", "0"}], 
     "\[RightAngleBracket]"}], " ", "=", " ", 
    RowBox[{
     FractionBox["1", "2"], "2", "\[Pi]", " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[CapitalOmega]", "-", 
       RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"0", "|", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "1"], "[", "\[CapitalOmega]", "]"}], 
       "\[EmptyCircle]", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], "2"], "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], " ", "|", "0"}], 
     "\[RightAngleBracket]"}], "=", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"0", "|", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          OverscriptBox["n", "^"], "2"], "[", "\[CapitalOmega]", "]"}], 
        "\[EmptyCircle]", 
        RowBox[{
         SubscriptBox[
          OverscriptBox["n", "^"], "1"], "[", 
         RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], " ", "|", "0"}], 
      "\[RightAngleBracket]"}], "=", " ", "0"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "as", " ", "so", " ", "we", " ", "have", " ", "the", " ", "PSD", " ", 
      "of", " ", "the", " ", "homodyne", " ", "intensity"}], ",", " ", 
     RowBox[{
     "to", " ", "quantify", " ", "the", " ", "quantum", " ", "noise"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      OverscriptBox[
       SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[CapitalOmega]", "-", 
       RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}], " ", "=", " ", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["A", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], 
          RowBox[{"g1", "[", 
           RowBox[{"\[CapitalOmega]", "'"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], 
          RowBox[{"g2", "[", 
           RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]}], ")"}]}], 
      RowBox[{"2", 
       RowBox[{"g3", "[", "\[CapitalOmega]", "]"}], 
       RowBox[{"g3", "[", 
        RowBox[{"\[CapitalOmega]", "'"}], "]"}]}]], 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[CapitalOmega]", "-", 
       RowBox[{"\[CapitalOmega]", "'"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     OverscriptBox[
      SubscriptBox["S", "HomI"], "^"], "[", "\[CapitalOmega]", "]"}], " ", 
    "=", " ", 
    FractionBox[
     RowBox[{
      SuperscriptBox["A", "2"], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"g1", "[", "\[CapitalOmega]", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"g2", "[", "\[CapitalOmega]", "]"}], "2"]}], ")"}]}], 
     RowBox[{"2", 
      SuperscriptBox[
       RowBox[{"g3", "[", "\[CapitalOmega]", "]"}], "2"]}]]}]}]}]], "Input",
 CellChangeTimes->{{3.805425327335909*^9, 3.805425353277169*^9}, {
   3.80542606670446*^9, 3.805426077824092*^9}, 3.805513119714265*^9, {
   3.8055132659587927`*^9, 3.8055132888678923`*^9}, 3.805515125648028*^9, {
   3.805515239246922*^9, 3.805515239366498*^9}, {3.8055158336980133`*^9, 
   3.8055158456038637`*^9}, {3.805520003392823*^9, 3.805520057417431*^9}, 
   3.805520827035976*^9, {3.805520919592492*^9, 
   3.805521002318198*^9}},ExpressionUUID->"1bf5ecfe-d1f1-4aa6-9636-\
5290a15ece87"]], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQbZexe11J1BtHAd+MTSB6Sc7bnSB63Q37XSBax9Xz
CIgOStkJpifF55wC0YcSIPTxXd23QXRXxan3ILpg66cvIDpE3PE32ByuP0yl
QHryw/28INrt1jcJEC12Yb0OiE68ZGgPovXOGIHpRYb33UD0uYSGEBD9o+Bm
BIhe9p4tGUT/eZaYDqLrHu3JBtH3nl4sANG7H/0uBtEMCt3NIDqiRr4VRJe5
cveA6Kx1N2eA9U3gWwCiFdptwXTd8437QPSCdxB6homuTnb0G0eDOQv0QfTz
bjVzED25rhtMn5nOKDol5o3jZcNDciD6jt6B1/wZbxydYvXegGgAf8KsPw==

  "],ExpressionUUID->"8d1e2bf2-1502-48c5-bdca-c43e07e3d292"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"setupSHomI", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["A", "2"], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"g1", "[", 
           RowBox[{
           "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",",
             "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]", ",", "\[Theta]"}], 
           "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"g2", "[", 
           RowBox[{
           "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",",
             "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]", ",", "\[Theta]"}], 
           "]"}], "2"]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", 
       SuperscriptBox[
        RowBox[{"g3", "[", 
         RowBox[{
         "\[CapitalOmega]", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",", 
          "L", ",", "\[Psi]", ",", "r", ",", "\[Phi]", ",", "\[Theta]"}], 
         "]"}], "2"]}], ")"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.806375763414126*^9, 3.806375779374195*^9}, {
  3.816565214224661*^9, 3.816565222069624*^9}, {3.816647899667677*^9, 
  3.816647906964003*^9}, {3.816647960538113*^9, 3.81664799523293*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"1edb6a28-5f6c-4bfd-9e3f-76799b750267"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"c", " ", "=", " ", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"10", " "}], "8"]}]}], " ", 
    RowBox[{"(*", 
     RowBox[{"m", " ", 
      SuperscriptBox["s", 
       RowBox[{"-", "1"}]]}], "*)"}], ",", " ", 
    RowBox[{"L", " ", "in", " ", "m"}], ",", " ", 
    RowBox[{"\[CapitalOmega]", " ", "in", " ", "Hz"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SHomI", "[", 
    RowBox[{
    "inA_", ",", "in\[CapitalOmega]_", ",", "inr1_", ",", "int1_", ",", 
     "inr2_", ",", "int2_", ",", "inL_", ",", "in\[Psi]_", ",", "inr_", ",", 
     "in\[Phi]_", ",", "in\[Theta]_"}], "]"}], " ", ":=", " ", 
   RowBox[{"setupSHomI", " ", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "\[Rule]", "inA"}], ",", 
      RowBox[{"\[CapitalOmega]", "\[Rule]", "in\[CapitalOmega]"}], ",", 
      RowBox[{"r1", "\[Rule]", "inr1"}], ",", 
      RowBox[{"t1", "\[Rule]", "int1"}], ",", 
      RowBox[{"r2", "\[Rule]", "inr2"}], ",", 
      RowBox[{"t2", "\[Rule]", "int2"}], ",", 
      RowBox[{"L", "\[Rule]", "inL"}], ",", 
      RowBox[{"\[Psi]", "\[Rule]", "in\[Psi]"}], ",", 
      RowBox[{"r", "\[Rule]", "inr"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", "in\[Phi]"}], ",", 
      RowBox[{"\[Theta]", "\[Rule]", "in\[Theta]"}], ",", 
      RowBox[{"c", "->", " ", 
       RowBox[{"3", " ", 
        SuperscriptBox["10", "8"]}]}]}], "}"}]}]}], "*)"}]], "Input",
 CellFrame->{{0, 0}, {2, 0}},
 CellChangeTimes->{{3.8055228257890463`*^9, 3.80552282640447*^9}, 
   3.8055232113105183`*^9, {3.805523541153281*^9, 3.805523673760887*^9}, {
   3.805523748198502*^9, 3.805523818140089*^9}, 3.805523868009508*^9, {
   3.806026120981614*^9, 3.80602613447482*^9}, {3.806026196188568*^9, 
   3.8060262123649054`*^9}, {3.8063756098793592`*^9, 3.806375696100008*^9}, {
   3.8063758001253977`*^9, 3.806375815809841*^9}, {3.806375866725065*^9, 
   3.80637594465375*^9}, {3.806378637074855*^9, 3.806378657364313*^9}, {
   3.806378797441449*^9, 3.806378807502866*^9}, {3.81656468580834*^9, 
   3.81656470178086*^9}, 3.816648010578994*^9},
 CellLabel->"In[95]:=",ExpressionUUID->"1a5b1b03-63c9-4eb3-a5ca-67e6a893e204"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.816647826579178*^9, 3.8166478279129953`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"c1d1251e-6080-4d79-8d52-dabff148ab39"]
},
WindowSize->{890, 590},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 589, 13, 122, "Text",ExpressionUUID->"39c62208-fd8d-4f47-b3ae-f8e054b8e8fb"],
Cell[1150, 35, 389, 9, 56, "Text",ExpressionUUID->"a7a48fbc-bd42-463c-98e0-5837de31a7ed"],
Cell[1542, 46, 494, 9, 30, "Input",ExpressionUUID->"ae39354c-bd1f-4add-bb22-1cac54566556"],
Cell[2039, 57, 6300, 180, 580, "Input",ExpressionUUID->"60b81c7e-a887-44a9-b376-43b41f52008d"],
Cell[8342, 239, 6441, 151, 400, "Input",ExpressionUUID->"119ecdc3-6fa1-4c2a-afc0-afebfd72aaf8"],
Cell[14786, 392, 1260, 26, 78, "Input",ExpressionUUID->"622c0bd9-623a-435d-b949-9131fb694933"],
Cell[16049, 420, 496, 11, 30, "Input",ExpressionUUID->"775950c5-51ea-4403-9d3d-6e85ec0dfd4a"],
Cell[16548, 433, 9382, 248, 529, "Input",ExpressionUUID->"e4b643f5-1735-4f96-a362-d800e1c20e5e"],
Cell[25933, 683, 2136, 64, 156, "Input",ExpressionUUID->"aa30cffb-fd8b-44b5-8b90-97912c89ed63"],
Cell[28072, 749, 1237, 36, 92, "Input",ExpressionUUID->"cb644b8b-19df-4ee8-b6ef-c20f51269f4f"],
Cell[29312, 787, 24269, 633, 1362, "Input",ExpressionUUID->"45d4cb00-1792-4b47-87b5-c1477abefbff"],
Cell[53584, 1422, 15278, 412, 709, "Input",ExpressionUUID->"8a60897b-b3af-4748-a9bd-44350b15c9e0"],
Cell[68865, 1836, 1671, 42, 75, "Input",ExpressionUUID->"14cbc816-a21e-47a2-8125-4b3bce994c9c"],
Cell[70539, 1880, 12968, 365, 333, "Input",ExpressionUUID->"9ba97b64-8b39-45f8-aeb4-8ba8eee20cae",
 Evaluatable->False],
Cell[83510, 2247, 2688, 66, 149, "Input",ExpressionUUID->"eb064e5b-8881-446f-8bab-9809d006209a"],
Cell[86201, 2315, 279, 6, 44, "Text",ExpressionUUID->"e31d93cb-0d55-40e6-ace0-da1274d8f67a"],
Cell[86483, 2323, 1517, 37, 122, "Input",ExpressionUUID->"575cbf03-1a99-43b7-8ac1-d1ca33242a9f"],
Cell[88003, 2362, 1415, 31, 81, "Input",ExpressionUUID->"33bca83c-f7af-4665-b875-5dde70dbe811"],
Cell[89421, 2395, 567, 10, 30, "Input",ExpressionUUID->"ab79bd3e-b9f5-4e12-aac2-64b2944632a1"],
Cell[89991, 2407, 324, 7, 47, "Input",ExpressionUUID->"eae8476d-62aa-4b67-b90a-73e6b1a92cd0"],
Cell[90318, 2416, 619, 15, 53, "Input",ExpressionUUID->"24285e97-6cf3-48d2-97e8-db58344385a0"],
Cell[90940, 2433, 368, 7, 30, "Input",ExpressionUUID->"01849c82-87b7-42e6-a416-2eb8c774c565"],
Cell[91311, 2442, 4583, 100, 295, "Input",ExpressionUUID->"de8753ae-2adb-4c03-8ba6-a95d2ec0166b"],
Cell[95897, 2544, 1068, 25, 56, "Input",ExpressionUUID->"1f39fe68-cf08-466b-9d32-55c239f50d2d"],
Cell[96968, 2571, 2337, 55, 171, "Input",ExpressionUUID->"166c5ca7-33e2-4c50-ad19-4bf3b5289b63"],
Cell[99308, 2628, 6410, 146, 469, "Input",ExpressionUUID->"ed2f248c-3756-498a-a711-24626c76117f"],
Cell[105721, 2776, 2951, 67, 212, "Input",ExpressionUUID->"82d7234b-914e-4365-b123-5f64181a4e0c"],
Cell[108675, 2845, 1481, 35, 81, "Input",ExpressionUUID->"7e156740-9178-432c-be9e-546b2f0ce584"],
Cell[110159, 2882, 563, 11, 35, "Input",ExpressionUUID->"e896be03-7a35-48dd-befe-77ac387bcbf5"],
Cell[110725, 2895, 1182, 30, 82, "Input",ExpressionUUID->"22d83244-2ff3-4a99-bf67-3d8e77f9e007"],
Cell[111910, 2927, 956, 22, 59, "Input",ExpressionUUID->"dff21c90-5ecd-40da-82a4-2ba589148ed4"],
Cell[112869, 2951, 862, 21, 59, "Input",ExpressionUUID->"2303c239-ddb2-4e0a-8f33-c8cf1586c141"],
Cell[113734, 2974, 679, 15, 53, "Input",ExpressionUUID->"ced4c42b-09cb-4e6d-86b7-21fb079e422c"],
Cell[114416, 2991, 5370, 120, 433, "Input",ExpressionUUID->"b4e0a5aa-a2d1-4ea9-a3fb-6a3e1e6cdbd9"],
Cell[119789, 3113, 283, 7, 34, "Text",ExpressionUUID->"61d11c4d-845b-4b66-a54d-798e8cde0bdf"],
Cell[120075, 3122, 3948, 102, 284, "Input",ExpressionUUID->"c3c04aa3-bc0b-44b4-93c8-b520cf69554e"],
Cell[124026, 3226, 2386, 65, 280, "Input",ExpressionUUID->"cf1ce9ea-fa8b-4399-b4a6-e435eb12d358"],
Cell[126415, 3293, 5809, 136, 408, "Input",ExpressionUUID->"e39c96db-c350-4836-93c5-af1a41425e58"],
Cell[132227, 3431, 6340, 150, 350, "Input",ExpressionUUID->"78729c1e-5946-4135-88b6-34ab9c364da1"],
Cell[138570, 3583, 1486, 34, 119, "Input",ExpressionUUID->"0a219d89-9cb4-4355-aeca-6b1041274c0a"],
Cell[140059, 3619, 171, 2, 30, "Input",ExpressionUUID->"93379325-621f-43c6-8389-6865e43dabd5"],
Cell[140233, 3623, 1179, 25, 63, "Input",ExpressionUUID->"74ba13db-35a6-44fd-9c49-6139bae4e1d7"],
Cell[141415, 3650, 164, 2, 53, "Input",ExpressionUUID->"fd3ba0db-d54a-4252-8062-c38d284bb0a1"],
Cell[141582, 3654, 2616, 67, 180, "Input",ExpressionUUID->"2c2c02e4-da7e-4d1a-afcc-29cc0ae90914"],
Cell[144201, 3723, 259, 6, 34, "Text",ExpressionUUID->"8fd3e874-42df-42c3-83af-95f9bd8625f6"],
Cell[144463, 3731, 26661, 781, 1392, "Text",ExpressionUUID->"400161cc-835d-4015-8163-4d30c1a0797b"],
Cell[171127, 4514, 1057, 23, 53, "Input",ExpressionUUID->"538a57be-ccd9-4342-af09-0d8258f20fce"],
Cell[172187, 4539, 3892, 117, 150, "Input",ExpressionUUID->"a577ebcd-04f6-49b8-b579-2c11c0442b23"],
Cell[176082, 4658, 2633, 71, 140, "Input",ExpressionUUID->"c6ef84fd-f5e0-4a24-aceb-de1d43bea371"],
Cell[178718, 4731, 8645, 229, 495, "Input",ExpressionUUID->"eb69f030-4f96-4769-94b8-3d3310292795"],
Cell[187366, 4962, 1920, 54, 104, "Text",ExpressionUUID->"05608f11-2300-4b1d-af40-e150792d2ac5"],
Cell[189289, 5018, 204, 3, 34, "Text",ExpressionUUID->"12931b0c-38cc-4731-8972-b4b85a689d53"],
Cell[189496, 5023, 15873, 425, 794, "Text",ExpressionUUID->"8d1e2bf2-1502-48c5-bdca-c43e07e3d292"],
Cell[205372, 5450, 1368, 33, 79, "Input",ExpressionUUID->"1edb6a28-5f6c-4bfd-9e3f-76799b750267"],
Cell[206743, 5485, 2207, 48, 111, "Input",ExpressionUUID->"1a5b1b03-63c9-4eb3-a5ca-67e6a893e204"],
Cell[208953, 5535, 173, 2, 30, "Input",ExpressionUUID->"c1d1251e-6080-4d79-8d52-dabff148ab39"]
}
]
*)

